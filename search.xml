<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[„ÄêJava Âπ∂Âèë„ÄësynchornizedÂ≠¶‰π†Á¨îËÆ∞]]></title>
    <url>%2Fdeep-in-synchronized%2F</url>
    <content type="text"><![CDATA[Êàë‰ª¨Âú®Â≠¶‰π† Java Âπ∂ÂèëÁºñÁ®ãÁöÑÊó∂ÂÄôÔºåÁúãÂà∞ÁöÑÊúÄÂ§öÁöÑÂ∞±ÊòØ synchronized ÂÖ≥ÈîÆÂ≠ó‰∫ÜÔºåÂÆÉÂèØ‰ª•Ëß£ÂÜ≥ÂæàÂ§öÁ∫øÁ®ãÂÆâÂÖ®ÈóÆÈ¢òÔºåÈöèÁùÄÊ∑±ÂÖ•Â≠¶‰π†ÔºåÊàë‰ª¨Áü•ÈÅì synchronized ÂÆûÁé∞‰∫ÜÂèØÈáçÂÖ•Ôºå‰ΩÜÊòØÂÆÉÊòØ‰∏Ä‰∏™ÈáçÈáèÁ∫ßÈîÅÔºåÊïàÁéáÁõ∏ÂØπ‰∫é Lock Êù•ËØ¥Âπ∂‰∏çÊòØÈÇ£‰πàÂ•Ω„ÄÇ‰ΩÜÊòØÁªèËøá Java Âá†‰∏™ÁâàÊú¨ÁöÑ‰ºòÂåñ‰πãÂêéÔºåsynchronized Âπ∂‰∏çÊòæÂæóÈÇ£‰πàÁ¨®Èáç‰∫Ü„ÄÇ‰∏ãÈù¢Êàë‰ª¨Êù•Áúã‰∏Ä‰∏ã synchronized ÁöÑÂÆûÁé∞Êú∫Âà∂ÔºåÂíå Java ÂØπÂÆÉËøõË°å‰∫Ü‰ªÄ‰πàÊ†∑ÁöÑÂçáÁ∫ß„ÄÇ ÂÆûÁé∞ÂéüÁêÜSynchronized ‰øùËØÅ‰∫ÜÊñπÊ≥ïÊàñËÄÖ‰ª£Á†ÅÂùóÂú®ËøêË°åÊó∂ÔºåÂêå‰∏ÄÊó∂Èó¥Âè™Êúâ‰∏Ä‰∏™Á∫øÁ®ãÂèØ‰ª•ÊâßË°åÔºåÂπ∂‰øùËØÅ‰∫ÜÂØπÂÖ±‰∫´ÂèòÈáèÁöÑÂÜÖÂ≠òÂèØËßÅÊÄß„ÄÇ Java ‰∏≠ synchronized ÈõÜ‰∏≠ÂÆûÁé∞ÊñπÊ≥ïÔºö ÈùûÈùôÊÄÅÂêåÊ≠•ÊñπÊ≥ïÔºöÈîÅ‰ΩèÂΩìÂâçÂÆû‰æãÂØπË±° 123public synchronized void test() &#123; &#125; ÈùôÊÄÅÂêåÊ≠•ÊñπÊ≥ïÔºöÈîÅ‰ΩèÂΩìÂâçÁ±ªÁöÑ class ÂØπË±° 123public static synchronized void test() &#123; &#125; ÂêåÊ≠•‰ª£Á†ÅÂùóÔºöÈîÅ‰ΩèÊã¨Âè∑‰∏≠ÁöÑÂØπË±° 12345public void test() &#123; synchronized (this) &#123; &#125;&#125; Synchronized Â≠óËäÇÁ†ÅË°®Á§∫Êàë‰ª¨Âà©Áî®Â∑•ÂÖ∑Êü•ÁúãÁîüÊàêÁöÑ class Êñá‰ª∂ÔºåÁîüÊàêÁöÑ class Êñá‰ª∂Â¶Ç‰∏ãÔºö ‰ªé‰ª•‰∏ä class Êñá‰ª∂Êàë‰ª¨ÂèØ‰ª•ÁúãÂá∫ÔºåÂêåÊ≠•‰ª£Á†ÅÂùóÊòØÈÄöËøá monitorenter Âíå monitorexit Êù•ÂÆûÁé∞ÁöÑÔºåÂêåÊ≠•ÊñπÊ≥ïÊòØ‰æùÈù†ÊñπÊ≥ï‰øÆÈ•∞Á¨¶‰∏≠ÁöÑ ACC_SYNCHRONIZED ÂÆûÁé∞„ÄÇ ÂêåÊ≠•‰ª£Á†ÅÂùóÔºömoniterenter Êåá‰ª§‰ºöÊèíÂÖ•Âà∞ÂêåÊ≠•‰ª£Á†ÅÂùóÂºÄÂßãÁöÑ‰ΩçÁΩÆÔºåmoniterexit ÊèíÂÖ•Âà∞ÂêåÊ≠•‰ª£Á†ÅÂùóÁªìÊùüÁöÑ‰ΩçÁΩÆÔºåJVM ÈúÄË¶Å‰øùËØÅÊØè‰∏™ monitorenter ÈÉΩÊúâ‰∏Ä‰∏™ monitorexit Áõ∏ÂØπÂ∫î„ÄÇ‰ªª‰ΩïÂØπË±°ÈÉΩÊúâ‰∏Ä‰∏™ monitor ‰∏é‰πãÁõ∏ÂÖ≥ËÅîÔºåÂΩì monitor Ë¢´ÊåÅÊúâÂêéÔºåÂÆÉÂ∞ÜÂ§Ñ‰∫éÈîÅÂÆöÁä∂ÊÄÅ„ÄÇÁ∫øÁ®ãÊâßË°åÂà∞ moniterenter Êåá‰ª§Êó∂ÔºåÂ∞Ü‰ºöÂ∞ùËØïËé∑ÂèñÂΩìÂâçÂØπË±°ÂØπÂ∫îÁöÑ monitor ÊâÄÊúâÊùÉÔºàËøô‰∏™ËøáÁ®ãÂ∞±ÊòØËé∑ÂèñÈîÅÔºâ„ÄÇ ÂêåÊ≠•ÊñπÊ≥ïÔºöÂêåÊ≠•ÊñπÊ≥ï‰∏≠Ê≤°Êúâ monitorenter Âíå monitorexitÔºåÂèñËÄå‰ª£‰πãÁöÑÊòØÂú® flags ‰∏≠Ê∑ªÂä†‰∫Ü ACC_SYNCHRONIZED Ê†áËØÜÔºåJVM ÈÄöËøáËØ• ACC_SYNCHRONIZED ËÆøÈóÆÊ†áÂøóÊù•Ëæ®Âà´‰∏Ä‰∏™ÊñπÊ≥ïÊòØÂê¶Â£∞Êòé‰∏∫ÂêåÊ≠•ÊñπÊ≥ïÔºå‰ªéËÄåÊâßË°åÁõ∏Â∫îÁöÑÂêåÊ≠•Ë∞ÉÁî®„ÄÇ‰ΩøÁî®Ë∞ÉÁî®ËØ•ÊñπÊ≥ïÁöÑÂØπË±°ÊàñÊñπÊ≥ïÊâÄÂ±û Class Âú® JVM ÁöÑÂÜÖÈÉ®ÂØπË±°Ë°®Á§∫ Klass ÂÅö‰∏∫ÈîÅÂØπË±°„ÄÇ ÂÖ≥‰∫é monitorenter Âíå moniterexit Ëøô‰∏§Êù°Êåá‰ª§ Âú® JVM ÁöÑËßÑËåÉ‰∏≠ÊúâËøôÊ†∑‰∏ÄÂè•ËØùÔºö Each object is associated with a monitor. A monitor is locked if and only if it has an owner. The thread that executes monitorenter attempts to gain ownership of the monitor associated with objectref, as follows:‚Ä¢ If the entry count of the monitor associated with objectref is zero, the thread enters the monitor and sets its entry count to one. The thread is then the owner of the monitor.‚Ä¢ If the thread already owns the monitor associated with objectref, it reenters the monitor, incrementing its entry count.‚Ä¢ If another thread already owns the monitor associated with objectref, the thread blocks until the monitor‚Äôs entry count is zero, then tries again to gain ownership. ‰ª•‰∏äÂºïÁî®‰πüËØ¥Êòé‰∫ÜÔºåÊØè‰∏™ÂØπË±°ÈÉΩÂÖ≥ËÅî‰∫Ü‰∏Ä‰∏™ monitorÔºåÂ¶ÇÊûú‰∏Ä‰∏™monitorË¢´Âç†Áî®ÂàôÂÆÉÂ§Ñ‰∫éÈîÅÂÆöÁä∂ÊÄÅ„ÄÇÁ∫øÁ®ãÂú®ÊâßË°å monitorenter Êåá‰ª§Êó∂‰ºöÂ∞ùËØïËé∑ÂèñÂØπË±°ÂÖ≥ËÅîÁöÑ monitor ÁöÑÊâÄÊúâÊùÉ„ÄÇ Â¶ÇÊûú monitor ÁöÑËøõÂÖ•Êï∞‰∏∫0ÔºåÂàôËØ•Á∫øÁ®ãËøõÂÖ• monitorÔºåÂπ∂Â∞ÜËøõÂÖ•Êï∞ËÆæÁΩÆ‰∏∫1ÔºåËØ•Á∫øÁ®ã‰∏∫ËØ• monitor ÁöÑÊâÄÊúâËÄÖ„ÄÇ Â¶ÇÊûú‰∏Ä‰∏™Á∫øÁ®ãÂ∑≤ÁªèÂç†Êúâ‰∫ÜÂØπË±°ÂÖ≥ËÅîÁöÑ monitorÔºåÂÆÉ‰ºöÈáçÊñ∞ËøõÂÖ•ÔºåÂπ∂Â∞ÜËøõÂÖ•Êï∞Âä†1„ÄÇ Â¶ÇÊûúÂ∑≤ÁªèÊúâÂè¶‰∏Ä‰∏™Á∫øÁ®ãÂç†Êúâ‰∫ÜËØ• monitorÔºåÂàôËØ•Á∫øÁ®ã‰ºöÈòªÂ°ûÁõ¥Âà∞ monitor ÁöÑËøõÂÖ•Êï∞‰∏∫0ÔºåÁÑ∂ÂêéÂ∞ùËØïËé∑ÂèñÊâÄÊúâÊùÉ„ÄÇ The thread that executes monitorexit must be the owner of the monitor associated with the instance referenced by objectref.The thread decrements the entry count of the monitor associated with objectref. If as a result the value of the entry count is zero, the thread exits the monitor and is no longer its owner. Other threads that are blocking to enter the monitor are allowed to attempt to do so. Â§ßËá¥ÊÑèÊÄùÊòØÔºöÊâßË°å monitorexit ÁöÑÁ∫øÁ®ãÂøÖÈ°ªÊòØ objectref ÊâÄÂØπÂ∫îÁöÑ monitor ÁöÑÊâÄÊúâËÄÖ„ÄÇËØ•Êåá‰ª§ÊâßË°åÊó∂ÔºåÁ∫øÁ®ã‰ºöÂ∞Ü monitor ÁöÑËøõÂÖ•Êï∞Âáè1„ÄÇÂ¶ÇÊûúËøõÂÖ•Êï∞Âáè1‰πãÂêé‰∏∫0ÔºåÂàôËØ•Á∫øÁ®ãÈÄÄÂá∫ monitor Âπ∂‰∏î‰∏çÂÜçÊòØÂÆÉÁöÑÊâÄÊúâËÄÖ„ÄÇË¢´ÈòªÂ°ûÁöÑÂÖ∂‰ªñÁ∫øÁ®ãÂ∞ÜÂÖÅËÆ∏Â∞ùËØïËé∑ÂèñÊâÄÊúâÊùÉ„ÄÇ Java ÂØπË±°Â§¥Âíå MonitorJava ÂØπË±°Â§¥MonitorJava ‰∏≠ÈîÅÁöÑ‰ºòÂåñÂèÇËÄÉÊñáÁ´†Ôºö Biased Locking in HotSpot JVMÂÜÖÈÉ®ÁªÜËäÇ‰πã‰∏ÄÔºösynchronizedÂÖ≥ÈîÆÂ≠óÂèäÂÆûÁé∞ÁªÜËäÇ(ËΩªÈáèÁ∫ßÈîÅLightweight Locking) „ÄêÊ≠ªÁ£ïJavaÂπ∂Âèë„Äë‚Äî‚ÄìÊ∑±ÂÖ•ÂàÜÊûêsynchronizedÁöÑÂÆûÁé∞ÂéüÁêÜ]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Âπ∂Âèë</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Paxos Made Simple(ËØëÊñá)]]></title>
    <url>%2Fpaxos-made-simple%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂú®‰∏Ä‰∏™ÂàÜÂ∏ÉÂºèÁöÑÁ≥ªÁªü‰∏≠ÔºåÊï∞ÊçÆÁöÑ‰∏ÄËá¥ÊÄßÊòØÈùûÂ∏∏ÈáçË¶ÅÁöÑ„ÄÇÊâÄ‰ª•ÈúÄË¶ÅÁî®Âà∞‰∏ÄËá¥ÊÄßÁÆóÊ≥ïÊù•Ëß£ÂÜ≥Êï∞ÊçÆ‰∏ÄËá¥ÊÄßÁöÑÈóÆÈ¢ò„ÄÇÂ§ßÂÆ∂ÈÉΩÁü•ÈÅì Zookeeper ÁöÑ zab ÂçèËÆÆÂ∞±ÊòØÂü∫‰∫é Paxos ÁÆóÊ≥ïÁöÑÔºåËÄåÊàëÊúÄËøëÊ≠£Â•ΩÁúã‰∫Ü Leslie Lamport ÁöÑ Paxos Made Simple ËøôÁØáËÆ∫ÊñáÔºå‰ª•‰∏ãÊòØÊàëÂØπ Paxos Made Simple ÂèÇÊùÇËá™Â∑±ÁöÑÁêÜËß£‰πãÂêéÁöÑÁøªËØë (Êüê‰∫õÂú∞ÊñπÊúâÊú∫ÁøªüòÑ)ÔºåÂ¶ÇÊûúÊúâÈîôËØØÁöÑÂú∞ÊñπËØ∑ÊåáÊ≠£ÔºåË∞¢Ë∞¢„ÄÇ ÊèêÂá∫ÈóÆÈ¢òÂÅáËÆæ‰∏Ä‰∏™ËøõÁ®ãÁöÑÈõÜÂêàÂèØ‰ª•ÊèêÂá∫ÂÄºÔºàvaluesÔºâÔºå‰∏ÄËá¥ÊÄßÁÆóÊ≥ïÂàô‰øùËØÅ‰∫ÜÂè™ÈÄâÂá∫ÊâÄÊèêÂá∫ÂÄº‰∏≠ÁöÑÂçï‰∏™ÂÄº„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÂÄºÊ≤°ÊèêÂá∫ÔºåÈÇ£Â∞±‰∏ç‰ºöÊúâÂÄºË¢´ÈÄâ‰∏≠„ÄÇÂ¶ÇÊûú‰∏Ä‰∏™ÂÄºË¢´ÈÄâ‰∏≠ÔºåÈÇ£‰πàËøõÁ®ãÂ∫îËØ•ËÉΩÂ§üÂ≠¶‰π†Âà∞ËØ•ÂÄº„ÄÇÂÖ±ËØÜÔºà‰∏ÄËá¥ÊÄßÔºâÁöÑÂÆâÂÖ®ÊÄßË¶ÅÊ±ÇÂ¶Ç‰∏ãÔºö ‰∏Ä‰∏™ÂÄºÂè™ÊúâË¢´ÊèêÂá∫ÊâçÂèØËÉΩË¢´ÈÄâ‰∏≠Ôºå Âè™Êúâ‰∏Ä‰∏™ÂÄºËÉΩË¢´ÈÄâ‰∏≠ÔºåÂπ∂‰∏î ‰∏Ä‰∏™ËøõÁ®ãÂú®‰∏Ä‰∏™ÂÄºË¢´ÈÄâ‰∏≠‰πãÂâçÊ∞∏Ëøú‰∏ç‰ºöÁü•ÈÅìËøô‰∏™ÂÄºÊòØ‰ªÄ‰πà„ÄÇ ÁõÆÊ†áÊòØ‰øùËØÅ‰∏Ä‰∫õË¢´ÊèêÂá∫ÁöÑÂÄºËÉΩÊúÄÁªàË¢´ÈÄâ‰∏≠ÔºåÂπ∂‰∏îÂ¶ÇÊûú‰∏Ä‰∏™ÂÄºË¢´ÈÄâ‰∏≠ÔºåÈÇ£‰πàËøõÁ®ãÊúÄÁªàËÉΩÂ§üÁü•ÈÅìÔºàlearnÔºâËØ•ÂÄº„ÄÇ Êàë‰ª¨ËÆ©ÂÖ±ËØÜÁÆóÊ≥ï‰∏≠ÁöÑ‰∏â‰∏™ËßíËâ≤ÔºàroleÔºâÁî±‰∏â‰∏™‰ª£ÁêÜÔºàagentÔºâÊù•ÊâßË°åÔºöproposersÔºåacceptorsÔºålearners„ÄÇÂú®ÂÆûÁé∞‰∏≠ÔºåÂçï‰∏™ËøõÁ®ãÂèØËÉΩ‰∏çÊ≠¢ÊâÆÊºî‰∏Ä‰∏™‰ª£ÁêÜÔºå‰ΩÜËøôÈáåÊàë‰ª¨‰∏çÂÖ≥ÂøÉ‰ª£ÁêÜÂíåËøõÁ®ãÁöÑÊò†Â∞Ñ„ÄÇ ÂÅáËÆæ‰ª£ÁêÜËÉΩÂ§üÈÄöËøáÊ∂àÊÅØ‰º†ÈÄí‰∏éÂè¶‰∏Ä‰∏™ËøõË°åÈÄö‰ø°Ôºå‰ΩøÁî®Â∏∏Áî®ÁöÑÂºÇÊ≠•ÔºåÈùûÊãúÂç†Â∫≠Ê®°ÂûãÔºåÂÖ∂‰∏≠Ôºö ‰ª£ÁêÜ‰ª•‰ªªÊÑèÁöÑÈÄüÂ∫¶ÊâßË°åÔºåÂèØËÉΩ‰ºöÂõ†‰∏∫ÂÅúÊ≠¢ËÄåÂ§±Ë¥•Ôºå‰πüÂèØËÉΩÈáçÂêØ„ÄÇÂõ†‰∏∫ÊâÄÊúâ‰ª£ÁêÜÈÉΩÂèØËÉΩÂú®‰∏Ä‰∏™ÂÄºË¢´ÈÄâ‰∏≠‰πãÂêéÂ§±Ë¥•Âπ∂ÈáçÂêØÔºåÈô§ÈùûÊüê‰∫õ‰ø°ÊÅØËÉΩË¢´Â§±Ë¥•ÈáçÂêØÁöÑ‰ª£ÁêÜËÆ∞‰ΩèÔºåÂê¶Âàô‰∏çÂèØËÉΩÊúâËß£ÂÜ≥ÊñπÊ°à„ÄÇ Ê∂àÊÅØËÉΩ‰ª•‰ªªÊÑèÈïøÁöÑÊó∂Èó¥‰º†ÈÄíÔºåÂèØ‰ª•ÈáçÂ§çÔºåÂèØ‰ª•‰∏¢Â§±Ôºå‰ΩÜÊòØ‰∏ç‰ºöÊçüÂùè„ÄÇ ÈÄâ‰∏≠‰∏Ä‰∏™ÂÄºÔºàChoosing a ValueÔºâÈÄâÊã©‰∏Ä‰∏™ÂÄºÊúÄÁÆÄÂçïÁöÑÊñπÊ≥ïÂ∞±ÊòØÂè™Êúâ‰∏Ä‰∏™ Acceptor ‰ª£ÁêÜ„ÄÇProposer Áªô Acceptor ÂèëÈÄÅ‰∏Ä‰∏™ÊèêÊ°àÔºàProposerÔºâÔºåAcceptor ÈÄâÊã©ÂÖ∂Êî∂Âà∞ÁöÑÁ¨¨‰∏Ä‰∏™Âª∫ËÆÆÂÄº„ÄÇËøôÊ†∑ËôΩÁÑ∂ÁÆÄÂçïÔºå‰ΩÜÊòØËøôÁßçËß£ÂÜ≥ÊñπÊ°à‰∏ÄÂÆö‰ºöÊúâÂçïÊú∫ÈóÆÈ¢òÔºàÂéüÊñá‰∏≠ÊòØÔºöËØ• Acceptor ÁöÑÂ§±Ë¥•‰ºöËÆ©‰ªª‰ΩïËøõ‰∏ÄÊ≠•ÁöÑËøõÂ±ïÈÉΩ‰∏çÂèØËÉΩÊâßË°å„ÄÇÊàëËÆ§‰∏∫Ê≠§Â§ÑÊòØÊåáÂçïÊú∫ÈóÆÈ¢ò„ÄÇÊ¨¢ËøéÊåáÊ≠£^ . ^Ôºâ„ÄÇ ÊâÄ‰ª•ÔºåËÆ©Êàë‰ª¨Â∞ùËØïÂè¶‰∏ÄÁßçÊñπÊ≥ï„ÄÇÊàë‰ª¨Áî®Â§ö‰∏™ Acceptor ‰ª£ÁêÜ‰ª£ÊõøÂçï‰∏™ Acceptor„ÄÇ‰∏Ä‰∏™ Proposer Âêë‰∏Ä‰∏™ Acceptor ÈõÜÂêàÂèëÈÄÅÊèêÊ°à„ÄÇ‰∏Ä‰∏™ Acceptor ÂèØËÉΩ‰ºöÊé•ÂèóËØ•ÊèêÊ°àÂÄº„ÄÇÂΩì‰∏Ä‰∏™Ë∂≥Â§üÂ§ßÁöÑ Acceptor ÈõÜÂêàÊé•Âèó‰∫ÜËøô‰∏™Âª∫ËÆÆÂÄºÔºåÂàôËØ•ÂÄºË¢´ÈÄâ‰∏≠„ÄÇ‰ΩÜÊòØÂ§öÂ§ßÊòØË∂≥Â§üÂ§ßÂë¢Ôºü‰∏∫‰∫Ü‰øùËØÅÂè™Êúâ‰∏Ä‰∏™ÂÄºËÉΩË¢´ÈÄâ‰∏≠ÔºåÊàë‰ª¨ËÆ©Ëøô‰∏™Ë∂≥Â§üÂ§ßÁöÑÈõÜÂêàÁî±‰ªªÊÑèÂ§öÊï∞Ê¥æÁöÑ‰ª£ÁêÜÈõÜÂêà (majority of agents) ÁªÑÊàê„ÄÇÂõ†‰∏∫‰ªªÊÑè‰∏§‰∏™Â§öÊï∞Ê¥æÈõÜÂêà (any two majorities) Ëá≥Â∞ëÊúâ‰∏Ä‰∏™ÂÖ¨ÂÖ±ÁöÑ‰ª£ÁêÜÔºåËøôÂú®‰∏Ä‰∏™ Acceptor ÊúÄÂ§öËÉΩÊé•Âèó‰∏Ä‰∏™ÂÄºÊó∂ÊúâÊïà„ÄÇ Âú®‰∏çÂ≠òÂú®Â§±Ë¥•ÊàñËÄÖÊ∂àÊÅØ‰∏¢Â§±ÁöÑÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÊÉ≥ËÆ©Âç≥‰ΩøÂè™Êúâ‰∏Ä‰∏™Âª∫ËÆÆÂÄºË¢´ÊèêÂá∫‰πüËÉΩË¢´ÈÄâ‰∏≠ÔºåËøôË°®Êòé‰∫ÜËøô‰∏Ä‰∏™Ë¶ÅÊ±ÇÔºö P1. An acceptor must accept the first proposal that it receives. ÁøªËØëÔºö‰∏Ä‰∏™ Acceptor ÂøÖÈ°ªÊé•ÂèóÂÆÉÊî∂Âà∞ÁöÑÁ¨¨‰∏Ä‰∏™ÊèêÊ°à„ÄÇ ‰ΩÜÊòØËøô‰∏™Ë¶ÅÊ±ÇÂºïÂèë‰∫Ü‰∏Ä‰∏™ÈóÆÈ¢òÔºå‰∏çÂêåÁöÑ Proposer ÂèØ‰ª•ÂêåÊó∂ÊèêÂá∫‰∏Ä‰∫õ‰∏çÂêåÁöÑÊèêÊ°àÔºåËøôÂ∞±ÂèØËÉΩ‰ºöÈÄ†ÊàêÊØè‰∏™ÊèêÊ°à‰ºöË¢´Áõ∏ÂêåÊï∞ÈáèÁöÑ Acceptor Êé•ÂèóÔºå‰æãÂ¶Ç‰∏§‰∏™ÊèêÊ°àÂàÜÂà´Ë¢´ÂçäÊï∞ÁöÑ Acceptor Êé•ÂèóÔºåÊ≤°Êúâ‰∏Ä‰∏™ÊèêÊ°àÂÄºË¢´Â§öÊï∞Ê¥æÁöÑ Acceptor ÊâÄÊé•Âèó„ÄÇËÄåËøôÊ†∑Â∞±Êó†Ê≥ïÁü•ÈÅìÈÄâÊã©‰∫ÜÂì™‰∏™ÊèêÊ°àÂÄº„ÄÇ P1 Âíå ‰∏Ä‰∏™ÂÄºÂè™ÊúâË¢´Â§öÊï∞Ê¥æÁöÑ Acceptor Êé•ÂèóÊâç‰ºöË¢´ÈÄâÊã©ÁöÑË¶ÅÊ±ÇÊÑèÂë≥ÁùÄ‰∏Ä‰∏™ Acceptor ÂÖÅËÆ∏Êé•ÂèóÂ§ö‰∏™ÊèêÊ°à„ÄÇÊàë‰ª¨ÈÄöËøáÂàÜÈÖçÁºñÂè∑Êù•ËøΩË∏™‰∏çÂêåÁöÑÊèêÊ°àÔºåÊâÄ‰ª•‰∏Ä‰∏™ÊèêÊ°à (proposal) Â∞±Áî±ÁºñÂè∑ÂíåÊèêÊ°àÂÄºÁªÑÊàê (ÂÅáËÆæ‰∏Ä‰∏™ÊèêÊ°àÁöÑË°®Áé∞ÂΩ¢Âºè‰∏∫ [n, v] )„ÄÇ‰∏∫‰∫ÜÈò≤Ê≠¢Ê∑∑Ê∑ÜÔºåÊàë‰ª¨Ë¶ÅÊ±ÇÊØè‰∏™ÊèêÊ°àÁöÑÁºñÂè∑ÈÉΩ‰∏ç‰∏ÄÊ†∑„ÄÇHow this is achieved depends on the implementation, so for now we just assume it„ÄÇÂΩìÁî®‰ª•‰∏Ä‰∏™ÂÄºÁöÑ proposal Ë¢´Â§öÊï∞Ê¥æÁöÑ Acceptor Êé•ÂèóÔºåËØ•ÂÄºÊâç‰ºöË¢´ÈÄâÊã©„ÄÇËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨Áß∞‰∏Ä‰∏™ÊèêÊ°àË¢´ÈÄâÊã©„ÄÇ Êàë‰ª¨ÂÖÅËÆ∏Â§ö‰∏™ÊèêÊ°àË¢´ÈÄâÊã©Ôºå‰ΩÜÊòØÊàë‰ª¨ÂøÖÈ°ª‰øùËØÅÊâÄÊúâË¢´ÈÄâÊã©ÁöÑÊèêÊ°àÈÉΩÊúâÁõ∏ÂêåÁöÑÂÄº„ÄÇÈÄöËøáÂØπÊèêÊ°àÁºñÂè∑ÁöÑÂΩíÁ∫≥ÔºåË∂≥‰ª•‰øùËØÅÔºö P2. If a proposal with value v is chosen, then every higher-numbered proposal that is chosen has value v. ÁøªËØëÔºöÂ¶ÇÊûú‰∏Ä‰∏™ÊèêÊ°àÂÄº‰∏∫ v ÁöÑÊèêÊ°àË¢´ÈÄâÊã©ÔºåÈÇ£‰πàÊØè‰∏™Ë¢´ÈÄâÊã©‰∏îÁºñÂè∑ÊØîËØ•ÊèêÊ°àÂ§ßÁöÑÊèêÊ°àÁöÑÂÄºÈÉΩÊòØ v„ÄÇ Âõ†‰∏∫ÁºñÂè∑ÊòØË¢´ÂÆåÂÖ®ÊéíÂ∫èÁöÑÔºåÊù°‰ª∂ P2 ‰øùËØÅ‰∫ÜÂè™Êúâ‰∏Ä‰∏™ÂÄºËÉΩË¢´ÈÄâÊã©ÁöÑÂÖ≥ÈîÆÊÄßÂÆâÂÖ®Â±ûÊÄß„ÄÇ ‰∏Ä‰∏™ÊèêÊ°àË¶ÅË¢´ÈÄâÊã©ÔºåÂàôÂøÖÈ°ªËá≥Â∞ëË¢´‰∏Ä‰∏™ Acceptor Êé•ÂèóÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáÊª°Ë∂≥‰ª•‰∏ãÊù°‰ª∂ (P2a) Êù•Êª°Ë∂≥ P2Ôºö P2a. If a proposal with value v is chosen, then every higher-numbered proposal accepted by any acceptor has value v. ÁøªËØëÔºöÂ¶ÇÊûú‰∏Ä‰∏™ÊèêÊ°àÂÄº‰∏∫ v ÁöÑÊèêÊ°àË¢´ÈÄâÊã©ÔºåÈÇ£‰πàË¢´‰ªªÊÑè Acceptor ÊâÄÊé•ÂèóÁöÑÊõ¥È´òÁºñÂè∑ÁöÑÊèêÊ°àÁöÑÊèêÊ°àÂÄºÈÉΩ‰∏∫ v„ÄÇ(ËøôÈáåËØ¥Êòé‰∫ÜÂ¶ÇÊûú‰∏Ä‰∏™ÊèêÊ°àÂÄº v Ë¢´ÈÄâÊã©ÔºåAcceptorÂ∞±‰∏çÂÜçÈÄöËøáÊèêÊ°àÂÄº‰∏ç‰∏∫ v ÁöÑÊèêÊ°à‰∫Ü) Êàë‰ª¨‰ªçÁÑ∂Ë¶ÅÁª¥ÊåÅ P1 Á°Æ‰øùÊúâÊèêÊ°àËÉΩË¢´ÈÄâÊã©„ÄÇÂõ†‰∏∫ÈÄö‰ø°ÊòØÂºÇÊ≠•ÁöÑ (‰∏äÊñáÊúâÊèêÂà∞ÂâçÊèêÊù°‰ª∂)ÔºåÂèØËÉΩ‰ºöÂá∫Áé∞‰∏Ä‰∏™ÊèêÊ°àË¢´ÈÄâÊã©‰∫ÜÔºå‰ΩÜ Acceptor c ËøòÊ≤°ÊúâÊé•ÂèóÔºàacceptÔºâ‰ªª‰Ωï‰ªª‰ΩïÊèêÊ°àÔºåÂ¶ÇÊûúËøôÊó∂‰∏Ä‰∏™Êñ∞ÁöÑ Proposer ‚ÄúÈÜíÊù•‚ÄùÂπ∂ÂèëÂ∏É‰∫Ü‰∏Ä‰∏™Êã•ÊúâÊõ¥È´òÁºñÂè∑‰∏îÊèêÊ°àÂÄº‰∏çÂêåÁöÑÊèêÊ°àÔºåËøôÊó∂ P1 Â∞±Ë¶ÅÊ±Ç Acceptor c Êé•ÂèóËøô‰∏™ÊèêÊ°àÔºåÂàôËøùÂèç‰∫Ü P2a„ÄÇ‰∏∫‰∫ÜÁª¥ÊåÅ P1 Âíå P2aÔºåÊàë‰ª¨ÈúÄË¶ÅÂ¢ûÂº∫ P2aÔºö P2b. If a proposal with value v is chosen, then every higher-numbered proposal issued by any proposer has value v. ÁøªËØëÔºöÂ¶ÇÊûú‰∏Ä‰∏™ÊèêÊ°àÂÄº‰∏∫ v ÁöÑÊèêÊ°àË¢´ÈÄâÊã©‰∫ÜÔºåÈÇ£‰πà Proposer ÂèëÂ∏ÉÁöÑÊâÄÊúâÊõ¥È´òÁºñÂè∑ÁöÑÊèêÊ°àÁöÑÊèêÊ°àÂÄºÈÉΩ‰∏∫ v„ÄÇÔºàProposer Âè™‰ºöÊèêÂá∫ÊèêÊ°àÂÄº‰∏∫ v ÁöÑÊèêÊ°àÔºâ Âõ†‰∏∫‰∏Ä‰∏™ÊèêÊ°àÂú®Ë¢´‰∏Ä‰∏™ Acceptor Êé•Âèó‰πãÂâçÂøÖÈ°ªË¶ÅË¢´ Proposer ÊèêÂá∫ÔºåP2b Êª°Ë∂≥‰∫Ü P2aÔºå‰∏îÊª°Ë∂≥‰∫Ü P2„ÄÇ ÊÉ≥Ë¶ÅÁü•ÈÅìÂ¶Ç‰ΩïÂéªÊª°Ë∂≥ P2bÔºåËÆ©Êàë‰ª¨ÊÉ≥ÊÉ≥Â¶Ç‰ΩïËØÅÊòéÂÆÉÊòØÊàêÁ´ãÁöÑ„ÄÇÊàë‰ª¨ÂÅáËÆæÁºñÂè∑‰∏∫ m ‰∏îÊèêÊ°àÂÄº‰∏∫ v ÁöÑÊèêÊ°àË¢´ÈÄâÊã©Âπ∂‰∏îËøôË°®Á§∫‰ªª‰Ωï Proposer ÊèêÂá∫ÁöÑÁºñÂè∑ n &gt; m ÁöÑÊèêÊ°àÁöÑÊèêÊ°àÂÄºÈÉΩÊòØ v„ÄÇÊàë‰ª¨ËÉΩÈÄöËøáÂØπ n ËøõË°åÂΩíÁ∫≥‰ΩøËØÅÊòéÊõ¥ÁÆÄÂçïÔºåÊâÄ‰ª•Êàë‰ª¨ËÉΩËØÅÊòéÂú®Ëøô‰∏™È¢ùÂ§ñÁöÑÂÅáËÆæÔºàÊØè‰∏™Ë¢´ÊèêÂá∫ÁöÑÁºñÂè∑Âú® m Âà∞ n - 1 ‰πãÈó¥ÁöÑÊèêÊ°àÁöÑÂÄºÈÉΩÊòØ vÔºâ‰∏ãÔºåÁºñÂè∑ n ÁöÑÊèêÊ°àÂÖ∑ÊúâÂÄº v„ÄÇÂØπ‰∫éÁºñÂè∑‰∏∫ m ÁöÑÊèêÊ°àË¢´ÈÄâÊã©Ôºå‰∏ÄÂÆöÊúâÊüê‰∏™Áî±Â§öÊï∞Ê¥æÁöÑ Acceptor ÁªÑÊàêÁöÑÈõÜÂêà C ‰∏≠ÊØè‰∏™ Acceptor ÈÉΩÊé•Âèó‰∫ÜËøô‰∏™ÊèêÊ°à„ÄÇÂ∞ÜÊ≠§‰∏éÂΩíÁ∫≥ÂÅáËÆæÁõ∏ÁªìÂêàÔºåÁºñÂè∑‰∏∫ m ÁöÑÊèêÊ°àË¢´ÈÄâÊã©ÁöÑÂÅáËÆæÊÑèÂë≥ÁùÄÔºö Every acceptor in C has accepted a proposal with number in m . .(n ‚àí 1), and every proposal with number in m . .(n ‚àí 1) accepted by any acceptor has value v. ÁøªËØëÔºöÈõÜÂêà C ‰∏≠ÁöÑÊØè‰∏™ Acceptor ÈÉΩÊé•Âèó‰∫ÜÁºñÂè∑ m Âà∞ n-1 ÁöÑÊèêÊ°àÔºåÂπ∂‰∏îÁºñÂè∑‰∏∫ m Âà∞ n-1 ÁöÑÊØè‰∏™ÊèêÊ°àÁöÑÊèêÊ°àÂÄºÈÉΩÊòØ v„ÄÇ Âõ†‰∏∫‰ªªÊÑèÂ§ßÂ§öÊï∞ Acceptor ÈõÜÂêà S Ëá≥Â∞ëÂê´Êúâ‰∏Ä‰∏™ÈõÜÂêà C ‰∏≠ÁöÑÊàêÂëòÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•ÈÄöËøá‰øùËØÅÁª¥ÊåÅ‰ª•‰∏ãÊù°‰ª∂ (invariant) Êù•ÂæóÂá∫ÁºñÂè∑‰∏∫ n ÁöÑÊèêÊ°àÁöÑÂÄºÊòØ vÔºö P2c. For any v and n, if a proposal with value v and number n is issued, then there is a set S consisting of a majority of acceptors such that either (a) no acceptor in S has accepted any proposal numbered less than n, or (b) v is the value of the highest-numbered proposal among all proposals numbered less than n accepted by the acceptors in S. ÁøªËØëÔºöÂØπ‰∫é‰ªªÊÑèÁöÑ v Âíå nÔºåÂ¶ÇÊûú‰∏Ä‰∏™ÁºñÂè∑‰∏∫ n ‰∏îÊèêÊ°àÂÄº‰∏∫ v ÁöÑÊèêÊ°àË¢´ÂèëÂ∏É‰∫ÜÔºåÈÇ£‰πà‰ºöÊúâ‰∏Ä‰∏™Áî±Â§ßÂ§öÊï∞ Acceptor ÁªÑÊàêÁöÑÈõÜÂêà S ÂåÖÂê´‰ª•‰∏ã‰∏§ÁßçÊÉÖÂÜµÔºö(a) Âú®ÈõÜÂêà S ‰∏≠Ê≤°Êúâ Acceptor Êé•Âèó‰∫ÜÁºñÂè∑ÊØî n Â∞èÁöÑ‰ªª‰ΩïÊèêÊ°à„ÄÇÊàñËÄÖ (b) v ÊòØÂú® S ‰∏≠Ë¢´ Acceptors Êé•ÂèóÁöÑÁºñÂè∑Â∞è‰∫é n ÁöÑÊèêÊ°à‰∏≠ÁºñÂè∑ÊúÄÂ§ßÁöÑÊèêÊ°àÁöÑÂÄº„ÄÇ Âõ†Ê≠§Êàë‰ª¨ËÉΩÈÄöËøáÊù•Áª¥ÊåÅ‰∏çÂèòÈáè (invariance) P2c Êù•Êª°Ë∂≥ P2b„ÄÇ Ë¶ÅÁª¥ÊåÅ P2cÔºå‰∏Ä‰∏™ÊÉ≥Ë¶ÅÊèêÂá∫ÁºñÂè∑‰∏∫ n ÁöÑÊèêÊ°àÁöÑ Proposer ÂøÖÈ°ªË¶ÅÁü•ÈÅìÁºñÂè∑Â∞è‰∫é n ‰πã‰∏≠ÁºñÂè∑ÊúÄÂ§ßÁöÑÊèêÊ°àÔºåÂ¶ÇÊûúÂ≠òÂú®ËØ•ÊèêÊ°àÔºåÂàôËØ•ÊèêÊ°àÂ∑≤ÁªèÊàñËÄÖÂ∞ÜË¶ÅË¢´Â§öÊï∞Ê¥æÈõÜÂêà‰∏≠ÁöÑÊØè‰∏™ Acceptor Êé•Âèó„ÄÇÊÉ≥Ë¶ÅÁü•ÈÅì‰∏Ä‰∏™Â∑≤ÁªèË¢´Êé•ÂèóÁöÑÊèêÊ°àÂæàÁÆÄÂçïÔºå‰ΩÜË¶ÅÈ¢ÑÊµã‰∏Ä‰∏™Â∞ÜË¶ÅË¢´Êé•ÂèóÁöÑÊèêÊ°àÂæàÈöæ„ÄÇÊâÄ‰ª• Proposer ÈÄöËøáÂêë Acceptor Ëé∑Âèñ‰∏Ä‰∏™ÊâøËØ∫Êù•‰ª£ÊõøÈ¢ÑÊµãÊú™Êù•ÔºàËøôÈáåÊåáÈ¢ÑÊµãÂ∞ÜË¶ÅË¢´Â§öÊï∞Ê¥æÈõÜÂêà‰∏≠ÁöÑ Acceptor Êé•ÂèóÁöÑÊèêÊ°àÔºâ„ÄÇÊç¢Âè•ËØùËØ¥ÔºåProposer ‰ºöËØ∑Ê±Ç Acceptor ‰∏çË¶ÅÂÜçÊé•ÂèóÁºñÂè∑Â∞è‰∫é n ÁöÑÊèêÊ°à„ÄÇËøôÂ∞±Â∞ÜÊàë‰ª¨ÂºïÂÖ•Âà∞‰ª•‰∏ãÂèëÂ∏ÉÊèêÊ°àÁöÑÁÆóÊ≥ï‰∏≠„ÄÇ A proposer chooses a new proposal number n and sends a request to each member of some set of acceptors, asking it to respond with: (a) A promise never again to accept a proposal numbered less than n, and (b) The proposal with the highest number less than n that it has accepted, if any. I will call such a request a prepare request with number n. ÁøªËØëÔºö ‰∏Ä‰∏™ Propoer ÈÄâ‰∏Ä‰∏™Êñ∞ÁöÑÊèêÊ°àÁºñÂè∑ n ÂêëÊüê‰∏™ Acceptor ÈõÜÂêà‰∏≠ÁöÑÊØè‰∏™ÊàêÂëòÂèëÈÄÅËØ∑Ê±ÇÔºåÂπ∂Ëé∑ÂèñÂìçÂ∫îÔºö (a) ‰∏Ä‰∏™‰∏ç‰ºöÂÜçÊé•ÂèóÊèêÊ°àÁºñÂè∑Â∞è‰∫é n ÁöÑÊèêÊ°àÁöÑÊâøËØ∫ (promise)ÔºåÂíå (b) Â¶ÇÊûúÂ≠òÂú®ÔºåËøîÂõûÁºñÂè∑Â∞è‰∫é n ÁöÑÊèêÊ°à‰∏≠ÁºñÂè∑ÊúÄÂ§ßÁöÑÊèêÊ°à„ÄÇ ÊàëÁß∞Ëøô‰∏™ËØ∑Ê±Ç‰∏∫ÁºñÂè∑ n ÁöÑ prepare request„ÄÇ If the proposer receives the requested responses from a majority of the acceptors, then it can issue a proposal with number n and value v, where v is the value of the highest-numbered proposal among the responses, or is any value selected by the proposer if the responders reported no proposals. ÁøªËØëÔºö Â¶ÇÊûú Proposer Ëé∑ÂèñÂà∞‰∫ÜÂ§ßÂ§öÊï∞ Acceptor ÈõÜÂêàÁöÑÂìçÂ∫îÔºåÈÇ£‰πàÂÆÉÂ∞±ËÉΩÂèëÂ∏ÉÁºñÂè∑‰∏∫ n ‰∏îÊèêÊ°àÂÄº‰∏∫ vÁöÑÊèêÊ°àÔºåÊ≠§Â§Ñ v ÊòØÊâÄÊúâÁõ∏Â∫î‰∏≠Ëé∑ÂèñÂà∞ÁöÑÁºñÂè∑ÊúÄÂ§ßÁöÑÊèêÊ°àÁöÑÂÄºÔºåÊàñËÄÖÊòØ Proposer ÈÄâÊã©ÁöÑ‰ªªÊÑèÂÄº (‰∏™‰∫∫ËÆ§‰∏∫ËøôÈáåÊåá prepare request ËøáÁ®ã‰∏≠Ëé∑ÂèñÁöÑÂìçÂ∫î‰∏≠‰∏çÂê´ÊúâÊèêÊ°àÔºåÊÑèÂë≥ÁùÄ Acceptor Êú™Êé•Âèó‰ªª‰ΩïÊèêÊ°à) Proposer ÈÄöËøáÂêë‰∏ÄÁªÑ Acceptors ÂèëÈÄÅÊèêËÆÆË¢´Êé•ÂèóÁöÑËØ∑Ê±ÇÊù•ÂèëÂ∏ÉÊèêËÆÆ (‰∏çÈúÄË¶ÅÂíåÂìçÂ∫îÂàùÂßãÂåñËØ∑Ê±ÇÁöÑÈõÜÂêà‰∏ÄÊ†∑)„ÄÇÊàë‰ª¨Áß∞Ëøô‰∏™Èò∂ÊÆµ‰∏∫ accept request„ÄÇ ËøôÂ∞±ÊèèËø∞‰∫Ü‰∏Ä‰∏™ Proposer ÁöÑÁÆóÊ≥ï„ÄÇÈÇ£ Acceptor Âë¢ÔºüÂÆÉËÉΩÊé•Âèó Proposer ÁöÑ‰∏§ÁßçËØ∑Ê±ÇÔºöprepare request Âíå accept request„ÄÇAcceptor ÂèØ‰ª•Âú®‰∏çÂΩ±ÂìçÂÆâÂÖ®ÁöÑÊÉÖÂÜµ‰∏ãÂøΩÁï•‰ªª‰ΩïËØ∑Ê±Ç„ÄÇÊâÄ‰ª•ÔºåÂΩìÂÆÉË¢´ÂÖÅËÆ∏ÂìçÂ∫î‰∏Ä‰∏™ËØ∑Ê±ÇÊó∂ÔºåÂÆÉ‰∏ÄÂÆöËÉΩÂìçÂ∫î prepare request„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÊâøËØ∫‰∏çÊé•ÂèóÔºå‰πüÂèØ‰ª•ÂìçÂ∫î accept request Âπ∂Êé•Âèó‰∏Ä‰∏™ÊèêÊ°à„ÄÇÊç¢Âè•ËØùËØ¥Ôºö P1a. An acceptor can accept a proposal numbered n iff it has not responded to a prepare request having a number greater than n. ÁøªËØëÔºöÂ¶ÇÊûú‰∏Ä‰∏™ Acceptor Ê≤°ÊúâÂìçÂ∫îËøáÁºñÂè∑Â§ß‰∫é n ÁöÑ prepare requestÔºåÂÆÉÂ∞±ËÉΩÊé•ÂèóÁºñÂè∑‰∏∫ n ÁöÑÊèêËÆÆ„ÄÇ ÂèØ‰ª•ËßÇÂØüÂà∞ P1a ÂåÖÂê´‰∫Ü P1„ÄÇ(Ëß£ÈáäÔºöP1 ‰∏≠ËØ¥Êòé Acceptor ‰∏ÄÂÆö‰ºöÊé•ÂèóÂÆÉÊî∂Âà∞ÁöÑÁ¨¨‰∏Ä‰∏™ÊèêËÆÆÔºåÊâÄ‰ª• P1a ‰∏ÄÂÆöÂåÖÂê´‰∫Ü P1) Áé∞Âú®Êàë‰ª¨ÂØπ Choosing a Value Êúâ‰∫Ü‰∏Ä‰∏™ÂÆåÊï¥ÁöÑÊª°Ë∂≥ÂÆâÂÖ®ÊÄß (ÂÅáËÆæÊèêÊ°àÁºñÂè∑ÂîØ‰∏Ä) ÁöÑÁÆóÊ≥ï„ÄÇÊàë‰ª¨ÈÄöËøá‰∏Ä‰∏™Â∞è‰ºòÂåñÊù•ÂæóÂà∞ÊúÄÁªàÁöÑÁÆóÊ≥ï„ÄÇ ÂÅáËÆæ‰∏Ä‰∏™ Acceptor Êî∂Âà∞‰∫Ü‰∏Ä‰∏™Âê´ÊúâÁºñÂè∑ n ÁöÑ prepare requestÔºå‰ΩÜÊòØÂÆÉÂ∑≤ÁªèÂìçÂ∫îËøáÁºñÂè∑Â§ß‰∫é n ÁöÑ prepare request ‰∫ÜÔºå‰ªéËÄåÊâøËØ∫‰∏ç‰ºöÊé•ÂèóÁºñÂè∑‰∏∫ n ÁöÑÊèêÊ°à‰∫Ü„ÄÇÈÇ£‰πàËøô‰∏™ Acceptor Ê≤°ÊúâÁêÜÁî±ÂìçÂ∫îËøô‰∏™Êñ∞ÁöÑËØ∑Ê±ÇÔºåÂõ†‰∏∫ÂÆÉ‰∏ç‰ºöÊé•Âèó Proposer ÊÉ≥Ë¶ÅÊèêÂá∫ÁöÑÁºñÂè∑‰∏∫ n ÁöÑÊèêÊ°à„ÄÇÊâÄ‰ª•Êàë‰ª¨ËÆ© Acceptor ÂøΩÁï•ËøôÊ†∑ÁöÑ prepare requestÔºåÊàë‰ª¨‰πüËÆ©ÂÆÉÂøΩÁï•Â∑≤ÁªèÊé•ÂèóËøáÁöÑÊèêÊ°àÁöÑ prepare request„ÄÇ ÈÄöËøáËøô‰∏™‰ºòÂåñÔºå‰∏Ä‰∏™ Acceptor Âè™ÈúÄË¶ÅËÆ∞‰ΩèÂÆÉÂ∑≤ÁªèÊé•ÂèóËøáÁöÑÁºñÂè∑ÊúÄÂ§ßÁöÑÊèêÊ°àÂíåÂÆÉÂìçÂ∫îÁöÑÊúÄÂ§ßÁºñÂè∑ÁöÑ prepare request ‰∏≠ÁöÑÁºñÂè∑„ÄÇÂõ†‰∏∫Êó†ËÆ∫ÊòØÂê¶Â§±Ë¥•ÔºåÂøÖÈ°ªË¶Å‰øùÊåÅ P2c ‰∏çÂèòÔºå‰∏Ä‰∏™ Acceptor Âç≥‰ΩøÂ§±Ë¥•ÈáçÂêØ‰πüÂøÖÈ°ªËÆ∞‰ΩèËøô‰∏™‰ø°ÊÅØ„ÄÇËØ∑Ê≥®ÊÑèÔºåProposer ÂèØ‰ª•ÊîæÂºÉÂπ∂‰∏îÂøòËÆ∞‰∏Ä‰∏™ÊèêÊ°à‚Äî‚ÄîÂè™Ë¶ÅÂÆÉÊ∞∏Ëøú‰∏ç‰ºöÂ∞ùËØïÊèêÂá∫Âè¶‰∏Ä‰∏™ÁºñÂè∑Áõ∏ÂêåÁöÑÊèêÊ°à„ÄÇ ÊääËøô‰∫õ Proposer Âíå Acceptor ÁöÑË°å‰∏∫ÊîæÂú®‰∏ÄËµ∑ÔºåÊàë‰ª¨ËÉΩÂèëÁé∞Ëøô‰∏™ÁÆóÊ≥ïÊâßË°å‰∫Ü‰∏ãÈù¢‰∏§‰∏™Èò∂ÊÆµÔºö Phase 1. (a) A proposer selects a proposal number n and sends a prepare request with number n to a majority of acceptors. (b) If an acceptor receives a prepare request with number n greater than that of any prepare request to which it has already responded, then it responds to the request with a promise not to accept any more proposals numbered less than n and with the highest-numbered proposal (if any) that it has accepted. ÁøªËØëÔºöÈò∂ÊÆµ‰∏ÄÔºö(a) ‰∏Ä‰∏™ Proposer ÈÄâÊã©‰∏Ä‰∏™ÊèêÊ°àÁºñÂè∑ n Âπ∂Âêë‰∏Ä‰∏™Â§öÊï∞Ê¥æÈõÜÂêà‰∏≠ÁöÑ Acceptors ÂèëÈÄÅ prepare request„ÄÇ(b) Â¶ÇÊûú‰∏Ä‰∏™ Acceptor Êî∂Âà∞‰∫Ü‰∏Ä‰∏™ prepare requestÔºåÂÖ∂‰∏≠Âê´ÊúâÁöÑÁºñÂè∑ n Â§ß‰∫éÊâÄÊúâÂÆÉÂ∑≤ÁªèÂìçÂ∫îËøáÁöÑ prepare request ÁöÑÁºñÂè∑ÔºåÈÇ£‰πàÂÆÉ‰ºöÂìçÂ∫îËøô‰∏™ËØ∑Ê±ÇÔºåÊâøËØ∫‰∏ç‰ºöÂÜçÊé•ÂèóÊèêÊ°àÁºñÂè∑Â∞è‰∫é n ÁöÑÊèêÊ°àÂíåÂÆÉÊé•ÂèóËøáÁöÑÊúÄÈ´òÁºñÂè∑ÁöÑÊèêÊ°àÔºàÂ¶ÇÊûúÂ≠òÂú®Ôºâ„ÄÇ Phase 2. (a) If the proposer receives a response to its prepare requests (numbered n) from a majority of acceptors, then it sends an accept request to each of those acceptors for a proposal numbered n with a value v, where v is the value of the highest-numbered proposal among the responses, or is any value if the responses reported no proposals. (b) If an acceptor receives an accept request for a proposal numbered n, it accepts the proposal unless it has already responded to a prepare request having a number greater than n. ÁøªËØëÔºöÈò∂ÊÆµ‰∫åÔºö(a) Â¶ÇÊûú Proposer ‰ªé‰∏Ä‰∏™Â§öÊï∞Ê¥æÈõÜÂêàÁöÑ Acceptors Êî∂Âà∞‰∫ÜÂÆÉÂèëÈÄÅÁöÑ prepare request ÁöÑÂìçÂ∫î (ÁºñÂè∑‰∏∫ n)ÔºåÈÇ£‰πàÂÆÉ‰ºö‰ª•ÁºñÂè∑‰∏∫ n ÂÄº‰∏∫ v ÁöÑÊèêÊ°àÂêëËøô‰∏™ÈõÜÂêà‰∏≠ÊØè‰∏™ Acceptor ÂèëÈÄÅ‰∏Ä‰∏™ accept reqeust ÔºåÊ≠§Â§Ñ v ÊòØÂìçÂ∫î‰∏≠ÁºñÂè∑ÊúÄÂ§ßÁöÑÊèêÊ°àÁöÑÊèêÊ°àÂÄºÔºåÊàñËÄÖÔºàÂ¶ÇÊûúÂìçÂ∫î‰∏≠Ê≤°ÊúâÊèêÊ°àÔºâ‰∏Ä‰∏™‰ªªÊÑèÁöÑÂÄº„ÄÇ (b) Â¶ÇÊûú‰∏Ä‰∏™ Acceptor Êî∂Âà∞‰∫Ü‰∏Ä‰∏™ÁºñÂè∑‰∏∫ n ÁöÑ accept requestÔºåÈô§Èùû‰ªñÂ∑≤ÁªèÂìçÂ∫îËøáÊåÅÊúâÁºñÂè∑Â§ß‰∫é n ÁöÑ prepare requestÔºåÈÇ£‰πàÂÆÉÂ∞Ü‰ºöÊé•ÂèóËøô‰∏™ÊèêÊ°à„ÄÇ ‰∏Ä‰∏™ Proposer ËÉΩÂèëÂ∏ÉÂ§ö‰∏™ÊèêÊ°àÔºåÂè™Ë¶ÅÊØè‰∏™ÈÉΩÈÅµÂæ™Ëøô‰∏™ÁÆóÊ≥ï„ÄÇ‰ªñËÉΩÈöèÊó∂ÊîæÂºÉÂçèËÆÆ‰∏≠ÁöÑÊèêÊ°àÔºàÂ∞ΩÁÆ°ËØ∑Ê±ÇÂíå(ÊàñËÄÖ)ÂìçÂ∫îÂú®ÊèêÊ°àË¢´ÊîæÂºÉÂæà‰πÖ‰πãÂêéÊâçÂà∞ËææÔºå‰ªçÁÑ∂ËÉΩ‰øùÊåÅÊ≠£Á°ÆÊÄß„ÄÇÔºâÂ¶ÇÊûúÊüê‰∏™ Proposer Â∑≤ÁªèÂèëÂ∏É‰∫ÜÁºñÂè∑Êõ¥È´òÁöÑÊèêÊ°àÈÇ£‰πàÊîæÂºÉÊèêÊ°àÂèØËÉΩÊòØ‰∏Ä‰∏™Â•Ω‰∏ªÊÑè„ÄÇÂõ†Ê≠§ÔºåÂ¶ÇÊûú‰∏Ä‰∏™ Acceptor ÂøΩÁï•‰∫Ü‰∏Ä‰∏™ prepare request ÊàñËÄÖ accept requestÔºåÊòØÂõ†‰∏∫ÂÆÉÂ∑≤ÁªèÊî∂Âà∞‰∫ÜÁºñÂè∑Êõ¥È´òÁöÑ prepare requestÔºåÈÇ£‰πàËøôÊó∂ÂÆÉÂ∫îËØ•ÈÄöÁü•ÂèëÂ∏ÉËøô‰∏™ÊèêÊ°àÁöÑ Proposer Â∫îËØ•ÊîæÂºÉËøô‰∏™ÊèêÊ°à„ÄÇËøôÂ∞±ÊòØ‰∏çÂΩ±ÂìçÊ≠£Á°ÆÊÄßÁöÑÊÄßËÉΩ‰ºòÂåñ„ÄÇ Learning a Chosen Value‚Äî‚Äî Êú™ÂÆåÂæÖÁª≠ ‚Äî‚Äî]]></content>
      <tags>
        <tag>Algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java ÂûÉÂúæÂõûÊî∂]]></title>
    <url>%2Fjvm-garbage-collection%2F</url>
    <content type="text"><![CDATA[ÂÖ≥‰∫é Java ÂõûÊî∂ÁöÑÊñáÁ´†Â§ßÂêåÂ∞èÂºÇÔºåÊàëÂ∞ÜÊàëÊü•ÈòÖÁöÑÂêÑÁßçËµÑÊñôÊï¥Âêà‰∫Ü‰∏Ä‰∏ãÔºåÂèñÊñáÁ´†‰∏≠ÂÜôÁöÑÂ•ΩÁöÑÈÉ®ÂàÜ‰ª•ÂèäËá™ÊàëÊÄªÁªìÔºåÂÜôÂá∫ËøôÁØáÊñáÁ´†„ÄÇ Java Â†ÜÁ©∫Èó¥ÁöÑÂü∫Êú¨ÁªìÊûÑ ‰∏äÂõæÁöÑ Eden Âå∫Âíå Survivor From Âå∫„ÄÅSurvivor To Âå∫ÈÉΩÂ±û‰∫éÊñ∞Áîü‰ª£ÔºåTenured Âå∫Â±û‰∫éËÄÅÂπ¥‰ª£ÔºåÂú®Â§ßÈÉ®ÂàÜÊÉÖÂÜµÔºåÂØπË±°È¶ñÂÖà‰ºöÂú® Eden Âå∫ÂüüÂàÜÈÖçÔºåÂú®Á¨¨‰∏ÄÊ¨°Êñ∞Áîü‰ª£ÂûÉÂúæÂõûÊî∂ÔºàMinor GCÔºâÂêéÔºåÂ¶ÇÊûúÂØπË±°ËøòÂ≠òÊ¥ªÔºåÂàôËØ•ÂØπË±°‰ºöËøõÂÖ• Survivor To Âå∫ÔºåÂπ∂‰∏îÂπ¥ÈæÑ‰ºöÂä†1ÔºàÁ¨¨‰∏ÄÊ¨°‰ªé Eden Âà∞ Survivor Âå∫Êó∂Âπ¥ÈæÑÊòØ1ÔºâÔºåÂΩìÂπ¥ÈæÑÂà∞Ëææ‰∏ÄÂÆöÁ®ãÂ∫¶Êó∂ÔºàÈªòËÆ§‰∏∫ 15 Â≤ÅÔºå‰ΩÜÊòØ‰∏ç‰∏ÄÂÆöÂøÖÈ°ªÂà∞Ëææ 15 Â≤ÅÊâç‰ºöËøõÂÖ•ËÄÅÂπ¥‰ª£Âå∫ÔºâÔºåÂØπË±°‰ºöË¢´ÊôãÂçáÂà∞ËÄÅÂπ¥‰ª£‰∏≠ÔºåÂØπË±°ÊôãÂçáÂà∞ËÄÅÂπ¥‰ª£ÁöÑÂπ¥ÈæÑÈòÄÂÄºÔºåÂèØ‰ª•ÈÄöËøáËÆæÁΩÆÂèÇÊï∞ -XX:MaxTenuringThreshold Êù•ÊéßÂà∂„ÄÇÁªèËøáËøôÊ¨° GC ‰πãÂêéÔºåEden Âå∫ Âíå From Âå∫Â∑≤ÁªèË¢´Ê∏ÖÁ©∫ÔºåËøôÊó∂ÂÄôÔºåFrom Âíå To ‰ºö‰∫§Êç¢‰ªñ‰ª¨ÁöÑËßíËâ≤Ôºå‰πüÂ∞±ÊòØËØ¥Ê≠§Êó∂Êñ∞ÁöÑ Survivor To Âå∫Â∞±ÊòØ GC ‰πãÂâçÁöÑ Survivor From Âå∫ÔºåÊñ∞ÁöÑ Survivor From Âå∫Â∞±ÊòØ GC ‰πãÂâçÁöÑ Survivor To Âå∫„ÄÇMinor GC ‰ºö‰∏ÄÁõ¥ÈáçÂ§çËøô‰∏™ËøáÁ®ãÔºåÁõ¥Âà∞ Survivor To Âå∫Ë¢´Â°´Êª°ÔºåTo Âå∫Ë¢´Â°´Êª°‰πãÂêéÔºå‰ºöÂ∞ÜÊâÄÊúâÂØπË±°ÁßªÂä®Âà∞ËÄÅÂπ¥‰ª£‰∏≠„ÄÇ Â†ÜÂÜÖÂ≠òÂ∏∏ËßÅÁöÑÂàÜÈÖçÁ≠ñÁï•Ôºö ÂØπË±°‰ºòÂÖàÂàÜÈÖçÂú® Eden Âå∫ Â§ßÂØπË±°Áõ¥Êé•ËøõÂÖ•ËÄÅÂπ¥‰ª£ ÈïøÊúüÂ≠òÊ¥ªÁöÑÂØπË±°Â∞ÜËøõÂÖ•ËÄÅÂπ¥‰ª£ Java ÂûÉÂúæÊî∂ÈõÜÁÆóÊ≥ïÊ†áËÆ∞ - Ê∏ÖÈô§ÁÆóÊ≥ïËØ•ÁÆóÊ≥ïÈ¶ñÂÖàÊ†áËÆ∞Âá∫ÈúÄË¶ÅÂõûÊî∂ÁöÑÂØπË±°ÔºåÂú®Ê†áËÆ∞ÂÆåÊàêÂêéÁªü‰∏ÄÂõûÊî∂ÊâÄÊúâË¢´Ê†áËÆ∞ÁöÑÂØπË±°„ÄÇËØ•ÁÆóÊ≥ïÊòØÂûÉÂúæÂõûÊî∂ÊúÄÂü∫Á°ÄÁöÑÁÆóÊ≥ïÔºåÂêéÁª≠ÁöÑÁÆóÊ≥ïÈÉΩÊòØÂØπÂÖ∂‰∏çË∂≥ËøõË°åÊîπËøõÂæóÂà∞ÁöÑ„ÄÇÂÆÉ‰ºöÂ∏¶Êù•‰∏§‰∏™ÂæàÊòéÊòæÁöÑÈóÆÈ¢òÔºö ÊïàÁéáÈóÆÈ¢ò Á©∫Èó¥Êµ™Ë¥πÈóÆÈ¢òÔºàÊ†áËÆ∞Ê∏ÖÈô§Âêé‰ºö‰∫ßÁîüÂ§ßÈáè‰∏çËøûÁª≠ÁöÑÁ¢éÁâáÔºåÂØºËá¥Â§ßÈáèÁ©∫Èó¥Êó†Ê≥ï‰ΩøÁî®Ôºâ Â§çÂà∂ÁÆóÊ≥ïÂ∞ÜÂ†ÜÂÜÖÂ≠òÂàÜ‰∏∫Â§ßÂ∞èÁõ∏ÂêåÁöÑ‰∏§ÂùóÔºåÊØèÊ¨°Âè™‰ΩøÁî®‰∏ÄÂùó„ÄÇËøôÂùóÂÜÖÂ≠ò‰ΩøÁî®ÂÆåÂêéÔºåÂ∞ÜËøòÂ≠òÊ¥ªÁöÑÂØπË±°Â§çÂà∂Âà∞Âè¶‰∏ÄÂùóÂÜÖÂ≠ò‰∏≠ÔºåÁÑ∂ÂêéÊää‰ΩøÁî®ÁöÑÁ©∫Èó¥‰∏ÄÊ¨°ÂÖ®ÈÉ®Ê∏ÖÁêÜÔºåËøôÊ†∑ÊØèÊ¨°ÂõûÊî∂ÈÉΩÂè™ÂØπÂÜÖÂ≠òÁöÑ‰∏ÄÂçäËøõË°åÂõûÊî∂„ÄÇ ËøôÊ†∑‰πü‰ºöÊúâ‰∏ÄÂÆöÁöÑÈóÆÈ¢òÔºåÂ∞±Â•ΩÊØîÊàë‰ª¨‰π∞‰∫Ü200Âπ≥ÁöÑÊàøÂ≠êÔºåÂç¥Âè™ËÉΩ‰ΩøÁî®100Âπ≥ÔºåËøôÂ∞±ÈÄ†Êàê‰∫Ü‰ΩøÁî®Á©∫Èó¥ÁöÑÁº©Â∞è„ÄÇ Ê†áËÆ∞ - Êï¥ÁêÜÁÆóÊ≥ïÈíàÂØπËÄÅÂπ¥‰ª£ÁâπÁÇπÁâπÂá∫ÁöÑ‰∏ÄÁßçÊ†áËÆ∞ÁÆóÊ≥ïÔºåËøáÁ®ã‰∏é‚ÄúÊ†áËÆ∞ - Ê∏ÖÈô§‚ÄùÁÆóÊ≥ï‰∏ÄÊ†∑Ôºå‰ΩÜÊòØÊ†áËÆ∞‰πãÂêé‰∏çÊòØÁõ¥Êé•ÂØπÂèØÂõûÊî∂ÂØπË±°ËøõË°åÂõûÊî∂ÔºåËÄåÊòØËÆ©ÊâÄÊúâÂ≠òÊ¥ªÂØπË±°Âêë‰∏ÄÁ´ØÁßªÂä®ÔºåÁÑ∂ÂêéÊ∏ÖÁêÜÊéâÂ≠òÊ¥ªÂØπË±°Á´ØËæπÁïå‰ª•Â§ñÁöÑÂÜÖÂ≠ò„ÄÇ ÂàÜ‰ª£Êî∂ÈõÜÁÆóÊ≥ï ÈóÆÈ¢òÔºöHotSpot ‰∏∫‰ªÄ‰πàË¶ÅÂàÜ‰∏∫Êñ∞Áîü‰ª£ÂíåËÄÅÂπ¥‰ª£Ôºü Ê†πÊçÆÂØπË±°Â≠òÊ¥ªÂë®ÊúüÁöÑ‰∏çÂêåÂ∞ÜÂÜÖÂ≠òÂàÜ‰∏∫Âá†ÂùóÔºà‰∏ÄËà¨Â∞Ü Java Â†ÜÂàÜ‰∏∫Êñ∞Áîü‰ª£ÂíåËÄÅÂπ¥‰ª£ÔºâÔºåËøôÊ†∑Â∞±ÂèØ‰ª•Ê†πÊçÆÂêÑÂπ¥‰ª£ÁöÑÁâπÁÇπÊù•ÈÄâÊã©ÂêàÈÄÇÁöÑÂûÉÂúæÊî∂ÈõÜÁÆóÊ≥ï„ÄÇ ÊØîÂ¶ÇÂú®Êñ∞Áîü‰ª£‰∏≠ÔºåÊØèÊ¨°ÂûÉÂúæÊî∂ÈõÜÈÉΩ‰ºöÊúâÂ§ßÈáèÁöÑÂØπË±°Ê≠ªÂéªÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÈÄâÊã©Â§çÂà∂ÁÆóÊ≥ïÔºåÂè™ÈúÄË¶Å‰ªòÂá∫Â∞ëÈáèÂØπË±°ÁöÑÂ§çÂà∂ÊàêÊú¨ÂàôÂèØ‰ª•ÂÆåÊàêÊØèÊ¨°ÂûÉÂúæÊî∂ÈõÜ„ÄÇËÄåËÄÅÂπ¥‰ª£‰∏≠ÂØπË±°ÁöÑÂ≠òÊ¥ªÂá†ÁéáÈÉΩÊòØÊØîËæÉÈ´òÁöÑÔºåËÄå‰∏îÊ≤°ÊúâÈ¢ùÂ§ñÁöÑÁ©∫Èó¥ÂØπÂÆÉËøõË°åÂàÜÈÖçÊãÖ‰øùÔºåÊâÄ‰ª•Êàë‰ª¨ÂøÖÈ°ªÈÄâÊã© ‚ÄúÊ†áËÆ∞ - Ê∏ÖÈô§‚Äù ÊàñËÄÖ ‚ÄúÊ†áËÆ∞ - Êï¥ÁêÜ‚Äù ÁÆóÊ≥ïËøõË°åÂûÉÂúæÊî∂ÈõÜ„ÄÇ ÂûÉÂúæÊî∂ÈõÜÂô®ÂõæÁâáÊù•Ê∫êÔºöËØª‰π¶Á¨îËÆ∞‚ÄîÊ∑±ÂÖ•ÁêÜËß£JavaËôöÊãüÊú∫1 Êñ∞Áîü‰ª£‰∏≤Ë°åÊî∂ÈõÜÂô® - Serial‰∏≤Ë°åÊî∂ÈõÜÂô®‰∏ªË¶ÅÊúâ‰∏§‰∏™ÁâπÁÇπÔºö1„ÄÅ‰ΩøÁî®ÂçïÁ∫øÁ®ãËøõË°åÂûÉÂúæÂõûÊî∂Ôºõ2„ÄÅÁã¨Âç†ÂºèÁöÑÂûÉÂúæÂõûÊî∂„ÄÇ Âú®‰∏≤Ë°åÊî∂ÈõÜÂô®ËøõË°åÂûÉÂúæÂõûÊî∂Êó∂ÔºåJava Â∫îÁî®Á®ãÂ∫è‰∏≠ÁöÑÁ∫øÁ®ãÈÉΩÈúÄË¶ÅÊöÇÂÅúÔºåÁ≠âÂæÖÂûÉÂúæÂõûÊî∂ÂÆåÊàêÔºåËøôÊ†∑Â∞±‰ºöÈÄ†ÊàêËæÉÂ∑ÆÁöÑÁî®Êà∑‰ΩìÈ™å„ÄÇ‰ΩÜÊòØ‰∏≤Ë°åÊî∂ÈõÜÂô®‰ªçÁÑ∂ÊòØ‰∏Ä‰∏™ÊàêÁÜüÁöÑ„ÄÅÁªèËøáÈïøÊó∂Èó¥Áîü‰∫ßÁéØÂ¢ÉËÄÉÈ™åÁöÑÊûÅ‰∏∫È´òÊïàÁöÑÊî∂ÈõÜÂô®„ÄÇ Êñ∞Áîü‰ª£‰∏≤Ë°åÊî∂ÈõÜÂô®ÈááÁî®Â§çÂà∂ÁÆóÊ≥ïÔºåÂÆûÁé∞Áõ∏ÂØπÁÆÄÂçïÔºåÂπ∂‰∏îÊ≤°ÊúâÁ∫øÁ®ãÂàáÊç¢ÁöÑÂºÄÈîÄ„ÄÇÂú® HotSpot ËôöÊãüÊú∫‰∏≠Ôºå‰ΩøÁî® -XX:+UseSerialGC ÂèÇÊï∞ÂèØ‰ª•ÊåáÂÆöÊñ∞Áîü‰ª£‰∏≤Ë°åÊî∂ÈõÜÂô®ÂíåËÄÅÂπ¥‰ª£‰∏≤Ë°åÊî∂ÈõÜÂô®„ÄÇÂΩì JVM Âú® Client Ê®°Âºè‰∏ãËøêË°åÊó∂ÔºåÈªòËÆ§‰ΩøÁî®Êñ∞Áîü‰ª£‰∏≤Ë°åÊî∂ÈõÜÂô®„ÄÇ‰∏ÄÊ¨°Êñ∞Áîü‰ª£‰∏≤Ë°åÊî∂ÈõÜÂô®ÁöÑÂ∑•‰ΩúËæìÂá∫Êó•ÂøóÁ±ª‰ºº‰∫é‰∏ãÔºà‰ΩøÁî® -XX:PrintGCDetails ÂºÄÂÖ≥ÔºâÔºö 1234[GC [DefNew: 3468K-&gt;150K(9216K), 0.0028638 secs][Tenured: 1562K-&gt;1712K(10240K), 0.0084220 secs] 3468K-&gt;1712K(19456K), [Perm : 377K-&gt;377K(12288K)], 0.0113816 secs] [Times: user=0.02 sys=0.00, real=0.01 secs] ÂÆÉÊòæÁ§∫‰∫ÜÂûÉÂúæÂõûÊî∂‰πãÂâçÊñ∞Áîü‰ª£ÁöÑÂç†Áî®ÂÜÖÂ≠òÂíåÂûÉÂúæÂõûÊî∂ÂêéÁöÑÂç†Áî®ÂÜÖÂ≠òÔºå‰ª•ÂèäÂûÉÂúæÂõûÊî∂ÁöÑÊó∂Èó¥„ÄÇ Êñ∞Áîü‰ª£Âπ∂Ë°åÊî∂ÈõÜÂô® - ParNewÂÆÉÊòØÊñ∞Áîü‰ª£‰∏≤Ë°åÊî∂ÈõÜÂô®ÁöÑÂ§öÁ∫øÁ®ãÁâàÊú¨ÔºåÂûÉÂúæÂõûÊî∂Êó∂‰πü‰ºöÊöÇÂÅú Java Â∫îÁî®Á®ãÂ∫èÁöÑÁ∫øÁ®ã„ÄÇÂÆÉÈô§‰∫Ü‰ΩøÁî®Â§öÁ∫øÁ®ãÂ§ÑÁêÜÂûÉÂúæÂõûÊî∂Â§ñÔºåÂÖ∂‰ªñÁöÑÂäüËÉΩ‰∏é Serial Êî∂ÈõÜÂô®‰∏ÄÊ†∑„ÄÇÂú®Âçï CPU ÁöÑÁéØÂ¢É‰∏ãÔºåParNew Êî∂ÈõÜÂô®ÁöÑË°®Áé∞‰∏ç‰ºöÊØî Serial Êõ¥‰ºòÁßÄ„ÄÇ Parallel Scavenge Êî∂ÈõÜÂô®Parallel Scavenge Êî∂ÈõÜÂô®‰πüÊòØ‰ΩøÁî®Â§çÂà∂ÁÆóÊ≥ïÁöÑÂ§öÁ∫øÁ®ãÂûÉÂúæÊî∂ÈõÜÂô®ÔºåÂÆÉÁúã‰∏äÂéªÂá†‰πéÂíå ParNer ‰∏ÄÊ®°‰∏ÄÊ†∑„ÄÇ‰ΩÜÊòØ Parallel Scavenge Êî∂ÈõÜÂô®ÁöÑÂÖ≥Ê≥®ÁÇπÊòØÂêûÂêêÈáèÔºàÈ´òÊïàÁéáÁöÑÂà©Áî® CPUÔºâÔºåÂêûÂêêÈáèÂ∞±ÊòØ CPU ‰∏≠Áî®‰∫éËøêË°åÁî®Êà∑‰ª£Á†ÅÁöÑÊó∂Èó¥‰∏é CPU ÊÄªÊ∂àËÄóÊó∂Èó¥ÁöÑÊØîÂÄº„ÄÇËÄå CMS Á≠âÂûÉÂúæÊî∂ÈõÜÂô®ÂÖ≥Ê≥®ÁöÑÊõ¥Â§öÁöÑÊòØÁî®Êà∑Á∫øÁ®ãÁöÑÂÅúÈ°øÊó∂Èó¥ÔºåÊèêÈ´òÁî®Êà∑‰ΩìÈ™å„ÄÇParallel Scavenge Êî∂ÈõÜÂô®Êèê‰æõ‰∫ÜÂæàÂ§öÂèÇÊï∞‰æõÁî®Êà∑ÊâæÂà∞ÊúÄÈÄÇÂêàÁöÑÂÅúÈ°øÊó∂Èó¥ÊàñÊúÄÂ§ßÁöÑÂêûÂêêÈáè„ÄÇ 12-XX:UseParallelGC // ‰ΩøÁî® Parrallel Êî∂ÈõÜÂô®ÔºàÊñ∞Áîü‰ª£ÔºâÔºåËÄÅÂπ¥‰ª£‰ΩøÁî®‰∏≤Ë°åÊî∂ÈõÜÂô®-XX:UseParallelOldGC // ‰ΩøÁî® Parallel Êî∂ÈõÜÂô®ÔºåËÄÅÂπ¥‰ª£Âπ∂Ë°å Ê≠§Êî∂ÈõÜÂô®‰∏≠ÔºåÊñ∞Áîü‰ª£ÈááÁî®Â§çÂà∂ÁÆóÊ≥ïÔºåËÄÅÂπ¥‰ª£ÈááÁî®‚ÄúÊ†áËÆ∞-Êï¥ÁêÜ‚ÄùÁÆóÊ≥ï ËÄÅÂπ¥‰ª£‰∏≤Ë°åÊî∂ÈõÜÂô® - Serial OldËÄÅÂπ¥‰ª£‰∏≤Ë°åÊî∂ÈõÜÂô®ÊòØ Serial Êî∂ÈõÜÂô®ÁöÑËÄÅÂπ¥‰ª£ÁâàÊú¨ÔºåÂêåÊ†∑ÊòØÂçïÁ∫øÁ®ãÔºå‰ΩÜÊòØÂÆÉ‰ΩøÁî®Ê†áËÆ∞-Êï¥ÁêÜÁÆóÊ≥ï„ÄÇ‰ªñ‰πüÊòØ‰∏Ä‰∏™‰∏≤Ë°åÁöÑ„ÄÅÁã¨Âç†ÂºèÁöÑÂûÉÂúæÂõûÊî∂Âô®„ÄÇÁî±‰∫éËÄÅÂπ¥‰ª£ÂûÉÂúæÂõûÊî∂ÈÄöÂ∏∏‰ºö‰ΩøÁî®ÊØîÊñ∞Áîü‰ª£ÂûÉÂúæÂõûÊî∂Êõ¥ÈïøÁöÑÊó∂Èó¥ÔºåÂõ†Ê≠§ÔºåÂú®Â†ÜÁ©∫Èó¥ËæÉÂ§ßÁöÑÂ∫îÁî®Á®ãÂ∫è‰∏≠Ôºå‰∏ÄÊó¶ËÄÅÂπ¥‰ª£‰∏≤Ë°åÊî∂ÈõÜÂô®ÂêØÂä®ÔºåÂ∫îÁî®Á®ãÂ∫èÂæàÂèØËÉΩ‰ºöÂõ†Ê≠§ÂÅúÈ°øÂá†ÁßíÁîöËá≥Êõ¥ÈïøÊó∂Èó¥„ÄÇ‰ΩÜÊòØSerial Old Êî∂ÈõÜÂô®ÂèØ‰ª•ÂíåÂ§öÁßçÊñ∞Áîü‰ª£Êî∂ÈõÜÂô®ÈÖçÂêà‰ΩøÁî®ÔºåËÄå‰∏îÂèØ‰ª•‰Ωú‰∏∫ CMS Êî∂ÈõÜÂô®ÁöÑÂ§áÁî®Êî∂ÈõÜÂô®„ÄÇÂèØ‰ª•ÈÄöËøáÂèÇÊï∞ -XX:+UseSerialGC Â∞ÜÊñ∞Áîü‰ª£ÂíåËÄÅÂπ¥‰ª£ÈÉΩ‰ΩøÁî®‰∏≤Ë°åÊî∂ÈõÜÂô®Ôºå‰ΩøÁî® -XX:UseParallelOldGC ËÆæÁΩÆÊñ∞Áîü‰ª£ÂíåËÄÅÂπ¥‰ª£ÈÉΩ‰ΩøÁî®Âπ∂Ë°åÊî∂ÈõÜÂô®„ÄÇ Parallel Old Êî∂ÈõÜÂô®Parallel Scavenge Êî∂ÈõÜÂô®ÁöÑËÄÅÂπ¥‰ª£ÁâàÊú¨„ÄÇËØ•Êî∂ÈõÜÂô®ÈááÁî®‚ÄùÊ†áËÆ∞-Êï¥ÁêÜ‚ÄúÁÆóÊ≥ï„ÄÇÊ≥®ÈáçÂêûÂêêÈáè‰ª•Âèä CPU ËµÑÊ∫êÁöÑÂú∫ÂêàÔºåÈÉΩÂèØ‰ª•‰ºòÂÖàËÄÉËôë Parallel Scavenge Âíå Parallel Old Êî∂ÈõÜÂô®„ÄÇ CMS Êî∂ÈõÜÂô®CMS (Concurrent Mark Sweep) Êî∂ÈõÜÂô®ÊòØ‰∏ÄÁßç‰ª•Ëé∑ÂèñÊúÄÁü≠ÂõûÊî∂ÂÅúÈ°øÊó∂Èó¥‰∏∫ÁõÆÊ†áÁöÑÊî∂ÈõÜÂô®ÔºåÂÆÉÈùûÂ∏∏Á¨¶ÂêàÁΩëÁ´ôÊàñËÄÖ B/S Á≥ªÁªüÁöÑÊúçÂä°Á´Ø‰∏äÁöÑ Java Â∫îÁî®Á≠âÈáçËßÜÂìçÂ∫îÈÄüÂ∫¶ÁöÑÂú∫ÊôØ„ÄÇ‰ªéÂêçÂ≠ó‰∏äÂèØ‰ª•ÁúãÂá∫ÔºåÂÆÉÊòØÂü∫‰∫é ‚ÄúÊ†áËÆ∞-Ê∏ÖÈô§‚ÄùÁÆóÊ≥ïÂÆûÁé∞ÁöÑ„ÄÇ CMS Êî∂ÈõÜÂô®ÁöÑÊï¥‰∏™Â∑•‰ΩúÊµÅÁ®ã‰∏∫‰ª•‰∏ã 4 ‰∏™Ê≠•È™§Ôºö ÂàùÂßãÊ†áËÆ∞ÔºöÊöÇÂÅúÊâÄÊúâÂÖ∂‰ªñÁ∫øÁ®ãÔºåÊ†áËÆ∞ GC Roots ËÉΩÁõ¥Êé•ÂÖ≥ËÅîÁöÑÂØπË±°ÔºåÈÄüÂ∫¶ÂæàÂø´„ÄÇ Âπ∂ÂèëÊ†áËÆ∞ÔºöÂêåÊó∂ÂºÄÂêØ GC Á∫øÁ®ãÂíåÁî®Êà∑Á∫øÁ®ãÔºåÁî®Èó≠ÂåÖÁªìÊûÑÂéªËÆ∞ÂΩïÂèØËææÂØπË±°„ÄÇ‰ΩÜÊòØËøô‰∏™Èò∂ÊÆµÁªìÊùüÂêéÔºåÂπ∂‰∏çËÉΩ‰øùËØÅËøô‰∏™Èó≠ÂåÖÂåÖÂê´ÊâÄÊúâÁöÑÂèØËææÂØπË±°ÔºåÂõ†‰∏∫Áî®Êà∑Á∫øÁ®ãÂèØËÉΩÂêåÊó∂‰ºöÊõ¥Êñ∞ÂºïÁî®ÂüüÔºåÊâÄ‰ª• GC Á∫øÁ®ãÊó†Ê≥ï‰øùËØÅÂèØËææÊÄßÂàÜÊûêÁöÑÂÆûÊó∂ÊÄß„ÄÇÊâÄ‰ª•Ëøô‰∏™Èò∂ÊÆµÂ∞±ÊòØ GC Roots Tracing ËøáÁ®ãÔºåËÆ∞ÂΩïÂèëÁîüÂºïÁî®Êõ¥Êñ∞ÁöÑÂú∞Êñπ„ÄÇ ÈáçÊñ∞Ê†áËÆ∞Ôºö‰øÆÊ≠£Âπ∂ÂèëÊ†áËÆ∞ÊúüÈó¥ÂèëÁîüÂºïÁî®ÂèòÂåñÁöÑÈÇ£‰∏ÄÈÉ®ÂàÜÂØπË±°„ÄÇËøô‰∏ÄÈò∂ÊÆµÁöÑÂÅúÈ°øÊó∂Èó¥‰ºöÊØîÂàùÂßãÊ†áËÆ∞Èò∂ÊÆµÁöÑÊó∂Èó¥Á®çÈïøÔºå‰ΩÜËøúËøúÊØîÂπ∂ÂèëÊ†áËÆ∞ÁöÑÊó∂Èó¥Áü≠„ÄÇ Âπ∂ÂèëÊ∏ÖÈô§ÔºöÂºÄÂêØÁî®Êà∑Á∫øÁ®ãÔºåÂêåÊó∂ GC Á∫øÁ®ãÂØπÊú™Ê†áËÆ∞ÁöÑÂå∫ÂüüËøõË°åÊ∏ÖÈô§„ÄÇ ‰ºòÁÇπÔºöÂπ∂ÂèëÔºå‰ΩéÂÅúÈ°ø Áº∫ÁÇπÔºö 1„ÄÅÂΩìÊ¨°Êî∂ÈõÜÊó†Ê≥ïÂ§ÑÁêÜÂπ∂ÂèëÊ†áËÆ∞Êó∂Áî®Êà∑Á∫øÁ®ã‰∫ßÁîüÁöÑÊñ∞ÁöÑÂûÉÂúæ„ÄÇ 2„ÄÅÂõ†‰∏∫‰ΩøÁî® ‚ÄúÊ†áËÆ∞-Ê∏ÖÈô§‚Äù ÁÆóÊ≥ïÔºåÊâÄ‰ª•‰ºö‰∫ßÁîüÂæàÂ§öÂÜÖÂ≠òÁ©∫Èó¥Á¢éÁâáÔºåÂØºËá¥ÂΩìÂâçÂ†Ü‰∏≠ËÄÅÂπ¥‰ª£Á©∫Èó¥ÊúâÂâ©‰ΩôÔºå‰ΩÜÊòØÊó†Ê≥ïÊâæÂà∞Ë∂≥Â§üÂ§ßÁöÑËøûÁª≠Á©∫Èó¥Êù•ÂàÜÈÖçÂΩìÂâçÂØπË±°ÔºåËøôÊ†∑‰ºöÊèêÂâçËß¶Âèë‰∏ÄÊ¨° Full GC„ÄÇ CMS ÂûÉÂúæÊî∂ÈõÜÂô®ÁöÑ‰ºòÂåñ-XX:ParallelCMSThreadsÔºöÊâãÂä®ËÆæÁΩÆ CMS ÁöÑÁ∫øÁ®ãÊï∞Èáè„ÄÇCMS ÈªòËÆ§ÂêØÂä®ÁöÑÁ∫øÁ®ãÊòØ (ParallelGCThreads+3)/4) ÔºåÂÖ∂‰∏≠ ParallelGCThreads ÊòØÊñ∞Áîü‰ª£Âπ∂Ë°åÊî∂ÈõÜÂô®ÁöÑÁ∫øÁ®ãÊï∞Èáè„ÄÇ -XX:CMSInitiatingOccupancyFractionÔºöCMS Êî∂ÈõÜÂô®ËøõË°åÂûÉÂúæÂõûÊî∂ÁöÑÈòÄÂÄºÔºàÂΩìÂâçÂ†ÜÂÜÖÂ≠òÁöÑ‰ΩøÁî®ÁéáÈòÄÂÄºÔºâÔºåÈªòËÆ§‰∏∫ 68Ôºå‰πüÂ∞±ÊòØËØ¥ÂΩìÂ†ÜÂÜÖÂ≠òÁöÑ‰ΩøÁî®ÁéáËææÂà∞ 68% Êó∂Ôºå‰ºöÊâßË°å‰∏ÄÊ¨° CMS ÂõûÊî∂„ÄÇÂ¶ÇÊûúÂ∫îÁî®Á®ãÂ∫èÂÜÖÂÜÖÂ≠òÂ¢ûÈïøÂæàÂø´ÔºåÂú® CMS ÊâßË°åËøáÁ®ã‰∏≠ÔºåÂ∑≤ÁªèÂá∫Áé∞‰∫ÜÂÜÖÂ≠ò‰∏çË∂≥ÁöÑÊÉÖÂÜµÔºàÁî®Êà∑Á∫øÁ®ã‰ºöÂπ∂Ë°åÊâßË°åÔºâÔºåÂ∞±‰ºöÂØºËá¥ CMS ÂõûÊî∂Â§±Ë¥•ÔºåJVM Â∞ÜÂêØÂä®ËÄÅÂπ¥‰ª£‰∏≤Ë°åÊî∂ÈõÜÂô®ËøõË°åÂûÉÂúæÂõûÊî∂„ÄÇËøôÊ†∑‰ºöÈÄ†ÊàêÁ∫øÁ®ãÁöÑÂÅúÈ°øÔºåÂΩ±ÂìçÁî®Êà∑‰ΩìÈ™åÔºåËøôÊó∂ÂèØ‰ª•Â∞Ü -XX:CMSInitiatingOccupancyFraction Ë∞ÉÂ∞è„ÄÇÂ¶ÇÊûúÂ∫îÁî®Á®ãÂ∫èÁöÑÂÜÖÂ≠òÂ¢ûÈïøÁºìÊÖ¢ÁöÑËØùÔºåÂèØ‰ª•ÈÄÇÂΩìË∞ÉÂ§ßËøô‰∏™ÈòÄÂÄºÔºåÂèØ‰ª•ÊúâÊïàÁöÑÈôç‰Ωé CMS ÁöÑËß¶ÂèëÈ¢ëÁéá -XX:+UseCMSCompactAtFullCollectionÔºöÂõ†‰∏∫ CMS ÈááÁî® ‚ÄúÊ†áËÆ∞-Ê∏ÖÈô§‚Äù ÁÆóÊ≥ïÔºå‰ºöÈÄ†ÊàêÂ§ßÈáèÂÜÖÂ≠òÁ¢éÁâáÔºåËøôÊ†∑‰ºöÂØºËá¥Êó†Ê≥ïÂàÜÈÖçËæÉÂ§ßÁöÑÂØπË±°ÔºåËÄåËß¶Âèë Full GCÔºåËøôÂæàÂΩ±ÂìçÁ≥ªÁªüÊÄßËÉΩ„ÄÇËÆæÁΩÆÊ≠§ÂèÇÊï∞ÂèØ‰ª•‰Ωø CMS Âú®ÂûÉÂúæÊî∂ÈõÜÂÆåÊàêÂêéÔºåËøõË°å‰∏ÄÊ¨°ÂÜÖÂ≠òÁ¢éÁâáÊï¥ÁêÜÔºàÂÜÖÂ≠òÁ¢éÁâáÊï¥ÁêÜ‰∏çÊòØÂπ∂ÂèëËøõË°åÁöÑÔºâ„ÄÇÂèØ‰ª•‰ΩøÁî® -XX:CMSFullGCsBeforeCompaction ÂèÇÊï∞Êù•ËÆæÂÆöËøõË°åÂ§öÂ∞ëÊ¨° CMS ÂõûÊî∂ÂêéÔºåËøõË°å‰∏ÄÊ¨°ÂÜÖÂ≠òÂéãÁº©„ÄÇ G1 Êî∂ÈõÜÂô®G1 GC ÊòØ JDK 7 ÁöÑÊñ∞ÁâπÊÄß‰πã‰∏ÄÔºåÂÆÉÁöÑÁõÆÊ†áÊòØ‰Ωú‰∏∫‰∏ÄÊ¨æÊúçÂä°Âô®ÁöÑÂûÉÂúæÊî∂ÈõÜÂô®„ÄÇÊâÄ‰ª•ÂÆÉÂú®ÂêûÂêêÈáèÂíåÂÅúÈ°øÊéßÂà∂‰∏äÔºåÈÉΩË¶Å‰ºò‰∫é CMS„ÄÇ ‰ª•‰∏ãÂºïÁî®Ëá™ JVM ‰∏ÉÁßçÂûÉÂúæÊî∂ÈõÜÂô® G1 (Garbage First) ÁöÑÂêÑ‰ª£Â≠òÂÇ®Âú∞ÂùÄÊòØ‰∏çËøûÁª≠ÁöÑÔºåÊØè‰∏Ä‰ª£ÈÉΩ‰ΩøÁî®‰∫Ü n ‰∏™‰∏çËøûÁª≠ÁöÑÂ§ßÂ∞èÁõ∏ÂêåÁöÑ regionÔºå ÊØè‰∏™ region Âç†Êúâ‰∏ÄÂùóËøûÁª≠ÁöÑËôöÊãüÂÜÖÂ≠òÂú∞ÂùÄ„ÄÇ G1 Ë∑üË∏™ÂêÑ‰∏™ Region ÈáåÈù¢ÁöÑÂûÉÂúæÂ†ÜÁßØÁöÑ‰ª∑ÂÄºÂ§ßÂ∞èÔºàÂõûÊî∂ÊâÄËé∑ÂæóÁöÑÁ©∫Èó¥Â§ßÂ∞è‰ª•ÂèäÂõûÊî∂ÊâÄÈúÄÊó∂Èó¥ÁöÑÁªèÈ™åÂÄºÔºâÔºåÂú®ÂêéÂè∞Áª¥Êä§‰∏Ä‰∏™‰ºòÂÖàÂàóË°®ÔºåÊØèÊ¨°Ê†πÊçÆÂÖÅËÆ∏ÁöÑÊî∂ÈõÜÊó∂Èó¥Ôºå‰ºòÂÖàÂõûÊî∂‰ª∑ÂÄºÊúÄÂ§ßÁöÑ Region„ÄÇ ÈÅøÂÖçÂÖ®Â†ÜÊâ´ÊèèÂ§ö‰∏™ Region ‰πãÂâçÁöÑÂØπË±°ÂèØËÉΩ‰ºöÊúâÂºïÁî®ÂÖ≥Á≥ªÔºåÂú®ÂÅöÂèØËææÊÄßÂàÜÊûêÊó∂ÈúÄË¶ÅÊâ´ÊèèÊï¥‰∏™Â†ÜÊâçËÉΩ‰øùËØÅÂáÜÁ°ÆÊÄßÔºåËøôÊòæÁÑ∂Èôç‰Ωé‰∫Ü GC ÊïàÁéá„ÄÇ ‰∏∫ÈÅøÂÖçÂÖ®Â†ÜÊâ´ÊèèÔºåËôöÊãüÊú∫‰∏∫ G1 ‰∏≠ÊØè‰∏™ Region Áª¥Êä§‰∫Ü‰∏Ä‰∏™‰∏é‰πãÂØπÂ∫îÁöÑ Remembered Set„ÄÇËôöÊãüÊú∫ÂèëÁé∞Á®ãÂ∫èÂú®ÂØπReferenceÁ±ªÂûãÁöÑÊï∞ÊçÆËøõË°åÂÜôÊìç‰ΩúÊó∂Ôºå‰ºö‰∫ßÁîü‰∏Ä‰∏™Write Barrier ÊöÇÊó∂‰∏≠Êñ≠ÂÜôÊìç‰ΩúÔºåÊ£ÄÊü• Reference ÂºïÁî®ÁöÑÂØπË±°ÊòØÂê¶Â§Ñ‰∫é‰∏çÂêåÁöÑ Region ‰πã‰∏≠ÔºàÂú®ÂàÜ‰ª£ÁöÑ‰æãÂ≠ê‰∏≠Â∞±ÊòØÊ£ÄÊü•ÊòØÂê¶ËÄÅÂπ¥‰ª£‰∏≠ÁöÑÂØπË±°ÂºïÁî®‰∫ÜÊñ∞Áîü‰ª£‰∏≠ÁöÑÂØπË±°ÔºâÔºåÂ¶ÇÊûúÊòØÔºå‰æøÈÄöËøá CardTable ÊääÁõ∏ÂÖ≥ÂºïÁî®‰ø°ÊÅØËÆ∞ÂΩïÂà∞Ë¢´ÂºïÁî®ÂØπË±°ÊâÄÂ±ûÁöÑRegionÁöÑ Remembered Set ‰πã‰∏≠„ÄÇÂΩìËøõË°åÂÜÖÂ≠òÂõûÊî∂Êó∂ÔºåÂú®GCÊ†πËäÇÁÇπÁöÑÊûö‰∏æËåÉÂõ¥‰∏≠Âä†ÂÖ• Remembered Set Âç≥ÂèØ‰øùËØÅ‰∏çÂØπÂÖ®Â†ÜÊâ´Êèè‰πü‰∏ç‰ºöÊúâÈÅóÊºè„ÄÇ G1 ÁöÑËøê‰ΩúÊ≠•È™§ ÂàùÂßãÊ†áËÆ∞ÔºàInitial MarkingÔºâ Âπ∂ÂèëÊ†áËÆ∞ÔºàConcurrent MarkingÔºâ ÊúÄÁªàÊ†áËÆ∞ÔºàFinal MarkingÔºâ Á≠õÈÄâÂõûÊî∂ÔºàLive Data Counting and EvacuationÔºâ ÁâπÁÇπ Á©∫Èó¥Êï¥ÂêàÔºöÊï¥‰ΩìÊù•ÁúãÊòØÂü∫‰∫é‚ÄúÊ†áËÆ∞ - Êï¥ÁêÜ‚ÄùÁÆóÊ≥ïÂÆûÁé∞ÁöÑÊî∂ÈõÜÂô®Ôºå‰ªéÂ±ÄÈÉ®Ôºà‰∏§‰∏™ Region ‰πãÈó¥Ôºâ‰∏äÊù•ÁúãÊòØÂü∫‰∫é‚ÄúÂ§çÂà∂‚ÄùÁÆóÊ≥ïÂÆûÁé∞ÁöÑÔºåËøôÊÑèÂë≥ÁùÄËøêË°åÊúüÈó¥‰∏ç‰ºö‰∫ßÁîüÂÜÖÂ≠òÁ©∫Èó¥Á¢éÁâá„ÄÇ ÂèØÈ¢ÑÊµãÁöÑÂÅúÈ°øÔºöËÉΩËÆ©‰ΩøÁî®ËÄÖÊòéÁ°ÆÊåáÂÆöÂú®‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ M ÊØ´ÁßíÁöÑÊó∂Èó¥ÁâáÊÆµÂÜÖÔºåÊ∂àËÄóÂú® GC ‰∏äÁöÑÊó∂Èó¥‰∏çÂæóË∂ÖËøá N ÊØ´Áßí„ÄÇ ‰ª•‰∏äÂºïÁî®Ëá™ JVM ‰∏ÉÁßçÂûÉÂúæÊî∂ÈõÜÂô® GC Áõ∏ÂÖ≥ÂèÇÊï∞ËÆæÁΩÆÂèØ‰ª•ÈÄÇÂΩì‰ΩøÁî®Ëøô‰∫õÂèÇÊï∞ÂØπ GC ËøõË°åË∞É‰ºò„ÄÇ 1„ÄÅËæìÂá∫ GC Êó•Âøó 12-XX:+PrintGCDetails // ËæìÂá∫ GC Êó•Âøó-XX:+DisableExplicitGC // Á¶ÅÁî®ÊòæÁ§∫ GC 2„ÄÅ‰∏≤Ë°å GC Áõ∏ÂÖ≥ËÆæÁΩÆ 1234-XX:+UseSerialGC // ÊåáÂÆöÊñ∞Áîü‰ª£ÂíåËÄÅÂπ¥‰ª£ÈÉΩ‰ΩøÁî®‰∏≤Ë°åÊî∂ÈõÜÂô®ÔºàClientÊ®°ÂºèÈªòËÆ§ÂÄºÔºâ-XX:+SurvivorRatio // ËÆæÁΩÆ eden Âå∫Â§ßÂ∞èÂíå survivor Âå∫Â§ßÂ∞èÁöÑÊØî‰æãÔºåÈªòËÆ§‰∏∫8-XX:+PretenureSizeThreshold // ËÆæÁΩÆÂ§ßÂØπË±°Áõ¥Êé•ËøõÂÖ•ËÄÅÂπ¥‰ª£ÁöÑÈòàÂÄº„ÄÇÂΩìÂØπË±°ÁöÑÂ§ßÂ∞èË∂ÖËøáËøô‰∏™ÂÄºÊó∂ÔºåÂ∞ÜÁõ¥Êé•Âú®ËÄÅÂπ¥‰ª£ÂàÜÈÖç„ÄÇ-XX:MaxTenuringThreshold // ËÆæÁΩÆÂØπË±°ËøõÂÖ•ËÄÅÂπ¥‰ª£ÁöÑÂπ¥ÈæÑÁöÑÊúÄÂ§ßÂÄº„ÄÇÊØè‰∏ÄÊ¨° Minor GC ÂêéÔºåÂØπË±°Âπ¥ÈæÑÂ∞±Âä† 1„ÄÇ‰ªª‰ΩïÂ§ß‰∫éËøô‰∏™Âπ¥ÈæÑÁöÑÂØπË±°Ôºå‰∏ÄÂÆö‰ºöËøõÂÖ•ËÄÅÂπ¥‰ª£„ÄÇ 3„ÄÅÂπ∂Ë°å GC ÂèÇÊï∞ËÆæÁΩÆ 1234567-XX:+UseParNewGC // ‰ΩøÁî® ParNew + Serial Old ÁªÑÂêàËøõË°åÂûÉÂúæÂõûÊî∂Ôºà‰∏çÊé®ËçêÔºâ-XX:+UseParallelGC // ‰ΩøÁî® Parallel Scavenge Âíå Serial Old ÁªÑÂêàËøõË°åÂõûÊî∂-XX:+UseParallelOldGC // Parallel Scavenge + Parallel Old Êî∂ÈõÜÁªÑÂêàËøõË°åÂûÉÂúæÂõûÊî∂-XX:ParallelGCThreads //Âπ∂Ë°åÊî∂ÈõÜÂô®Â∑•‰ΩúÊó∂ÁöÑÁ∫øÁ®ãÊï∞ÈáèÔºåÂú® CPU Êï∞ÈáèÂ∞è‰∫é8‰∏™Êó∂ÔºåParallelGCThreads Á≠â‰∫é CPU Êï∞ÈáèÔºõÂ¶ÇÊûúÂ§ß‰∫é8‰∏™ÔºåParalellGCThreads ÁöÑÂÄºÁ≠â‰∫é 3+[5*CPU_Count]/8]Ôºõ-XX:+MaxGCPauseMills // ËÆæÁΩÆÊúÄÂ§ßÂûÉÂúæÊî∂ÈõÜÂÅúÈ°øÊó∂Èó¥-XX:+GCTimeRatio // ËÆæÁΩÆÂêûÂêêÈáèÂ§ßÂ∞èÔºà0 - 100‰πãÈó¥ÁöÑÊï¥Êï∞ÔºâÂûÉÂúæÊî∂ÈõÜÊó∂Èó¥‰∏ç‰ºöË∂ÖËøá 1/(1+n) -XX:+UseAdaptiveSizePolicy // ÊâìÂºÄËá™ÈÄÇÂ∫î GC Á≠ñÁï• 4„ÄÅCMS Êî∂ÈõÜÂô®Áõ∏ÂÖ≥ÂèÇÊï∞ËÆæÁΩÆ 12345678910-XX:+UseConcMarkSweepGC // Êñ∞Áîü‰ª£‰ΩøÁî®Âπ∂Ë°åÊî∂ÈõÜÂô®ÔºåËÄÅÂπ¥‰ª£‰ΩøÁî® CMS + ‰∏≤Ë°åÊî∂ÈõÜÂô®-XX:ParallelCMSThreads // ÊâãÂä®ËÆæÂÆö CMS ÁöÑÁ∫øÁ®ãÊï∞Èáè-XX:CMSInitiatingOccupancyFraction // CMS ÂõûÊî∂Ëß¶ÂèëÈòÄÂÄºÔºàÂΩìÂâçÂ†ÜÂÜÖÂ≠òÁöÑ‰ΩøÁî®ÁéáÔºâÈªòËÆ§‰∏∫68Ôºà68%Ôºâ-XX:+UseCMSCompactAtFullCollection // CMS ÂûÉÂúæÂõûÊî∂ÂÆåÊàêÂêéÔºåËøõË°å‰∏ÄÊ¨°ÂÜÖÂ≠òÁ¢éÁâáÊï¥ÁêÜ-XX:CMSFullGCsBeforeCompaction // Â§öÂ∞ëÊ¨° CMS ÂûÉÂúæÂõûÊî∂ÂêéÔºåËøõË°å‰∏ÄÊ¨°ÂÜÖÂ≠òÊï¥ÁêÜÔºàÂéãÁº©Ôºâ-XX:+CMSClassUnloadingEnabled // ÂÖÅËÆ∏ÂØπÁ±ªÂÖÉÊï∞ÊçÆËøõË°åÂõûÊî∂-XX:+CMSParallelRemarkEndable // ÂêØÁî®Âπ∂Ë°åÈáçÊ†áËÆ∞-XX:CMSInitatingPermOccupancyFraction // ÂΩìÊ∞∏‰πÖÂå∫Âç†Áî®ÁéáËææÂà∞Ëøô‰∏ÄÁôæÂàÜÊØîÂêéÔºåÂêØÂä® CMS ÂõûÊî∂ÔºàÈúÄË¶ÅÂºÄÂêØ - XX:+CMSClassUnloadingEnabledÔºâ-XX:UseCMSInitatingOccupancyOnly // Âè™ÊúâÂà∞ËææÈòÄÂÄºÁöÑÊó∂ÂÄôÔºåÊâçËøõË°å CMS ÂõûÊî∂-XX:+CMSIncrementalMode // ‰ΩøÁî®Â¢ûÈáèÊ®°ÂºèÔºåÈÄÇÁî®‰∫éÂçï CPU 5„ÄÅG1 Êî∂ÈõÜÂô®Áõ∏ÂÖ≥ÂèÇÊï∞ËÆæÁΩÆÂèÇÊï∞ 1234-XX:+UseG1GC // ‰ΩøÁî® G1 Êî∂ÈõÜÂô®-XX:+UnlockExperimentalVMOptions // ÂÖÅËÆ∏‰ΩøÁî®ÂÆûÈ™åÊÄßÂèÇÊï∞-XX:+MaxGCPauseMills // ËÆæÁΩÆÂûÉÂúæÊî∂ÈõÜÊúÄÂ§ßÂÅúÈ°øÊó∂Èó¥-XX:+GCPauseIntervalMills // ËÆæÁΩÆÂÅúÈ°øÈó¥ÈöîÊó∂Èó¥ Âü∫‰∫éÂØπ JVM ÂûÉÂúæÂõûÊî∂Âô®ÁöÑÂ∑•‰ΩúÂéüÁêÜ‰ª•ÂèäÁ®ãÂ∫èËÆæËÆ°ÁöÑ‰∫ÜËß£ÔºåÂ∏åÊúõÂ§ßÂÆ∂ÈÉΩËÉΩÊâæÂá∫ÈÄÇÂêàËá™Â∑±ÁöÑÊúÄ‰ºò‰ºòÂåñÊñπÊ°à„ÄÇ ÂØπ‰∫éÂá†‰∏™ÈóÆÈ¢òÁöÑËß£Á≠îÂØπË±°Ê≠ª‰∫°ÁöÑÂà§Êñ≠Â†Ü‰∏≠Âá†‰πéÂ≠òÊîæÁùÄÊâÄÊúâÁöÑÂÆû‰æãÂØπË±°ÔºåÊâÄ‰ª•Ë¶Å‰∫ÜËß£ÂûÉÂúæÂõûÊî∂Âô®ÔºåÈ¶ñÂÖàË¶ÅÂ≠¶‰ºöÂà§Êñ≠Âì™‰∫õÂØπË±°Â∑≤ÁªèÊ≠ª‰∫°Ôºà‰∏çËÉΩÂÜç‰ΩøÁî®Ôºâ„ÄÇ JVM Êúâ‰∏§ÁßçÊñπÊ≥ïÂà§Êñ≠ÂØπË±°ÊòØÂê¶Ê≠ª‰∫°Ôºö ÂºïÁî®ËÆ°Êï∞Ê≥ï ÁªôÂØπË±°Ê∑ªÂä†‰∏Ä‰∏™ÂºïÁî®ËÆ°Êï∞Âô®ÔºåÂ¶ÇÊûúÊúâ‰∏Ä‰∏™Âú∞ÊñπÂºïÁî®ÂÆÉÔºåËÆ°Êï∞Âô®Â∞±Âä†1ÔºåÂºïÁî®Â§±ÊïàÊó∂ÔºåËÆ°Êï∞Âô®Âáè1„ÄÇËÆ°Êï∞Âô®ÂÄº‰∏∫0ÁöÑÂØπË±°Â∞±ÊòØ‰∏çËÉΩÂÜç‰ΩøÁî®ÁöÑ„ÄÇ ËøôÁßçÊñπÊ≥ïÂÆûÁé∞ÁÆÄÂçïÔºåÊïàÁéáÈ´òÔºå‰ΩÜÊòØÁõÆÂâç‰∏ªÊµÅÁöÑËôöÊãüÊú∫Ê≤°ÊúâÂÜç‰ΩøÁî®ËøôÁßçÊñπÊ≥ï‰∫ÜÔºåÂõ†‰∏∫ÂÆÉÊó†Ê≥ïËß£ÂÜ≥ÂØπË±°‰πãÈó¥Áõ∏‰∫íÂºïÁî®ÁöÑÁöÑÈóÆÈ¢ò„ÄÇ ÂèØËææÊÄßÂàÜÊûêÊ≥ï Ê≠§ÁÆóÊ≥ïÁöÑÂü∫Êú¨ÊÄùÊÉ≥Â∞±ÊòØÈÄöËøá‰∏ÄÁ≥ªÂàóÁöÑÁß∞‰∏∫ ‚ÄúGC Roots‚Äù ÁöÑÂØπË±°‰Ωú‰∏∫Ëµ∑ÁÇπÔºå‰ªéËøô‰∫õËäÇÁÇπÂºÄÂßãÂêë‰∏ãÊêúÁ¥¢ÔºåÂÄüÁÇπÂ®ëËµ∞ËøáÁöÑË∑ØÂæÑÂè´ÂÅöÂºïÁî®ÈìæÔºåÂΩì‰∏Ä‰∏™ÂØπË±°Âà∞ GC Roots Ê≤°Êúâ‰ªª‰ΩïÂºïÁî®ÈìæÁõ∏ËøûÁöÑËØùÔºåÂ∞±ËØ¥ÊòéÊ≠§ÂØπË±°ÊòØ‰∏çÂèØÁî®ÁöÑ„ÄÇ Minor GC Âíå Full GC ÁöÑÂå∫Âà´ Êñ∞Áîü‰ª£ GCÔºàMinor GCÔºâÔºöÂèëÁîüÂú®Êñ∞Áîü‰ª£ÁöÑÂûÉÂúæÊî∂ÈõÜÊìç‰ΩúÔºåMinor GC ÈùûÂ∏∏È¢ëÁπÅÔºå‰∏î‰∏ÄËà¨ÈÄüÂ∫¶‰πüÊØîËæÉÂø´„ÄÇ Major GC / Full GCÔºöÂèëÁîüÂú®ËÄÅÂπ¥‰ª£ÁöÑ GCÔºåÈÄüÂ∫¶‰∏ÄËà¨ÊØî Minor GC ÊÖ¢10ÂÄç‰ª•‰∏ä„ÄÇ ÂÖ∂‰ªñÈóÆÈ¢ò Java ÂõõÁßçÂºïÁî®Á±ªÂûã ÔΩû Âº∫ÂºïÁî®ÔºåËΩØÂºïÁî®ÔºåÂº±ÂºïÁî®ÔºåËôöÂºïÁî®ÔºàËôöÂºïÁî®‰∏éËΩØÂºïÁî®ÂíåÂº±ÂºïÁî®ÁöÑÂå∫Âà´Ôºå‰ΩøÁî®ËΩØÂºïÁî®ÁöÑÂ•ΩÂ§ÑÔºâ Â¶Ç‰ΩïÂà§Êñ≠‰∏Ä‰∏™Â∏∏ÈáèÊòØÂ∫üÂºÉÂ∏∏Èáè Â¶Ç‰ΩïÂà§Êñ≠‰∏Ä‰∏™Á±ªÊòØÊó†Áî®ÁöÑÁ±ª ÊÄªÁªìÊù•Ê∫ê‰∫é JVM ‰∏ÉÁßçÂûÉÂúæÊî∂ÈõÜÂô® Êî∂ÈõÜÂô® ‰∏≤Ë°å„ÄÅÂπ∂Ë°åorÂπ∂Âèë Êñ∞Áîü‰ª£/ËÄÅÂπ¥‰ª£ ÁÆóÊ≥ï ÁõÆÊ†á ÈÄÇÁî®Âú∫ÊôØ Serial ‰∏≤Ë°å Êñ∞Áîü‰ª£ Â§çÂà∂ÁÆóÊ≥ï ÂìçÂ∫îÈÄüÂ∫¶‰ºòÂÖà ÂçïCPUÁéØÂ¢É‰∏ãÁöÑClientÊ®°Âºè Serial Old ‰∏≤Ë°å ËÄÅÂπ¥‰ª£ Ê†áËÆ∞-Êï¥ÁêÜ ÂìçÂ∫îÈÄüÂ∫¶‰ºòÂÖà ÂçïCPUÁéØÂ¢É‰∏ãÁöÑClientÊ®°Âºè„ÄÅCMSÁöÑÂêéÂ§áÈ¢ÑÊ°à ParNew Âπ∂Ë°å Êñ∞Áîü‰ª£ Â§çÂà∂ÁÆóÊ≥ï ÂìçÂ∫îÈÄüÂ∫¶‰ºòÂÖà Â§öCPUÁéØÂ¢ÉÊó∂Âú®ServerÊ®°Âºè‰∏ã‰∏éCMSÈÖçÂêà Parallel Scavenge Âπ∂Ë°å Êñ∞Áîü‰ª£ Â§çÂà∂ÁÆóÊ≥ï ÂêûÂêêÈáè‰ºòÂÖà Âú®ÂêéÂè∞ËøêÁÆóËÄå‰∏çÈúÄË¶ÅÂ§™Â§ö‰∫§‰∫íÁöÑ‰ªªÂä° Parallel Old Âπ∂Ë°å ËÄÅÂπ¥‰ª£ Ê†áËÆ∞-Êï¥ÁêÜ ÂêûÂêêÈáè‰ºòÂÖà Âú®ÂêéÂè∞ËøêÁÆóËÄå‰∏çÈúÄË¶ÅÂ§™Â§ö‰∫§‰∫íÁöÑ‰ªªÂä° CMS Âπ∂Âèë ËÄÅÂπ¥‰ª£ Ê†áËÆ∞-Ê∏ÖÈô§ ÂìçÂ∫îÈÄüÂ∫¶‰ºòÂÖà ÈõÜ‰∏≠Âú®‰∫íËÅîÁΩëÁ´ôÊàñB/SÁ≥ªÁªüÊúçÂä°Á´Ø‰∏äÁöÑJavaÂ∫îÁî® G1 Âπ∂Âèë both Ê†áËÆ∞-Êï¥ÁêÜ+Â§çÂà∂ÁÆóÊ≥ï ÂìçÂ∫îÈÄüÂ∫¶‰ºòÂÖà Èù¢ÂêëÊúçÂä°Á´ØÂ∫îÁî® [ÂèÇËÄÉÈìæÊé•] Java Garbage Collection Basics JVM Garbage Collectors Java Garbage Collection Algorithms SnailClimb JavaGuide - JavaÂûÉÂúæÂõûÊî∂ JVM ÂûÉÂúæÂõûÊî∂Âô®Â∑•‰ΩúÂéüÁêÜÂèä‰ΩøÁî®ÂÆû‰æã‰ªãÁªç JVM ‰∏ÉÁßçÂûÉÂúæÊî∂ÈõÜÂô®]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>JVM</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hexo Êê≠Âª∫‰∏™‰∫∫ÂçöÂÆ¢ - ‰ΩøÁî® GitHub Page]]></title>
    <url>%2Fbuild-hexo-blog%2F</url>
    <content type="text"><![CDATA[Áé∞Âú®ÂõΩÂÜÖÂ∑≤ÁªèÊúâÂæàÂ§öÂÆ∂ÂÅöÂçöÂÆ¢ÁöÑÂπ≥Âè∞‰∫ÜÔºåÊØîÂ¶ÇËØ¥ CSDNÔºåÊéòÈáë‰ΩÜÊòØÊúâ‰∫õÂçöÂÆ¢Âπ≥Âè∞ÈÉΩÊúâÈôêÂà∂ÊàñËÄÖ UI Âπ∂‰∏çÂ•ΩÁúãÔºåÊâÄ‰ª•ÂæàÂ§öÊäÄÊúØÂºÄÂèëËÄÖËá™Â∑±Êê≠Âª∫ÂçöÂÆ¢ÂèëÂ∏ÉÊñáÁ´†Ôºå‰∏ç‰æùËµñ‰∫é‰ªª‰ΩïÂπ≥Âè∞„ÄÇGitHub ÂàôÊèê‰æõ‰∫ÜÂπ≥Âè∞ËÉΩËÆ©ÁΩëÁ´ôÊåÇÂú®‰ªñÁöÑ GitHub Page ‰∏ãÔºåËøôÂ∞±ÁúÅÂéª‰∫Ü‰∏ÄÂ§ßÁ¨îÊúçÂä°Âô®ÁöÑÂºÄÈîÄÔºåÂæàÂ§ö‰∫∫ÈÉΩÂú®‰ΩøÁî®„ÄÇÊâÄ‰ª•ÊàëÂÜôËøôÁØáÊñáÁ´†ËÆ∞ÂΩïÊê≠Âª∫ÂçöÂÆ¢ÁöÑÊµÅÁ®ã„ÄÇ ÁéØÂ¢ÉÂÆâË£ÖNode ÂÆâË£ÖÁôæÂ∫¶ÊàñËÄÖ google ‚Äúnode‚Äù ÔºåËøõÂÖ•ÂÆòÁΩëÔºåÈÄâÊã©Ëá™Â∑±Á≥ªÁªüÂêàÈÄÇÁöÑÂÆâË£ÖÂåÖÔºå‰∏ãËΩΩÔºåÁâàÊú¨Êó†Ë¶ÅÊ±Ç„ÄÇ ËøòÊòØÁïô‰∏™‰∏ãËΩΩÂú∞ÂùÄÔºöNode ‰∏ãËΩΩ ÂÆâË£ÖÂ•Ω‰πãÂêéËøõÂÖ• cmd ÊàñËÄÖÁªàÁ´ØËæìÂÖ• npm -vÔºå‰ºöÊâìÂç∞Âá∫‰Ω†ÂÆâË£ÖÁöÑÂΩìÂâçÁâàÊú¨„ÄÇ ÂÆâË£Ö HexoËøõÂÖ• Windows ÁöÑ cmd ÊàñËÄÖ macOS/Linux ÁöÑÁªàÁ´ØÔºåÊâßË°å‰ª•‰∏ãÂëΩ‰ª§ÂÆâË£Ö Hexo npm install -g hexo-cli ÂÆâË£ÖÂ•Ω‰πãÂêéÔºåÊâßË°å hexo -v ‰ºöÊâìÂç∞Âá∫ÂêÑ‰∏™ÁªÑ‰ª∂ÁöÑÁâàÊú¨Âè∑„ÄÇ ÂÆâË£ÖÂÆåÊàêÂêéÔºåÊâæ‰∏Ä‰∏™Á©∫Êñá‰ª∂Â§πÔºà‰∏ìÈó®Â≠òÊîæ hexo ÁîüÊàêÁöÑÊñá‰ª∂ÔºâÔºåËøõÂÖ•ËØ•Êñá‰ª∂Â§πÔºåÊâßË°å‰ª•‰∏ãÂëΩ‰ª§Ôºö 12hexo init -- Âú®ÂΩìÂâçË∑ØÂæÑ‰∏ãÂàùÂßãÂåñÔºåÂ¶ÇÊûúÊÉ≥ÊåáÂÆöË∑ØÂæÑËØ∑‰ΩøÁî® `hexo init ÊåáÂÆöË∑ØÂæÑ`npm install -- ÂÆâË£Ö‰æùËµñÁªÑ‰ª∂ ÂÆåÊàêÂêéÂú®ÂΩìÂâçÊñá‰ª∂Â§π‰∏ã‰ºöÊúâ‰ª•‰∏ãÊñá‰ª∂Ôºö ÂÖ∂‰∏≠ _config.yml ‰∏∫‰∏ªË¶ÅÈÖçÁΩÆÊñá‰ª∂ÔºåËá≥Ê≠§ÔºåHexo ÂÆâË£ÖÂÆåÊØïÔºåÊâßË°å hexo s ÂëΩ‰ª§ÂêØÂä®‰∏Ä‰∏™Êú¨Âú∞ÊúçÂä°Âô®ÔºåÁÑ∂ÂêéÂú®ÊµèËßàÂô®‰∏≠ËÆøÈóÆ localhost:4000 Â∞±ÂèØ‰ª•È¢ÑËßàÂà∞ÈªòËÆ§ÁöÑÈ°µÈù¢ÊïàÊûú‰∫Ü„ÄÇ ÂàõÂª∫ GitHub PageÂàõÂª∫ GitHub ‰ªìÂ∫ìÈ¶ñÂÖàÂàõÂª∫‰∏Ä‰∏™ GitHub Ë¥¶Âè∑ÔºåÁÑ∂ÂêéËøõÂÖ•‰Ω†ÁöÑË¥¶Êà∑‰∏ªÈ°µÔºåÁÇπÂáª Repositories Êñ∞Âª∫ RepositoryÔºö ÂàõÂª∫ÁöÑ Repository ÁöÑÂêçÁß∞Ê†ºÂºèÂøÖÈ°ª‰∏∫ GitHubË¥¶Êà∑ÂêçÁß∞.github.io Ôºå‰∏ÄÂÆöË¶ÅËøôÁßçÊ†ºÂºèÔºå‰∏çÁÑ∂„ÄÇ„ÄÇ‰Ω†ÂèØ‰ª•ËØïËØïÂ•Ω‰∏çÂ•Ω‰Ωø„ÄÇ ÊàëËøôÈáåË≠¶ÂëäÊòØÂõ†‰∏∫ÊàëÂ∑≤ÁªèÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÂêçÂ≠óÊòØ keanu96.github.io ÁöÑ‰ªìÂ∫ì‰∫Ü„ÄÇ Âà∞ËøôÈáåÔºåËøô‰∏™ GitHub ‰ªìÂ∫ìÂ∞±Â∑≤ÁªèÂàõÂª∫Â•Ω‰∫Ü„ÄÇ ÈÖçÁΩÆ Hexo Êèê‰∫§Âà∞ GitHubÊâìÂºÄÂÆâË£ÖÂçöÂÆ¢ÁöÑÊ†πÁõÆÂΩïÔºåÊâæÂà∞ÂÖ∂‰∏≠ÁöÑ _config.yml Êñá‰ª∂ÊâìÂºÄ„ÄÇ ÊâæÂà∞‰∏Ä‰∏ãÈÖçÁΩÆÂπ∂‰øÆÊîπÊàêËá™Â∑±ÂØπÂ∫îÁöÑÈÖçÁΩÆÔºö 123456# Deployment## Docs: https://hexo.io/docs/deployment.htmldeploy:- type: git repo: http://github.com/keanu96/keanu96.github.io.git branch: master Â∞Ü repo ‰∏≠ÁöÑÈìæÊé•Êîπ‰∏∫ÂàöÂàöÂàõÂª∫Â•ΩÁöÑ GitHub ‰ªìÂ∫ìÁöÑÈìæÊé•„ÄÇ ËÆæÁΩÆ‰∏∫Ëøô‰∏™Âç≥ÂèØ„ÄÇ ÁÑ∂ÂêéÂÆâË£Ö Hexo ÁöÑÈÉ®ÁΩ≤Êèí‰ª∂ hexo-deployer-git 1npm install hexo-deployer-git --save ÁÑ∂ÂêéÊâìÂºÄ cmd ÊàñËÄÖÁªàÁ´ØÔºåËøõÂÖ•Âà∞ÂçöÂÆ¢ÁöÑÊ†πÁõÆÂΩï‰∏ãÔºåÊâßË°å hexo clean &amp;&amp; hexo g &amp;&amp; hexo d ÔºåÂ∞±‰ºöÂèëÁé∞‰∏ÄÂ§ßÂ†ÜÊó•ÂøóÊâìÂç∞Âá∫Êù•ÔºåÂ¶ÇÊûúÊ≤°ÊúâÊä•ÈîôÔºåÂ∞±ËØ¥ÊòéÂ∫îÊèê‰∫§Âà∞ GitHub ‰∏ä‰∫Ü„ÄÇÂú®ÊµèËßàÂô®‰∏≠ÊâìÂºÄ https://GitHubÁî®Êà∑Âêç.github.io Â∞±ËÉΩÁúãÂà∞‰Ω†ÁöÑÂçöÂÆ¢ÁöÑÂàùÂßãÈ°µÈù¢‰∫Ü„ÄÇ Êõ¥Â§ö‰ª•‰∏äÂè™ÊòØÂ∞ÜÂçöÂÆ¢ÊåÇÂú® GitHub Page ‰∏≠ÔºåÂπ∂Ê≤°ÊúâÂÅöËøáÂ§öÈÖçÁΩÆÔºåÂ¶ÇÊûúÊÉ≥Êõ¥Êç¢‰∏ªÈ¢òÁöÑËØùÔºåÊé®ËçêÊàë‰ΩøÁî®ÁöÑ‰∏ªÈ¢òÔºåÁÆÄÂçïÊòìÁî®Ôºöhexo-theme-next Á®çÂêéÂ∞ÜÊàëÁöÑÂçöÂÆ¢Âèä‰∏ªÈ¢òÈÖçÁΩÆ‰∏ä‰º†‰∏äÊù•Êèê‰æõ‰∏ãËΩΩÂèÇÁÖß„ÄÇ ÂçöÂÆ¢Ê†πÁõÆÂΩïÈÖçÁΩÆÊñá‰ª∂ ‰∏ªÈ¢òÈÖçÁΩÆÊñá‰ª∂]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo ÂçöÂÆ¢Êê≠Âª∫</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RedisÂ≠¶‰π† - ÊåÅ‰πÖÂåñÊú∫Âà∂]]></title>
    <url>%2Fredis-persistence%2F</url>
    <content type="text"><![CDATA[Redis ÊòØ‰∏Ä‰∏™Âü∫‰∫éÂÜÖÂ≠òÁöÑÊï∞ÊçÆÂ∫ìÔºåÊï∞ÊçÆÈÉΩÊòØÂ≠òÂÇ®Âú®ÂÜÖÂ≠òÂΩì‰∏≠ÔºåËøôÊ†∑ÂΩìÊúçÂä°Âô®ÂÆïÊú∫ÊàñËÄÖÁ®ãÂ∫èÂºÇÂ∏∏ÈÄÄÂá∫Êó∂Ôºå‰ºöÊúâÂ§ßÈáèÊï∞ÊçÆ‰∏¢Â§±ÔºåÊâÄ‰ª•‰∏∫‰∫ÜÈÅøÂÖçÊï∞ÊçÆ‰∏¢Â§±ÔºåÈúÄË¶ÅÂ∞ÜÊï∞ÊçÆÊåÅ‰πÖÂåñÂà∞Âà∞Á°¨Áõò‰∏≠ÔºåRedis ÁöÑÊåÅ‰πÖÂåñÂ∞±ÊòØÂ∞ÜÂÜÖÂ≠ò‰∏≠ÁöÑÊï∞ÊçÆÂÜôÂÖ•Âà∞Á£ÅÁõò‰∏≠ËøõË°åÂ≠òÂÇ®ÔºåËøôÊ†∑ Redis Âú®‰∏ãÊ¨°ÈáçÂêØÊó∂ÂèØ‰ª•Âà©Áî®ÊåÅ‰πÖÂåñÊñá‰ª∂Êù•ËøõË°åÊï∞ÊçÆÊÅ¢Â§ç„ÄÇ Redis Êèê‰æõ‰∫Ü‰∏§ÁßçÊï∞ÊçÆÊåÅ‰πÖÂåñÊñπÊ°àÔºö Êï∞ÊçÆÂø´ÁÖßÔºöRedis RDB ÂëΩ‰ª§Êó•ÂøóÔºöRedis AOF Redis ‰∏≠ÂÖÅËÆ∏‰∏§ÁßçÊñπÊ°àÁªìÂêà‰ΩøÁî®Ôºå‰πüÂÖÅËÆ∏‰∏§ËÄÖÂêåÊó∂ÂÖ≥Èó≠„ÄÇ RDB ÊåÅ‰πÖÂåñRDBÊåÅ‰πÖÂåñÊòØ Redis ÈªòËÆ§ÁöÑÊåÅ‰πÖÂåñÊñπÂºèÔºåÂÆÉÊòØÂ∞ÜÂΩìÂâçÂÜÖÂ≠ò‰∏≠Êüê‰∏™Êó∂Èó¥ÁÇπÁöÑÊï∞ÊçÆÁîüÊàêÂø´ÁÖßÂ≠òÂÇ®Âú®Á°¨Áõò‰∏äÔºåÂ≠òÂÇ®ÁöÑÊñá‰ª∂ÂêéÁºÄ‰∏∫ rdbÔºåRedis ÈáçÂêØÊó∂ÔºåÂèØ‰ª•ËØªÂèñÂø´ÁÖßÊñá‰ª∂Êù•ÊÅ¢Â§çÊï∞ÊçÆ„ÄÇrdb ÊòØ‰∏Ä‰∏™ÁªèËøáÂéãÁº©ÁöÑ‰∫åËøõÂà∂Êñá‰ª∂ÔºåÈááÁî® RDB ÊåÅ‰πÖÂåñÊó∂ÊúçÂä°Âô®Âè™‰ºö‰øùÂ≠ò‰∏Ä‰∏™ rdb Êñá‰ª∂ÔºåËøôÊ†∑‰ΩøÁª¥Êä§Êõ¥Âä†ÁÆÄÂçï„ÄÇ ÊØèÊ¨°ËøõË°å RDB ÊåÅ‰πÖÂåñÊó∂ÔºåRedis ÈÉΩÊòØÂú®Êüê‰∏™Êó∂Èó¥ÁÇπÂ∞ÜÊï∞ÊçÆÂÜôÂÖ•‰∏Ä‰∏™‰∏¥Êó∂Êñá‰ª∂ÔºàÂÖ®ÈáèÔºâÔºåÂΩìÊåÅ‰πÖÂåñÁªìÊùüÂêéÔºåÁî®Ëøô‰∏™‰∏¥Êó∂Êñá‰ª∂ÊõøÊç¢‰∏äÊ¨°ÊåÅ‰πÖÂåñÁöÑÊñá‰ª∂„ÄÇ RDB ÊåÅ‰πÖÂåñÊµÅÁ®ãRDB ÊåÅ‰πÖÂåñÁöÑËß¶ÂèëÂàÜ‰∏∫ÊâãÂä®Ëß¶ÂèëÂíåËá™Âä®Ëß¶Âèë‰∏§ÁßçÂΩ¢Âºè„ÄÇ ÊâãÂä®Ëß¶ÂèëÂú® Redis ‰∏≠Ôºåsave Âíå bgsave ÂëΩ‰ª§ÈÉΩÂèØ‰ª•ÁîüÊàê rdb Êñá‰ª∂„ÄÇ save : ‰ºöÈòªÂ°û Redis ÊúçÂä°Âô®ËøõÁ®ãÔºåÁõ¥Âà∞ rdb Êñá‰ª∂ÂàõÂª∫ÂÆåÊØï‰∏∫Ê≠¢ÔºåÂú® Redis ÊúçÂä°Âô®ÈòªÂ°ûÊúüÈó¥ÔºåÊúçÂä°Âô®‰∏çËÉΩÂ§ÑÁêÜ‰ªª‰ΩïÂëΩ‰ª§ËØ∑Ê±Ç bgsave : ‰ºö fork ‰∏Ä‰∏™Â≠êËøõÁ®ãÊù•ÂàõÂª∫ rdb Êñá‰ª∂ÔºåÁà∂ËøõÁ®ãÂèØ‰ª•ÁªßÁª≠Â§ÑÁêÜÂëΩ‰ª§ËØ∑Ê±ÇÔºàfork Â≠êËøõÁ®ãÊúüÈó¥ÔºåÊúçÂä°Âô®‰πüÂ§Ñ‰∫éÈòªÂ°ûÁä∂ÊÄÅÔºâ bgsave ÂëΩ‰ª§ÊâßË°åÊµÅÁ®ãÂ¶Ç‰∏ãÔºö Redis bgsave ÊâßË°åÊµÅÁ®ã ÊâßË°å bgsave ÂëΩ‰ª§ÔºåÁà∂ËøõÁ®ã‰ºöÂà§Êñ≠ÂΩìÂâçÊòØÂê¶Â≠òÂú®Ê≠£Âú®ÊâßË°åÁöÑÂ≠êËøõÁ®ãÔºåÂ¶Ç RDB/AOF Â≠êËøõÁ®ãÔºåÂ¶ÇÊûúÂ≠òÂú®ÔºåÂàô bgave ÂëΩ‰ª§Áõ¥Êé•ËøîÂõû Áà∂ËøõÁ®ãÊâßË°å fork Êìç‰ΩúÂàõÂª∫Â≠êËøõÁ®ãÔºåfork Êìç‰ΩúËøáÁ®ã‰∏≠Áà∂ËøõÁ®ã‰ºöÈòªÂ°ûÔºåÈÄöËøá info stats ÂëΩ‰ª§ Êü•Áúã latest_fork_usec ÈÄâÈ°πÔºåÂèØ‰ª•Ëé∑ÂèñÊúÄËøë‰∏Ä‰∏™ fork Êìç‰ΩúÁöÑËÄóÊó∂ÔºåÂçï‰Ωç‰∏∫ÊØ´Áßí Áà∂ËøõÁ®ã fork ÂÆåÊàêÂêéÔºåbgsave ÂëΩ‰ª§ËøîÂõû Background saving started ‰ø°ÊÅØÂπ∂‰∏ç‰ºöÈòªÂ°ûÁà∂ËøõÁ®ãÔºåÁà∂ËøõÁ®ãÂèØ‰ª•ÁªßÁª≠Â§ÑÁêÜÂÖ∂‰ªñÂëΩ‰ª§ËØ∑Ê±Ç Â≠êËøõÁ®ãÂàõÂª∫ rdb Êñá‰ª∂ÔºåÊ†πÊçÆÁà∂ËøõÁ®ãÁöÑÂÜÖÂ≠òÁîüÊàê‰∏¥Êó∂Âø´ÁÖßÊñá‰ª∂ÔºåÂÆåÊàêÂêéÂØπÂéüÊúâÊñá‰ª∂ËøõË°åÂéüÂ≠êÊõøÊç¢ ËøõÁ®ãÂèëÈÄÅ‰ø°Âè∑ÁªôÁà∂ËøõÁ®ãË°®Á§∫ÂÆåÊàêÔºåÁà∂ËøõÁ®ãÊõ¥Êñ∞ÁªüËÆ°‰ø°ÊÅØ Ëá™Âä®Ëß¶ÂèëËá™Âä®Ëß¶ÂèëÊúÄÂ∏∏ËßÅÁöÑÊÉÖÂÜµÊòØÂú®ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÈÄöËøá save m nÔºåÊåáÂÆöÂΩì m ÁßíÂÜÖÂèëÁîü n Ê¨°ÂèòÂåñÊó∂Ôºå‰ºöËß¶Âèë RDB ÊåÅ‰πÖÂåñÔºåÈªòËÆ§ÈááÁî® bgsave Á≠ñÁï•„ÄÇ 123456789101112131415161718192021# Âø´ÁÖßÁöÑÊñá‰ª∂Âêçdbfilename dump.rdb# Â≠òÊîæÂø´ÁÖßÁöÑÁõÆÂΩïdir ./# Âú®ËøõË°åÂø´ÁÖßÂ§á‰ªΩÊó∂,ÊòØÂê¶ËøõË°åÂéãÁº©„ÄÇ# yesÔºöÂéãÁº©Ôºå‰ΩÜÊòØÈúÄË¶Å‰∏Ä‰∫õcpuÁöÑÊ∂àËÄó„ÄÇ# noÔºö‰∏çÂéãÁº©ÔºåÈúÄË¶ÅÊõ¥Â§öÁöÑÁ£ÅÁõòÁ©∫Èó¥„ÄÇrdbcompression yes# ÊòØÂê¶ÂºÄÂêØRDBÊñá‰ª∂ÁöÑÊ†°È™åÔºåÂú®ÂÜôÂÖ•Êñá‰ª∂ÂíåËØªÂèñÊñá‰ª∂Êó∂ÈÉΩËµ∑‰ΩúÁî®,ÂÖ≥Èó≠Êó∂ÔºåÂÜôÂÖ•ÂíåÂêØÂä®Êñá‰ª∂ÊúâÂ§ßÁ∫¶10%ÁöÑÊÄßËÉΩÊèêÂçáÔºå‰ΩÜÊó†Ê≥ïÊ£ÄÊü•RDBÁöÑÊçüÂùèÊÉÖÂÜµrdbchecksum yes#Ëá™Âä®Ëß¶Âèë#900ÁßíÂêé‰∏îËá≥Â∞ë1‰∏™keyÂèëÁîüÂèòÂåñÊó∂ÂàõÂª∫Âø´ÁÖß save 900 1 #300ÁßíÂêé‰∏îËá≥Â∞ë10‰∏™keyÂèëÁîüÂèòÂåñÊó∂ÂàõÂª∫Âø´ÁÖß save 300 10 #60ÁßíÂêé‰∏îËá≥Â∞ë10000‰∏™keyÂèëÁîüÂèòÂåñÊó∂ÂàõÂª∫Âø´ÁÖß save 60 10000 RDB ÊåÅ‰πÖÂåñ‰ºòÁº∫ÁÇπRDB ‰ºòÂäø RDB is a very compact single-file point-in-time representation of your Redis data. RDB files are perfect for backups. For instance you may want to archive your RDB files every hour for the latest 24 hours, and to save an RDB snapshot every day for 30 days. This allows you to easily restore different versions of the data set in case of disasters. RDB is very good for disaster recovery, being a single compact file can be transferred to far data centers, or on Amazon S3 (possibly encrypted). RDB maximizes Redis performances since the only work the Redis parent process needs to do in order to persist is forking a child that will do all the rest. The parent instance will never perform disk I/O or alike. RDB allows faster restarts with big datasets compared to AOF. ËøôÊòØÂú® Redis ÂÆòÁΩë‰∏≠ÂØπ‰∫é RDB ÊåÅ‰πÖÂåñ‰ºòÁÇπÁöÑ‰∏ÄÊÆµÊèèËø∞ÔºåRDBÊñá‰ª∂ÊòØ‰∏Ä‰∏™ÈùûÂ∏∏Á¥ßÂáëÁöÑÂçïÊñá‰ª∂ÔºåÊèèËø∞‰∫ÜÊüê‰∏™Êó∂Èó¥ÁÇπÁöÑÊï∞ÊçÆÔºåÊâÄ‰ª•ÂÆÉÈùûÂ∏∏ÈÄÇÁî®‰∫éÂ§á‰ªΩ„ÄÇÂπ∂‰∏îÂÆÉÂæàÈÄÇÁî®‰∫éÁÅæÈöæÊÅ¢Â§çÔºåÂõ†‰∏∫ÂÆÉËÉΩÂ≠òÂÇ®‰∏çÂêåÁâàÊú¨ÁöÑÊï∞ÊçÆÈõÜÔºåËÉΩÂ§üËÆ©‰Ω†Âú®ÂèëÁîüÁÅæÈöæÊó∂ÂõûÂ§ç‰∏çÂêåÁâàÊú¨ÁöÑÊï∞ÊçÆÈõÜ„ÄÇ RDB Áº∫ÁÇπ RDB is NOT good if you need to minimize the chance of data loss in case Redis stops working (for example after a power outage). You can configure different save points where an RDB is produced (for instance after at least five minutes and 100 writes against the data set, but you can have multiple save points). However you‚Äôll usually create an RDB snapshot every five minutes or more, so in case of Redis stopping working without a correct shutdown for any reason you should be prepared to lose the latest minutes of data. RDB needs to fork() often in order to persist on disk using a child process. Fork() can be time consuming if the dataset is big, and may result in Redis to stop serving clients for some millisecond or even for one second if the dataset is very big and the CPU performance not great. AOF also needs to fork() but you can tune how often you want to rewrite your logs without any trade-off on durability. ÂÆòÁΩëÂ∑≤ÁªèÂ£∞Êòé‰∫ÜÔºåÂ¶ÇÊûú‰Ω†ÊÉ≥ÊúÄÂ∞èÂåñÊï∞ÊçÆ‰∏¢Â§±ÔºåRBD ‰∏çÊòØ‰∏Ä‰∏™Â•ΩÁöÑÈÄâÊã©ÔºåÂõ†‰∏∫ RDB ÊòØÂú®‰∏ÄÂÆöÈó¥ÈöîÊó∂Èó¥ÂÅö‰∏ÄÊ¨°Â§á‰ªΩÔºåÂ¶ÇÊûú Redis ÊÑèÂ§ñÂÆïÊú∫ÔºåÂ∞±‰ºö‰∏¢Â§±ÊéâÊúÄÂêé‰∏ÄÊ¨°Â§á‰ªΩ‰πãÂêéÁöÑÊâÄÊúâÊï∞ÊçÆ„ÄÇ RDB ÈªòËÆ§ÈááÁî® bgsave Êù•ËøõË°åÊåÅ‰πÖÂåñÔºåÊØèÊ¨° bgsave ÊØèÊ¨°ËøêË°åÈÉΩË¶ÅË∞ÉÁî® fork() ÂàõÂª∫‰∏Ä‰∏™Â≠êËøõÁ®ãÔºåËÄåÂ¶ÇÊûúÂÜÖÂ≠ò‰∏≠ÁöÑÊï∞ÊçÆÈõÜÈùûÂ∏∏Â§ßÔºåfork() ‰ºöÂõ†‰∏∫Ë¶Å‰∏∫Â≠êËøõÁ®ã‰∫ßÁîü‰∏Ä‰ªΩËôöÊãüÁ©∫Èó¥Ë°®ËÄåËä±Ë¥πËæÉÈïøÁöÑÊó∂Èó¥ÔºõÂ¶ÇÊûúÊ≠§Êó∂ÂÆ¢Êà∑Á´ØËØ∑Ê±ÇÊï∞ÈáèÈùûÂ∏∏Â§ßÁöÑËØùÔºå‰ºöÂØºËá¥ËæÉÂ§öÁöÑÂÜôÊó∂Êã∑Ë¥ùÊìç‰ΩúÔºõÂú® RDB ÊåÅ‰πÖÂåñÊìç‰ΩúËøáÁ®ã‰∏≠ÔºåÊØè‰∏Ä‰∏™Êï∞ÊçÆÈÉΩ‰ºöÂØºËá¥ write() Á≥ªÁªüË∞ÉÁî®ÔºåCPU ËµÑÊ∫êÂæàÁ¥ßÂº†„ÄÇÂõ†Ê≠§ÔºåÂ¶ÇÊûúÂú®‰∏ÄÂè∞Áâ©ÁêÜÊú∫‰∏äÈÉ®ÁΩ≤Â§ö‰∏™ redisÔºåÂ∫îËØ•ÈÅøÂÖçÂêåÊó∂ÊåÅ‰πÖÂåñÊìç‰Ωú„ÄÇ ÈÇ£Â¶Ç‰ΩïÁü•ÈÅì BGSAVE Âç†Áî®‰∫ÜÂ§öÂ∞ëÂÜÖÂ≠òÔºüÂ≠êËøõÁ®ãÂú®ÁªìÊùü‰πãÂâçÔºåËØªÂèñ‰∫ÜËá™Ë∫´ÁßÅÊúâËÑèÊï∞ÊçÆ Private_Dirty ÁöÑÂ§ßÂ∞èÔºåËøôÊ†∑ÂÅöÊòØ‰∏∫‰∫ÜËÆ©Áî®Êà∑ÁúãÂà∞ redis ÁöÑÊåÅ‰πÖÂåñËøõÁ®ãÊâÄÂç†Áî®‰∫ÜÊúâÂ§öÂ∞ëÁöÑÁ©∫Èó¥„ÄÇÂú®Áà∂ËøõÁ®ã fork ‰∫ßÁîüÂ≠êËøõÁ®ãËøáÂêéÔºåÁà∂Â≠êËøõÁ®ãËôΩÁÑ∂Êúâ‰∏çÂêåÁöÑËôöÊãüÁ©∫Èó¥Ôºå‰ΩÜÁâ©ÁêÜÁ©∫Èó¥‰∏äÊòØÂÖ±Â≠òÁöÑÔºåÁõ¥Ëá≥Áà∂ËøõÁ®ãÊàñËÄÖÂ≠êËøõÁ®ã‰øÆÊîπÂÜÖÂ≠òÊï∞ÊçÆ‰∏∫Ê≠¢ÔºåÊâÄ‰ª•ËÑèÊï∞ÊçÆ Private_Dirty ÂèØ‰ª•Ëøë‰ººÁöÑËÆ§‰∏∫ÊòØÂ≠êËøõÁ®ãÔºåÂç≥ÊåÅ‰πÖÂåñËøõÁ®ãÂç†Áî®ÁöÑÁ©∫Èó¥„ÄÇ AOF ÊåÅ‰πÖÂåñAOF Âç≥ Append-only file ÁöÑÁº©ÂÜôÔºåÂÆÉÂ∞Ü ‚ÄúÊìç‰Ωú + Êï∞ÊçÆ‚Äù ‰ª•Ê†ºÂºèÂåñÊåá‰ª§ÁöÑÊñπÂºèËøΩÂä†Âà∞Êìç‰ΩúÊó•ÂøóÊñá‰ª∂ÁöÑÂ∞æÈÉ®„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåRedis ÊòØÂ∞ÜÊâÄÊúâÊúçÂä°Âô®‰∏≠ÊâßË°åÁöÑÂëΩ‰ª§ËøΩÂä†Âà∞ AOF Êñá‰ª∂‰∏≠ÔºåËÄåÂú® append Êìç‰ΩúËøîÂõû‰πãÂêéÔºåÊâçËøõË°åÂÆûÈôÖÁöÑÊï∞ÊçÆÂèòÊõ¥„ÄÇ AOF ÈÖçÁΩÆRedis ÈªòËÆ§ÊòØÊ≤°ÊúâÂºÄÂêØ AOF ÊåÅ‰πÖÂåñÁöÑÔºåÈúÄË¶Å‰øÆÊîπ redis.conf Êù•ÂºÄÂêØÔºåÈÖçÁΩÆÂ¶Ç‰∏ãÔºö 12345678910111213141516171819##Ê≠§ÈÄâÈ°π‰∏∫aofÂäüËÉΩÁöÑÂºÄÂÖ≥ÔºåÈªòËÆ§‰∏∫‚Äúno‚ÄùÔºåÂèØ‰ª•ÈÄöËøá‚Äúyes‚ÄùÊù•ÂºÄÂêØaofÂäüËÉΩ ##Âè™ÊúâÂú®‚Äúyes‚Äù‰∏ãÔºåaofÈáçÂÜô/Êñá‰ª∂ÂêåÊ≠•Á≠âÁâπÊÄßÊâç‰ºöÁîüÊïà appendonly yes ##ÊåáÂÆöaofÊñá‰ª∂ÂêçÁß∞ appendfilename appendonly.aof ##ÊåáÂÆöaofÊìç‰Ωú‰∏≠Êñá‰ª∂ÂêåÊ≠•Á≠ñÁï•ÔºåÊúâ‰∏â‰∏™ÂêàÊ≥ïÂÄºÔºöalways everysec no,ÈªòËÆ§‰∏∫everysec appendfsync everysec ##Âú®aof-rewriteÊúüÈó¥ÔºåappendfsyncÊòØÂê¶ÊöÇÁºìÊñá‰ª∂ÂêåÊ≠•Ôºå&quot;no&quot;Ë°®Á§∫‚Äú‰∏çÊöÇÁºì‚ÄùÔºå‚Äúyes‚ÄùË°®Á§∫‚ÄúÊöÇÁºì‚ÄùÔºåÈªòËÆ§‰∏∫‚Äúno‚Äù no-appendfsync-on-rewrite no ##aofÊñá‰ª∂rewriteËß¶ÂèëÁöÑÊúÄÂ∞èÊñá‰ª∂Â∞∫ÂØ∏(mb,gb),Âè™ÊúâÂ§ß‰∫éÊ≠§aofÊñá‰ª∂Â§ß‰∫éÊ≠§Â∞∫ÂØ∏ÊòØÊâç‰ºöËß¶ÂèërewriteÔºåÈªòËÆ§‚Äú64mb‚ÄùÔºåÂª∫ËÆÆ‚Äú512mb‚Äù auto-aof-rewrite-min-size 64mb ##Áõ∏ÂØπ‰∫é‚Äú‰∏ä‰∏ÄÊ¨°‚ÄùrewriteÔºåÊú¨Ê¨°rewriteËß¶ÂèëÊó∂aofÊñá‰ª∂Â∫îËØ•Â¢ûÈïøÁöÑÁôæÂàÜÊØî„ÄÇ ##ÊØè‰∏ÄÊ¨°rewrite‰πãÂêéÔºåredisÈÉΩ‰ºöËÆ∞ÂΩï‰∏ãÊ≠§Êó∂‚ÄúÊñ∞aof‚ÄùÊñá‰ª∂ÁöÑÂ§ßÂ∞è(‰æãÂ¶ÇA)ÔºåÈÇ£‰πàÂΩìaofÊñá‰ª∂Â¢ûÈïøÂà∞A*(1 + p)‰πãÂêé ##Ëß¶Âèë‰∏ã‰∏ÄÊ¨°rewriteÔºåÊØè‰∏ÄÊ¨°aofËÆ∞ÂΩïÁöÑÊ∑ªÂä†ÔºåÈÉΩ‰ºöÊ£ÄÊµãÂΩìÂâçaofÊñá‰ª∂ÁöÑÂ∞∫ÂØ∏„ÄÇauto-aof-rewrite-percentage 100 AOF Êñá‰ª∂ÊÅ¢Â§çAOF ÈáçÂÜôAOF ‰ºòÁº∫ÁÇπ ÂèÇËÄÉÈìæÊé•ÔºöRedis persistenceRedis persistence demystifiedÊ∑±ÂÖ•Â≠¶‰π†RedisÔºà2ÔºâÔºöÊåÅ‰πÖÂåñRedisËØ¶Ëß£ÔºàÂÖ≠Ôºâ‚Äî‚Äî RDB ÊåÅ‰πÖÂåñRedisËØ¶Ëß£Ôºà‰∏ÉÔºâ‚Äî‚Äî AOF ÊåÅ‰πÖÂåñ]]></content>
      <categories>
        <category>Redis</category>
      </categories>
      <tags>
        <tag>Redis ÊåÅ‰πÖÂåñ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[104.Maximum Depth of Binary Tree]]></title>
    <url>%2Fmaximum-depth-of-binary-tree%2F</url>
    <content type="text"><![CDATA[TitleÔºö104 - Maximum Depth of Binary Tree - Easy DescriptionGiven a binary tree, find its maximum depth. The maximum depth is the number of nodes along the longest path from the root node down to the farthest leaf node. SolutionËß£È¢òÊÄùË∑ØÔºöÂ¶ÇÊûúÁªôÊàë‰ª¨ÁöÑ‰∫åÂèâÊ†ë‰∏∫ nullÔºåÂàôËøîÂõû 0 „ÄÇÂ¶ÇÊûú‰∏ç‰∏∫Á©∫ÔºåÂàô‰∫åÂèâÊ†ëÁöÑÊ∑±Â∫¶Ëá≥Â∞ë‰∏∫ 1ÔºåÂÜçÂ∞ÜÊØè‰∏™ËäÇÁÇπÁöÑÂ∑¶Â≠êËäÇÁÇπÂíåÂèàÂ≠êËäÇÁÇπËøõË°åÈÄíÂΩíÔºåÊü•ËØ¢Âá∫Ê∑±Â∫¶ÊúÄÂ§ßÁöÑ‰∏ÄÊù°Ë∑ØÂæÑ„ÄÇ ÂÖ∑‰Ωì‰ª£Á†ÅÂ¶Ç‰∏ãÔºöÔºàÈ¢òÁõÆËøá‰∫éÁÆÄÂçïÔºâ 123456789101112131415161718/** * Definition for a binary tree node. * public class TreeNode &#123; * int val; * TreeNode left; * TreeNode right; * TreeNode(int x) &#123; val = x; &#125; * &#125; */class Solution &#123; public int maxDepth(TreeNode root) &#123; if (root == null) &#123; return 0; &#125; return 1 + Math.max(maxDepth(root.left),maxDepth(root.right)); &#125;&#125;]]></content>
      <categories>
        <category>Leetcode</category>
        <category>Easy</category>
      </categories>
      <tags>
        <tag>Algorithm</tag>
        <tag>Binary Tree</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring MVC Ê∫êÁ†ÅÂàÜÊûê]]></title>
    <url>%2FSpring-MVC-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[[TOC] Ââç‰∏§Â§©Áúã‰∫Ü Spring IOC ÂÆπÂô®ÁöÑÊ∫êÁ†ÅÔºå‰∫ÜËß£‰∫ÜÂÆπÂô®ÊòØÊÄé‰πàÂàùÂßãÂåñÔºåSpring Beans ÁöÑÁîüÂëΩÂë®ÊúüÔºå‰ª•ÂèäÂàùÂßãÂåñÊó∂ÂæàÂ§öËÆæËÆ°Ê®°ÂºèÁöÑ‰ΩøÁî®„ÄÇËøôÁØáÊñáÁ´†Â∞ÜÂ∏¶Â§ßÂÆ∂ÈòÖËØª Spring MVC Â§ÑÁêÜËØ∑Ê±ÇÁöÑÊµÅÁ®ãÊ∫êÁ†ÅÔºàÊúâÁêÜËß£‰∏çÂΩì‰πãÂ§ÑËØ∑Ë∞ÖËß£ÔºâÔºåÂú®ÈòÖËØª Spring MVC Ê∫êÁ†Å‰πãÂâçÔºåÂª∫ËÆÆËØªËÄÖÂÖàÈòÖËØªËøô‰∏ÄÁØáÊñáÁ´† Spring IOC ÂÆπÂô®Ê∫êÁ†ÅÂàÜÊûê)ÔºåËøôÂ∞ÜÊúâÂä©‰∫éËØªËÄÖÁêÜËß£ Spring MVC ‰∏≠ÈÉ®ÂàÜÊ∫êÁ†Å„ÄÇ Êú¨ÊñáÈááÁî®ÁöÑÊ∫êÁ†ÅÁâàÊú¨‰∏∫ 5.0.x.RELEASE ÂºïË®ÄSpring MVC ÊòØÂü∫‰∫é Servlet ÂºÄÂèëÁöÑ‰∏Ä‰∏™ Web Ê°ÜÊû∂ÔºåÂÖ∂Ê†∏ÂøÉ‰∏∫ DispatcherServletÔºåÊàë‰ª¨ÂÖàÊù•Áúã‰∏Ä‰∏ãÂÆÉÁöÑÁªßÊâøÁªìÊûÑ„ÄÇ ÂæàÊòéÊòæÔºåDispatcherServlet ‰∏≠‰∏ÄÂÆöÂ∞ÅË£Ö‰∫Ü Servlet ÁöÑÊñπÊ≥ïÔºåËøô‰πüËÉΩËØ¥Êòé‰∏∫‰ªÄ‰πà Spring MVC ÊòØ‰∏Ä‰∏™Âü∫‰∫é SevletÂºÄÂèëÁöÑ Web MVC Ê°ÜÊû∂‰∫Ü„ÄÇ Servlet ÁîüÂëΩÂë®ÊúüÂú®ÂæÄ‰∏ãÂàÜÊûê‰πãÂâçÔºåÊàë‰ª¨ÂÖà‰∫ÜËß£‰∏Ä‰∏ã Servlet ÁöÑÁîüÂëΩÂë®ÊúüÊñπÊ≥ïÔºàÂÅáËÆæËØªËÄÖÂøòËÆ∞ÊàñËÄÖÂØπServlet ÁîüÂëΩÂë®Êúü‰∏çÁÜüÊÇâÔºâÔºö initÔºöServlet ÂàõÂª∫ÂØπË±°‰πãÂêéË∞ÉÁî® serviceÔºöServlet ÂØπË±°Ë¢´ HTTP ËØ∑Ê±ÇËÆøÈóÆÊó∂Ë∞ÉÁî® destroyÔºöServlet ÂØπË±°Ë¢´ÈîÄÊØÅ‰πãÂâçË∞ÉÁî® Spring MVC ÊÄª‰ΩìÊµÅÁ®ãÈ¶ñÂÖàÊàë‰ª¨Êù•ÁúãÁúã Spring MVC ‰∏≠Â§ÑÁêÜÊµÅÁ®ã]]></content>
      <categories>
        <category>Spring</category>
      </categories>
      <tags>
        <tag>Spring MVC</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring IOC ÂÆπÂô®Ê∫êÁ†ÅÂàÜÊûê]]></title>
    <url>%2FSpring-IOC-%E5%AE%B9%E5%99%A8%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[Spring ÊúÄÈáçË¶ÅÁöÑÊ¶ÇÂøµÊòØ IOC Âíå AOPÔºåÊú¨ÁØáÊñáÁ´†ÂÖ∂ÂÆûÂ∞±ÊòØË¶ÅÂ∏¶È¢ÜÂ§ßÂÆ∂Êù•ÂàÜÊûê‰∏ã Spring ÁöÑ IOC ÂÆπÂô®„ÄÇÊó¢ÁÑ∂Â§ßÂÆ∂Âπ≥Êó∂ÈÉΩË¶ÅÁî®Âà∞ SpringÔºåÊÄé‰πàÂèØ‰ª•‰∏çÂ•ΩÂ•Ω‰∫ÜËß£ Spring Âë¢ÔºüÈòÖËØªÊú¨ÊñáÂπ∂‰∏çËÉΩËÆ©‰Ω†Êàê‰∏∫ Spring ‰∏ìÂÆ∂Ôºå‰∏çËøá‰∏ÄÂÆöÊúâÂä©‰∫éÂ§ßÂÆ∂ÁêÜËß£ Spring ÁöÑÂæàÂ§öÊ¶ÇÂøµÔºåÂ∏ÆÂä©Â§ßÂÆ∂ÊéíÊü•Â∫îÁî®‰∏≠Âíå Spring Áõ∏ÂÖ≥ÁöÑ‰∏Ä‰∫õÈóÆÈ¢ò„ÄÇ ËΩ¨ËΩΩËá™Ôºöhttps://javadoop.com/post/spring-ioc Êú¨ÊñáÈááÁî®ÁöÑÊ∫êÁ†ÅÁâàÊú¨ÊòØ 4.3.11.RELEASEÔºåÁÆóÊòØ 5.0.x ÂâçÊØîËæÉÊñ∞ÁöÑÁâàÊú¨‰∫Ü„ÄÇ‰∏∫‰∫ÜÈôç‰ΩéÈöæÂ∫¶ÔºåÊú¨ÊñáÊâÄËØ¥ÁöÑÊâÄÊúâÁöÑÂÜÖÂÆπÈÉΩÊòØÂü∫‰∫é xml ÁöÑÈÖçÁΩÆÁöÑÊñπÂºèÔºåÂÆûÈôÖ‰ΩøÁî®Â∑≤ÁªèÂæàÂ∞ë‰∫∫Ëøô‰πàÂÅö‰∫ÜÔºåËá≥Â∞ë‰∏çÊòØÁ∫Ø xml ÈÖçÁΩÆÔºå‰∏çËøá‰ªéÁêÜËß£Ê∫êÁ†ÅÁöÑËßíÂ∫¶Êù•ÁúãÁî®ËøôÁßçÊñπÂºèÊù•ËØ¥Êó†ÁñëÊòØÊúÄÂêàÈÄÇÁöÑ„ÄÇ ÈòÖËØªÂª∫ËÆÆÔºöËØªËÄÖËá≥Â∞ëÈúÄË¶ÅÁü•ÈÅìÊÄé‰πàÈÖçÁΩÆ SpringÔºå‰∫ÜËß£ Spring ‰∏≠ÁöÑÂêÑÁßçÊ¶ÇÂøµÔºåÂ∞ëÈÉ®ÂàÜÂÜÖÂÆπÊàëËøòÂÅáËÆæËØªËÄÖ‰ΩøÁî®Ëøá SpringMVC„ÄÇÊú¨ÊñáË¶ÅËØ¥ÁöÑ IOC ÊÄª‰ΩìÊù•ËØ¥Êúâ‰∏§Â§ÑÂú∞ÊñπÊúÄÈáçË¶ÅÔºå‰∏Ä‰∏™ÊòØÂàõÂª∫ Bean ÂÆπÂô®Ôºå‰∏Ä‰∏™ÊòØÂàùÂßãÂåñ BeanÔºåÂ¶ÇÊûúËØªËÄÖËßâÂæó‰∏ÄÊ¨°ÊÄßÁúãÂÆåÊú¨ÊñáÂéãÂäõÊúâÁÇπÂ§ßÔºåÈÇ£‰πàÂèØ‰ª•ÊåâËøô‰∏™ÊÄùË∑ØÂàÜ‰∏§Ê¨°Ê∂àÂåñ„ÄÇËØªËÄÖ‰∏ç‰∏ÄÂÆöÂØπ Spring ÂÆπÂô®ÁöÑÊ∫êÁ†ÅÊÑüÂÖ¥Ë∂£Ôºå‰πüËÆ∏ÈôÑÂΩïÈÉ®ÂàÜ‰ªãÁªçÁöÑÁü•ËØÜÂØπËØªËÄÖÊúâ‰∫õËÆ∏‰ΩúÁî®„ÄÇ Â∏åÊúõÈÄöËøáÊú¨ÊñáÂèØ‰ª•ËÆ©ËØªËÄÖ‰∏çÊÉßÊÄïÈòÖËØª Spring Ê∫êÁ†ÅÔºå‰πüÂ∏åÊúõÂ§ßÂÆ∂ËÉΩÂèçÈ¶àË°®Ëø∞ÈîôËØØÊàñ‰∏çÂêàÁêÜÁöÑÂú∞Êñπ„ÄÇ ÁõÆÂΩï ÂºïË®ÄÂÖàÁúã‰∏ãÊúÄÂü∫Êú¨ÁöÑÂêØÂä® Spring ÂÆπÂô®ÁöÑ‰æãÂ≠êÔºö 123public static void main(String[] args) &#123; ApplicationContext context = new ClassPathXmlApplicationContext("classpath:applicationfile.xml");&#125; ‰ª•‰∏ä‰ª£Á†ÅÂ∞±ÂèØ‰ª•Âà©Áî®ÈÖçÁΩÆÊñá‰ª∂Êù•ÂêØÂä®‰∏Ä‰∏™ Spring ÂÆπÂô®‰∫ÜÔºåËØ∑‰ΩøÁî® maven ÁöÑÂ∞è‰ºô‰º¥Áõ¥Êé•Âú® dependencies ‰∏≠Âä†‰∏ä‰ª•‰∏ã‰æùËµñÂç≥ÂèØÔºå‰∏™‰∫∫ÊØîËæÉÂèçÂØπÈÇ£‰∫õ‰∏çÁü•ÈÅìË¶ÅÊ∑ªÂä†‰ªÄ‰πà‰æùËµñÔºåÁÑ∂ÂêéÊää Spring ÁöÑÊâÄÊúâÁõ∏ÂÖ≥ÁöÑ‰∏úË•øÈÉΩÂä†ËøõÊù•ÁöÑÊñπÂºè„ÄÇ 12345&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;4.3.11.RELEASE&lt;/version&gt;&lt;/dependency&gt; spring-context ‰ºöËá™Âä®Â∞Ü spring-core„ÄÅspring-beans„ÄÅspring-aop„ÄÅspring-expression ËøôÂá†‰∏™Âü∫Á°Ä jar ÂåÖÂ∏¶ËøõÊù•„ÄÇ Â§öËØ¥‰∏ÄÂè•ÔºåÂæàÂ§öÂºÄÂèëËÄÖÂÖ•Èó®Â∞±Áõ¥Êé•Êé•Ëß¶ÁöÑ SpringMVCÔºåÂØπ Spring ÂÖ∂ÂÆû‰∏çÊòØÂæà‰∫ÜËß£ÔºåSpring ÊòØÊ∏êËøõÂºèÁöÑÂ∑•ÂÖ∑ÔºåÂπ∂‰∏çÂÖ∑ÊúâÂæàÂº∫ÁöÑ‰æµÂÖ•ÊÄßÔºåÂÆÉÁöÑÊ®°Âùó‰πüÂàíÂàÜÂæóÂæàÂêàÁêÜÔºåÂç≥‰Ωø‰Ω†ÁöÑÂ∫îÁî®‰∏çÊòØ web Â∫îÁî®ÔºåÊàñËÄÖ‰πãÂâçÂÆåÂÖ®Ê≤°Êúâ‰ΩøÁî®Âà∞ SpringÔºåËÄå‰Ω†Â∞±ÊÉ≥Áî® Spring ÁöÑ‰æùËµñÊ≥®ÂÖ•Ëøô‰∏™ÂäüËÉΩÔºåÂÖ∂ÂÆûÂÆåÂÖ®ÊòØÂèØ‰ª•ÁöÑÔºåÂÆÉÁöÑÂºïÂÖ•‰∏ç‰ºöÂØπÂÖ∂‰ªñÁöÑÁªÑ‰ª∂‰∫ßÁîüÂÜ≤Á™Å„ÄÇ Â∫üËØùËØ¥ÂÆåÔºåÊàë‰ª¨ÁªßÁª≠„ÄÇApplicationContext context = new ClassPathXmlApplicationContext(...) ÂÖ∂ÂÆûÂæàÂ•ΩÁêÜËß£Ôºå‰ªéÂêçÂ≠ó‰∏äÂ∞±ÂèØ‰ª•ÁåúÂá∫‰∏Ä‰∫åÔºåÂ∞±ÊòØÂú® ClassPath ‰∏≠ÂØªÊâæ xml ÈÖçÁΩÆÊñá‰ª∂ÔºåÊ†πÊçÆ xml Êñá‰ª∂ÂÜÖÂÆπÊù•ÊûÑÂª∫ ApplicationContext„ÄÇÂΩìÁÑ∂ÔºåÈô§‰∫Ü ClassPathXmlApplicationContext ‰ª•Â§ñÔºåÊàë‰ª¨‰πüËøòÊúâÂÖ∂‰ªñÊûÑÂª∫ ApplicationContext ÁöÑÊñπÊ°àÂèØ‰æõÈÄâÊã©ÔºåÊàë‰ª¨ÂÖàÊù•ÁúãÁúãÂ§ß‰ΩìÁöÑÁªßÊâøÁªìÊûÑÊòØÊÄé‰πàÊ†∑ÁöÑÔºö ËØªËÄÖÂèØ‰ª•Â§ßËá¥Áúã‰∏Ä‰∏ãÁ±ªÂêçÔºåÊ∫êÁ†ÅÂàÜÊûêÁöÑÊó∂ÂÄô‰∏çËá≥‰∫éÊâæ‰∏çÁùÄÁúãÂì™‰∏™Á±ªÔºåÂõ†‰∏∫ Spring ‰∏∫‰∫ÜÈÄÇÂ∫îÂêÑÁßç‰ΩøÁî®Âú∫ÊôØÔºåÊèê‰æõÁöÑÂêÑ‰∏™Êé•Âè£ÈÉΩÂèØËÉΩÊúâÂæàÂ§öÁöÑÂÆûÁé∞Á±ª„ÄÇÂØπ‰∫éÊàë‰ª¨Êù•ËØ¥ÔºåÂ∞±ÊòØÊè™ÁùÄ‰∏Ä‰∏™ÂÆåÊï¥ÁöÑÂàÜÊîØÁúãÂÆå„ÄÇ ÂΩìÁÑ∂ÔºåËØªÊú¨ÊñáÁöÑÊó∂ÂÄôËØªËÄÖ‰πü‰∏çÂøÖÂ§™ÊãÖÂøÉÔºåÊØè‰∏™‰ª£Á†ÅÂùóÂàÜÊûêÁöÑÊó∂ÂÄôÔºåÊàëÈÉΩ‰ºöÂëäËØâËØªËÄÖÊàë‰ª¨Âú®ËØ¥Âì™‰∏™Á±ªÁ¨¨Âá†Ë°å„ÄÇ Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÔºåClassPathXmlApplicationContext ÂÖúÂÖúËΩ¨ËΩ¨‰∫ÜÂ•Ω‰πÖÊâçÂà∞ ApplicationContext Êé•Âè£ÔºåÂêåÊ†∑ÁöÑÔºåÊàë‰ª¨‰πüÂèØ‰ª•‰ΩøÁî®ÁªøÈ¢úËâ≤ÁöÑ FileSystemXmlApplicationContext Âíå AnnotationConfigApplicationContext Ëøô‰∏§‰∏™Á±ª„ÄÇ FileSystemXmlApplicationContext ÁöÑÊûÑÈÄ†ÂáΩÊï∞ÈúÄË¶Å‰∏Ä‰∏™ xml ÈÖçÁΩÆÊñá‰ª∂Âú®Á≥ªÁªü‰∏≠ÁöÑË∑ØÂæÑÔºåÂÖ∂‰ªñÂíå ClassPathXmlApplicationContext Âü∫Êú¨‰∏ä‰∏ÄÊ†∑„ÄÇ AnnotationConfigApplicationContext ÊòØÂü∫‰∫éÊ≥®Ëß£Êù•‰ΩøÁî®ÁöÑÔºåÂÆÉ‰∏çÈúÄË¶ÅÈÖçÁΩÆÊñá‰ª∂ÔºåÈááÁî® java ÈÖçÁΩÆÁ±ªÂíåÂêÑÁßçÊ≥®Ëß£Êù•ÈÖçÁΩÆÔºåÊòØÊØîËæÉÁÆÄÂçïÁöÑÊñπÂºèÔºå‰πüÊòØÂ§ßÂäøÊâÄË∂ãÂêß„ÄÇ ‰∏çËøáÊú¨ÊñáÊó®Âú®Â∏ÆÂä©Â§ßÂÆ∂ÁêÜËß£Êï¥‰∏™ÊûÑÂª∫ÊµÅÁ®ãÔºåÊâÄ‰ª•ÂÜ≥ÂÆö‰ΩøÁî® ClassPathXmlApplicationContext ËøõË°åÂàÜÊûê„ÄÇ Êàë‰ª¨ÂÖàÊù•‰∏Ä‰∏™ÁÆÄÂçïÁöÑ‰æãÂ≠êÊù•ÁúãÁúãÊÄé‰πàÂÆû‰æãÂåñ ApplicationContext„ÄÇ È¶ñÂÖàÔºåÂÆö‰πâ‰∏Ä‰∏™Êé•Âè£Ôºö 123public interface MessageService &#123; String getMessage();&#125; ÂÆö‰πâÊé•Âè£ÂÆûÁé∞Á±ªÔºö 123456public class MessageServiceImpl implements MessageService &#123; public String getMessage() &#123; return "hello world"; &#125;&#125; Êé•‰∏ãÊù•ÔºåÊàë‰ª¨Âú® resources ÁõÆÂΩïÊñ∞Âª∫‰∏Ä‰∏™ÈÖçÁΩÆÊñá‰ª∂ÔºåÊñá‰ª∂ÂêçÈöèÊÑèÔºåÈÄöÂ∏∏Âè´ application.xml Êàñ application-xxx.xml Â∞±ÂèØ‰ª•‰∫ÜÔºö 1234567&lt;?xml version="1.0" encoding="UTF-8" ?&gt;&lt;beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.springframework.org/schema/beans" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd" default-autowire="byName"&gt; &lt;bean id="messageService" class="com.javadoop.example.MessageServiceImpl"/&gt;&lt;/beans&gt; ËøôÊ†∑ÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Ë∑ëËµ∑Êù•‰∫ÜÔºö 12345678910111213public class App &#123; public static void main(String[] args) &#123; // Áî®Êàë‰ª¨ÁöÑÈÖçÁΩÆÊñá‰ª∂Êù•ÂêØÂä®‰∏Ä‰∏™ ApplicationContext ApplicationContext context = new ClassPathXmlApplicationContext("classpath:application.xml"); System.out.println("context ÂêØÂä®ÊàêÂäü"); // ‰ªé context ‰∏≠ÂèñÂá∫Êàë‰ª¨ÁöÑ BeanÔºåËÄå‰∏çÊòØÁî® new MessageServiceImpl() ËøôÁßçÊñπÂºè MessageService messageService = context.getBean(MessageService.class); // ËøôÂè•Â∞ÜËæìÂá∫: hello world System.out.println(messageService.getMessage()); &#125;&#125; ‰ª•‰∏ä‰æãÂ≠êÂæàÁÆÄÂçïÔºå‰∏çËøá‰πüÂ§üÂºïÂá∫Êú¨ÊñáÁöÑ‰∏ªÈ¢ò‰∫ÜÔºåÂ∞±ÊòØÊÄé‰πàÊ†∑ÈÄöËøáÈÖçÁΩÆÊñá‰ª∂Êù•ÂêØÂä® Spring ÁöÑ ApplicationContextÔºü‰πüÂ∞±ÊòØÊàë‰ª¨‰ªäÂ§©Ë¶ÅÂàÜÊûêÁöÑ IOC ÁöÑÊ†∏ÂøÉ‰∫Ü„ÄÇApplicationContext ÂêØÂä®ËøáÁ®ã‰∏≠Ôºå‰ºöË¥üË¥£ÂàõÂª∫ÂÆû‰æã BeanÔºåÂæÄÂêÑ‰∏™ Bean ‰∏≠Ê≥®ÂÖ•‰æùËµñÁ≠â„ÄÇ BeanFactory ÁÆÄ‰ªãBeanFactoryÔºå‰ªéÂêçÂ≠ó‰∏ä‰πüÂæàÂ•ΩÁêÜËß£ÔºåÁîü‰∫ß bean ÁöÑÂ∑•ÂéÇÔºåÂÆÉË¥üË¥£Áîü‰∫ßÂíåÁÆ°ÁêÜÂêÑ‰∏™ bean ÂÆû‰æã„ÄÇ ÂàùÂ≠¶ËÄÖÂèØÂà´‰ª•‰∏∫Êàë‰πãÂâçËØ¥ÈÇ£‰πàÂ§öÂíå BeanFactory Êó†ÂÖ≥ÔºåÂâçÈù¢ËØ¥ÁöÑ ApplicationContext ÂÖ∂ÂÆûÂ∞±ÊòØ‰∏Ä‰∏™ BeanFactory„ÄÇÊàë‰ª¨Êù•Áúã‰∏ãÂíå BeanFactory Êé•Âè£Áõ∏ÂÖ≥ÁöÑ‰∏ªË¶ÅÁöÑÁªßÊâøÁªìÊûÑÔºö ÊàëÊÉ≥ÔºåÂ§ßÂÆ∂ÁúãÂÆåËøô‰∏™Âõæ‰ª•ÂêéÔºåÂèØËÉΩÂ∞±‰∏çÊòØÂæàÂºÄÂøÉ‰∫Ü„ÄÇApplicationContext ÂæÄ‰∏ãÁöÑÁªßÊâøÁªìÊûÑÂâçÈù¢‰∏ÄÂº†ÂõæËØ¥Ëøá‰∫ÜÔºåËøôÈáåÂ∞±‰∏çÈáçÂ§ç‰∫Ü„ÄÇËøôÂº†ÂõæÂë¢ÔºåËÉå‰∏ãÊù•ËÇØÂÆöÊòØ‰∏çÈúÄË¶ÅÁöÑÔºåÊúâÂá†‰∏™ÈáçÁÇπÂíåÂ§ßÂÆ∂ËØ¥Êòé‰∏ãÂ∞±Â•Ω„ÄÇ ApplicationContext ÁªßÊâø‰∫Ü ListableBeanFactoryÔºåËøô‰∏™ Listable ÁöÑÊÑèÊÄùÂ∞±ÊòØÔºåÈÄöËøáËøô‰∏™Êé•Âè£ÔºåÊàë‰ª¨ÂèØ‰ª•Ëé∑ÂèñÂ§ö‰∏™ BeanÔºåÂ§ßÂÆ∂ÁúãÊ∫êÁ†Å‰ºöÂèëÁé∞ÔºåÊúÄÈ°∂Â±Ç BeanFactory Êé•Âè£ÁöÑÊñπÊ≥ïÈÉΩÊòØËé∑ÂèñÂçï‰∏™ Bean ÁöÑ„ÄÇ ApplicationContext ÁªßÊâø‰∫Ü HierarchicalBeanFactoryÔºåHierarchical ÂçïËØçÊú¨Ë∫´Â∑≤ÁªèËÉΩËØ¥ÊòéÈóÆÈ¢ò‰∫ÜÔºå‰πüÂ∞±ÊòØËØ¥Êàë‰ª¨ÂèØ‰ª•Âú®Â∫îÁî®‰∏≠Ëµ∑Â§ö‰∏™ BeanFactoryÔºåÁÑ∂ÂêéÂèØ‰ª•Â∞ÜÂêÑ‰∏™ BeanFactory ËÆæÁΩÆ‰∏∫Áà∂Â≠êÂÖ≥Á≥ª„ÄÇ AutowireCapableBeanFactory Ëøô‰∏™ÂêçÂ≠ó‰∏≠ÁöÑ Autowire Â§ßÂÆ∂ÈÉΩÈùûÂ∏∏ÁÜüÊÇâÔºåÂÆÉÂ∞±ÊòØÁî®Êù•Ëá™Âä®Ë£ÖÈÖç Bean Áî®ÁöÑÔºå‰ΩÜÊòØ‰ªîÁªÜÁúã‰∏äÂõæÔºåApplicationContext Âπ∂Ê≤°ÊúâÁªßÊâøÂÆÉÔºå‰∏çËøá‰∏çÁî®ÊãÖÂøÉÔºå‰∏ç‰ΩøÁî®ÁªßÊâøÔºå‰∏ç‰ª£Ë°®‰∏çÂèØ‰ª•‰ΩøÁî®ÁªÑÂêàÔºåÂ¶ÇÊûú‰Ω†ÁúãÂà∞ ApplicationContext Êé•Âè£ÂÆö‰πâ‰∏≠ÁöÑÊúÄÂêé‰∏Ä‰∏™ÊñπÊ≥ï getAutowireCapableBeanFactory() Â∞±Áü•ÈÅì‰∫Ü„ÄÇ ConfigurableListableBeanFactory ‰πüÊòØ‰∏Ä‰∏™ÁâπÊÆäÁöÑÊé•Âè£ÔºåÁúãÂõæÔºåÁâπÊÆä‰πãÂ§ÑÂú®‰∫éÂÆÉÁªßÊâø‰∫ÜÁ¨¨‰∫åÂ±ÇÊâÄÊúâÁöÑ‰∏â‰∏™Êé•Âè£ÔºåËÄå ApplicationContext Ê≤°Êúâ„ÄÇËøôÁÇπ‰πãÂêé‰ºöÁî®Âà∞„ÄÇ ËØ∑ÂÖà‰∏çÁî®Ëä±Êó∂Èó¥Âú®ÂÖ∂‰ªñÁöÑÊé•Âè£ÂíåÁ±ª‰∏äÔºåÂÖàÁêÜËß£ÊàëËØ¥ÁöÑËøôÂá†ÁÇπÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇ ÁÑ∂ÂêéÔºåËØ∑ËØªËÄÖÊâìÂºÄÁºñËæëÂô®ÔºåÁøª‰∏Ä‰∏ã BeanFactory„ÄÅListableBeanFactory„ÄÅHierarchicalBeanFactory„ÄÅAutowireCapableBeanFactory„ÄÅApplicationContext ËøôÂá†‰∏™Êé•Âè£ÁöÑ‰ª£Á†ÅÔºåÂ§ßÊ¶ÇÁúã‰∏Ä‰∏ãÂêÑ‰∏™Êé•Âè£‰∏≠ÁöÑÊñπÊ≥ïÔºåÂ§ßÂÆ∂ÂøÉÈáåË¶ÅÊúâÂ∫ïÔºåÈôê‰∫éÁØáÂπÖÔºåÊàëÂ∞±‰∏çË¥¥‰ª£Á†Å‰ªãÁªç‰∫Ü„ÄÇ ÂêØÂä®ËøáÁ®ãÂàÜÊûê‰∏ãÈù¢Â∞Ü‰ºöÊòØÂÜóÈïøÁöÑ‰ª£Á†ÅÂàÜÊûêÔºåËÆ∞‰ΩèÔºå‰∏ÄÂÆöË¶ÅËá™Â∑±ÊâìÂºÄÊ∫êÁ†ÅÊù•ÁúãÔºå‰∏çÁÑ∂Á∫ØÁúãÊòØÂæàÁ¥ØÁöÑ„ÄÇ Á¨¨‰∏ÄÊ≠•ÔºåÊàë‰ª¨ËÇØÂÆöË¶Å‰ªé ClassPathXmlApplicationContext ÁöÑÊûÑÈÄ†ÊñπÊ≥ïËØ¥Ëµ∑„ÄÇ 1234567891011121314151617181920public class ClassPathXmlApplicationContext extends AbstractXmlApplicationContext &#123; private Resource[] configResources; // Â¶ÇÊûúÂ∑≤ÁªèÊúâ ApplicationContext Âπ∂ÈúÄË¶ÅÈÖçÁΩÆÊàêÁà∂Â≠êÂÖ≥Á≥ªÔºåÈÇ£‰πàË∞ÉÁî®Ëøô‰∏™ÊûÑÈÄ†ÊñπÊ≥ï public ClassPathXmlApplicationContext(ApplicationContext parent) &#123; super(parent); &#125; ... public ClassPathXmlApplicationContext(String[] configLocations, boolean refresh, ApplicationContext parent) throws BeansException &#123; super(parent); // Ê†πÊçÆÊèê‰æõÁöÑË∑ØÂæÑÔºåÂ§ÑÁêÜÊàêÈÖçÁΩÆÊñá‰ª∂Êï∞ÁªÑ(‰ª•ÂàÜÂè∑„ÄÅÈÄóÂè∑„ÄÅÁ©∫Ê†º„ÄÅtab„ÄÅÊç¢Ë°åÁ¨¶ÂàÜÂâ≤) setConfigLocations(configLocations); if (refresh) &#123; refresh(); // Ê†∏ÂøÉÊñπÊ≥ï &#125; &#125; ...&#125; Êé•‰∏ãÊù•ÔºåÂ∞±ÊòØ refresh()ÔºåËøôÈáåÁÆÄÂçïËØ¥‰∏ã‰∏∫‰ªÄ‰πàÊòØ refresh()ÔºåËÄå‰∏çÊòØ init() ËøôÁßçÂêçÂ≠óÁöÑÊñπÊ≥ï„ÄÇÂõ†‰∏∫ ApplicationContext Âª∫Á´ãËµ∑Êù•‰ª•ÂêéÔºåÂÖ∂ÂÆûÊàë‰ª¨ÊòØÂèØ‰ª•ÈÄöËøáË∞ÉÁî® refresh() Ëøô‰∏™ÊñπÊ≥ïÈáçÂª∫ÁöÑÔºårefresh() ‰ºöÂ∞ÜÂéüÊù•ÁöÑ ApplicationContext ÈîÄÊØÅÔºåÁÑ∂ÂêéÂÜçÈáçÊñ∞ÊâßË°å‰∏ÄÊ¨°ÂàùÂßãÂåñÊìç‰Ωú„ÄÇ ÂæÄ‰∏ãÁúãÔºårefresh() ÊñπÊ≥ïÈáåÈù¢Ë∞ÉÁî®‰∫ÜÈÇ£‰πàÂ§öÊñπÊ≥ïÔºåÂ∞±Áü•ÈÅìËÇØÂÆö‰∏çÁÆÄÂçï‰∫ÜÔºåËØ∑ËØªËÄÖÂÖàÁúã‰∏™Â§ßÊ¶ÇÔºåÁªÜËäÇ‰πãÂêé‰ºöËØ¶ÁªÜËØ¥„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778@Overridepublic void refresh() throws BeansException, IllegalStateException &#123; // Êù•‰∏™ÈîÅÔºå‰∏çÁÑ∂ refresh() ËøòÊ≤°ÁªìÊùüÔºå‰Ω†ÂèàÊù•‰∏™ÂêØÂä®ÊàñÈîÄÊØÅÂÆπÂô®ÁöÑÊìç‰ΩúÔºåÈÇ£‰∏çÂ∞±‰π±Â•ó‰∫ÜÂòõ synchronized (this.startupShutdownMonitor) &#123; // ÂáÜÂ§áÂ∑•‰ΩúÔºåËÆ∞ÂΩï‰∏ãÂÆπÂô®ÁöÑÂêØÂä®Êó∂Èó¥„ÄÅÊ†áËÆ∞‚ÄúÂ∑≤ÂêØÂä®‚ÄùÁä∂ÊÄÅ„ÄÅÂ§ÑÁêÜÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑÂç†‰ΩçÁ¨¶ prepareRefresh(); // ËøôÊ≠•ÊØîËæÉÂÖ≥ÈîÆÔºåËøôÊ≠•ÂÆåÊàêÂêéÔºåÈÖçÁΩÆÊñá‰ª∂Â∞±‰ºöËß£ÊûêÊàê‰∏Ä‰∏™‰∏™ Bean ÂÆö‰πâÔºåÊ≥®ÂÜåÂà∞ BeanFactory ‰∏≠Ôºå // ÂΩìÁÑ∂ÔºåËøôÈáåËØ¥ÁöÑ Bean ËøòÊ≤°ÊúâÂàùÂßãÂåñÔºåÂè™ÊòØÈÖçÁΩÆ‰ø°ÊÅØÈÉΩÊèêÂèñÂá∫Êù•‰∫ÜÔºå // Ê≥®ÂÜå‰πüÂè™ÊòØÂ∞ÜËøô‰∫õ‰ø°ÊÅØÈÉΩ‰øùÂ≠òÂà∞‰∫ÜÊ≥®ÂÜå‰∏≠ÂøÉ(ËØ¥Âà∞Â∫ïÊ†∏ÂøÉÊòØ‰∏Ä‰∏™ beanName-&gt; beanDefinition ÁöÑ map) ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory(); // ËÆæÁΩÆ BeanFactory ÁöÑÁ±ªÂä†ËΩΩÂô®ÔºåÊ∑ªÂä†Âá†‰∏™ BeanPostProcessorÔºåÊâãÂä®Ê≥®ÂÜåÂá†‰∏™ÁâπÊÆäÁöÑ bean // ËøôÂùóÂæÖ‰ºö‰ºöÂ±ïÂºÄËØ¥ prepareBeanFactory(beanFactory); try &#123; // „ÄêËøôÈáåÈúÄË¶ÅÁü•ÈÅì BeanFactoryPostProcessor Ëøô‰∏™Áü•ËØÜÁÇπÔºåBean Â¶ÇÊûúÂÆûÁé∞‰∫ÜÊ≠§Êé•Âè£Ôºå // ÈÇ£‰πàÂú®ÂÆπÂô®ÂàùÂßãÂåñ‰ª•ÂêéÔºåSpring ‰ºöË¥üË¥£Ë∞ÉÁî®ÈáåÈù¢ÁöÑ postProcessBeanFactory ÊñπÊ≥ï„ÄÇ„Äë // ËøôÈáåÊòØÊèê‰æõÁªôÂ≠êÁ±ªÁöÑÊâ©Â±ïÁÇπÔºåÂà∞ËøôÈáåÁöÑÊó∂ÂÄôÔºåÊâÄÊúâÁöÑ Bean ÈÉΩÂä†ËΩΩ„ÄÅÊ≥®ÂÜåÂÆåÊàê‰∫ÜÔºå‰ΩÜÊòØÈÉΩËøòÊ≤°ÊúâÂàùÂßãÂåñ // ÂÖ∑‰ΩìÁöÑÂ≠êÁ±ªÂèØ‰ª•Âú®ËøôÊ≠•ÁöÑÊó∂ÂÄôÊ∑ªÂä†‰∏Ä‰∫õÁâπÊÆäÁöÑ BeanFactoryPostProcessor ÁöÑÂÆûÁé∞Á±ªÊàñÂÅöÁÇπ‰ªÄ‰πà‰∫ã postProcessBeanFactory(beanFactory); // Ë∞ÉÁî® BeanFactoryPostProcessor ÂêÑ‰∏™ÂÆûÁé∞Á±ªÁöÑ postProcessBeanFactory(factory) ÊñπÊ≥ï invokeBeanFactoryPostProcessors(beanFactory); // Ê≥®ÂÜå BeanPostProcessor ÁöÑÂÆûÁé∞Á±ªÔºåÊ≥®ÊÑèÁúãÂíå BeanFactoryPostProcessor ÁöÑÂå∫Âà´ // Ê≠§Êé•Âè£‰∏§‰∏™ÊñπÊ≥ï: postProcessBeforeInitialization Âíå postProcessAfterInitialization // ‰∏§‰∏™ÊñπÊ≥ïÂàÜÂà´Âú® Bean ÂàùÂßãÂåñ‰πãÂâçÂíåÂàùÂßãÂåñ‰πãÂêéÂæóÂà∞ÊâßË°å„ÄÇÊ≥®ÊÑèÔºåÂà∞ËøôÈáå Bean ËøòÊ≤°ÂàùÂßãÂåñ registerBeanPostProcessors(beanFactory); // ÂàùÂßãÂåñÂΩìÂâç ApplicationContext ÁöÑ MessageSourceÔºåÂõΩÈôÖÂåñËøôÈáåÂ∞±‰∏çÂ±ïÂºÄËØ¥‰∫ÜÔºå‰∏çÁÑ∂Ê≤°ÂÆåÊ≤°‰∫Ü‰∫Ü initMessageSource(); // ÂàùÂßãÂåñÂΩìÂâç ApplicationContext ÁöÑ‰∫ã‰ª∂ÂπøÊí≠Âô®ÔºåËøôÈáå‰πü‰∏çÂ±ïÂºÄ‰∫Ü initApplicationEventMulticaster(); // ‰ªéÊñπÊ≥ïÂêçÂ∞±ÂèØ‰ª•Áü•ÈÅìÔºåÂÖ∏ÂûãÁöÑÊ®°ÊùøÊñπÊ≥ï(Èí©Â≠êÊñπÊ≥ï)Ôºå // ÂÖ∑‰ΩìÁöÑÂ≠êÁ±ªÂèØ‰ª•Âú®ËøôÈáåÂàùÂßãÂåñ‰∏Ä‰∫õÁâπÊÆäÁöÑ BeanÔºàÂú®ÂàùÂßãÂåñ singleton beans ‰πãÂâçÔºâ onRefresh(); // Ê≥®ÂÜå‰∫ã‰ª∂ÁõëÂê¨Âô®ÔºåÁõëÂê¨Âô®ÈúÄË¶ÅÂÆûÁé∞ ApplicationListener Êé•Âè£„ÄÇËøô‰πü‰∏çÊòØÊàë‰ª¨ÁöÑÈáçÁÇπÔºåËøá registerListeners(); // ÈáçÁÇπÔºåÈáçÁÇπÔºåÈáçÁÇπ // ÂàùÂßãÂåñÊâÄÊúâÁöÑ singleton beans //Ôºàlazy-init ÁöÑÈô§Â§ñÔºâ finishBeanFactoryInitialization(beanFactory); // ÊúÄÂêéÔºåÂπøÊí≠‰∫ã‰ª∂ÔºåApplicationContext ÂàùÂßãÂåñÂÆåÊàê finishRefresh(); &#125; catch (BeansException ex) &#123; if (logger.isWarnEnabled()) &#123; logger.warn("Exception encountered during context initialization - " + "cancelling refresh attempt: " + ex); &#125; // Destroy already created singletons to avoid dangling resources. // ÈîÄÊØÅÂ∑≤ÁªèÂàùÂßãÂåñÁöÑ singleton ÁöÑ BeansÔºå‰ª•ÂÖçÊúâ‰∫õ bean ‰ºö‰∏ÄÁõ¥Âç†Áî®ËµÑÊ∫ê destroyBeans(); // Reset 'active' flag. cancelRefresh(ex); // ÊääÂºÇÂ∏∏ÂæÄÂ§ñÊäõ throw ex; &#125; finally &#123; // Reset common introspection caches in Spring's core, since we // might not ever need metadata for singleton beans anymore... resetCommonCaches(); &#125; &#125;&#125; ‰∏ãÈù¢ÔºåÊàë‰ª¨ÂºÄÂßã‰∏ÄÊ≠•Ê≠•Êù•ËÇ¢Ëß£Ëøô‰∏™ refresh() ÊñπÊ≥ï„ÄÇ ÂàõÂª∫ Bean ÂÆπÂô®ÂâçÁöÑÂáÜÂ§áÂ∑•‰ΩúËøô‰∏™ÊØîËæÉÁÆÄÂçïÔºåÁõ¥Êé•Áúã‰ª£Á†Å‰∏≠ÁöÑÂá†‰∏™Ê≥®ÈáäÂç≥ÂèØ„ÄÇ 12345678910111213141516171819protected void prepareRefresh() &#123; // ËÆ∞ÂΩïÂêØÂä®Êó∂Èó¥Ôºå // Â∞Ü active Â±ûÊÄßËÆæÁΩÆ‰∏∫ trueÔºåclosed Â±ûÊÄßËÆæÁΩÆ‰∏∫ falseÔºåÂÆÉ‰ª¨ÈÉΩÊòØ AtomicBoolean Á±ªÂûã this.startupDate = System.currentTimeMillis(); this.closed.set(false); this.active.set(true); if (logger.isInfoEnabled()) &#123; logger.info("Refreshing " + this); &#125; // Initialize any placeholder property sources in the context environment initPropertySources(); // Ê†°È™å xml ÈÖçÁΩÆÊñá‰ª∂ getEnvironment().validateRequiredProperties(); this.earlyApplicationEvents = new LinkedHashSet&lt;ApplicationEvent&gt;();&#125; ÂàõÂª∫ Bean ÂÆπÂô®ÔºåÂä†ËΩΩÂπ∂Ê≥®ÂÜå BeanÊàë‰ª¨ÂõûÂà∞ refresh() ÊñπÊ≥ï‰∏≠ÁöÑ‰∏ã‰∏ÄË°å obtainFreshBeanFactory()„ÄÇ Ê≥®ÊÑèÔºåËøô‰∏™ÊñπÊ≥ïÊòØÂÖ®ÊñáÊúÄÈáçË¶ÅÁöÑÈÉ®ÂàÜ‰πã‰∏ÄÔºåËøôÈáåÂ∞Ü‰ºöÂàùÂßãÂåñ BeanFactory„ÄÅÂä†ËΩΩ Bean„ÄÅÊ≥®ÂÜå Bean Á≠âÁ≠â„ÄÇ ÂΩìÁÑ∂ÔºåËøôÊ≠•ÁªìÊùüÂêéÔºåBean Âπ∂Ê≤°ÊúâÂÆåÊàêÂàùÂßãÂåñ„ÄÇËøôÈáåÊåáÁöÑÊòØ Bean ÂÆû‰æãÂπ∂Êú™Âú®Ëøô‰∏ÄÊ≠•ÁîüÊàê„ÄÇ // AbstractApplicationContext.java 1234567891011protected ConfigurableListableBeanFactory obtainFreshBeanFactory() &#123; // ÂÖ≥Èó≠ÊóßÁöÑ BeanFactory (Â¶ÇÊûúÊúâ)ÔºåÂàõÂª∫Êñ∞ÁöÑ BeanFactoryÔºåÂä†ËΩΩ Bean ÂÆö‰πâ„ÄÅÊ≥®ÂÜå Bean Á≠âÁ≠â refreshBeanFactory(); // ËøîÂõûÂàöÂàöÂàõÂª∫ÁöÑ BeanFactory ConfigurableListableBeanFactory beanFactory = getBeanFactory(); if (logger.isDebugEnabled()) &#123; logger.debug("Bean factory for " + getDisplayName() + ": " + beanFactory); &#125; return beanFactory;&#125; // AbstractRefreshableApplicationContext.java 120 1234567891011121314151617181920212223242526272829@Overrideprotected final void refreshBeanFactory() throws BeansException &#123; // Â¶ÇÊûú ApplicationContext ‰∏≠Â∑≤ÁªèÂä†ËΩΩËøá BeanFactory ‰∫ÜÔºåÈîÄÊØÅÊâÄÊúâ BeanÔºåÂÖ≥Èó≠ BeanFactory // Ê≥®ÊÑèÔºåÂ∫îÁî®‰∏≠ BeanFactory Êú¨Êù•Â∞±ÊòØÂèØ‰ª•Â§ö‰∏™ÁöÑÔºåËøôÈáåÂèØ‰∏çÊòØËØ¥Â∫îÁî®ÂÖ®Â±ÄÊòØÂê¶Êúâ BeanFactoryÔºåËÄåÊòØÂΩìÂâç // ApplicationContext ÊòØÂê¶Êúâ BeanFactory if (hasBeanFactory()) &#123; destroyBeans(); closeBeanFactory(); &#125; try &#123; // ÂàùÂßãÂåñ‰∏Ä‰∏™ DefaultListableBeanFactoryÔºå‰∏∫‰ªÄ‰πàÁî®Ëøô‰∏™ÔºåÊàë‰ª¨È©¨‰∏äËØ¥„ÄÇ DefaultListableBeanFactory beanFactory = createBeanFactory(); // Áî®‰∫é BeanFactory ÁöÑÂ∫èÂàóÂåñÔºåÊàëÊÉ≥‰∏çÈÉ®ÂàÜ‰∫∫Â∫îËØ•ÈÉΩÁî®‰∏çÂà∞ beanFactory.setSerializationId(getId()); // ‰∏ãÈù¢Ëøô‰∏§‰∏™ÊñπÊ≥ïÂæàÈáçË¶ÅÔºåÂà´Ë∑ü‰∏¢‰∫ÜÔºåÂÖ∑‰ΩìÁªÜËäÇ‰πãÂêéËØ¥ // ËÆæÁΩÆ BeanFactory ÁöÑ‰∏§‰∏™ÈÖçÁΩÆÂ±ûÊÄßÔºöÊòØÂê¶ÂÖÅËÆ∏ Bean Ë¶ÜÁõñ„ÄÅÊòØÂê¶ÂÖÅËÆ∏Âæ™ÁéØÂºïÁî® customizeBeanFactory(beanFactory); // Âä†ËΩΩ Bean Âà∞ BeanFactory ‰∏≠ loadBeanDefinitions(beanFactory); synchronized (this.beanFactoryMonitor) &#123; this.beanFactory = beanFactory; &#125; &#125; catch (IOException ex) &#123; throw new ApplicationContextException("I/O error parsing bean definition source for " + getDisplayName(), ex); &#125;&#125; ÁúãÂà∞ËøôÈáåÁöÑÊó∂ÂÄôÔºåÊàëËßâÂæóËØªËÄÖÂ∞±Â∫îËØ•Á´ôÂú®È´òÂ§ÑÁúã ApplicationContext ‰∫ÜÔºåApplicationContext ÁªßÊâøËá™ BeanFactoryÔºå‰ΩÜÊòØÂÆÉ‰∏çÂ∫îËØ•Ë¢´ÁêÜËß£‰∏∫ BeanFactory ÁöÑÂÆûÁé∞Á±ªÔºåËÄåÊòØËØ¥ÂÖ∂ÂÜÖÈÉ®ÊåÅÊúâ‰∏Ä‰∏™ÂÆû‰æãÂåñÁöÑ BeanFactoryÔºàDefaultListableBeanFactoryÔºâ„ÄÇ‰ª•ÂêéÊâÄÊúâÁöÑ BeanFactory Áõ∏ÂÖ≥ÁöÑÊìç‰ΩúÂÖ∂ÂÆûÊòØÂßîÊâòÁªôËøô‰∏™ÂÆû‰æãÊù•Â§ÑÁêÜÁöÑ„ÄÇ Êàë‰ª¨ËØ¥ËØ¥‰∏∫‰ªÄ‰πàÈÄâÊã©ÂÆû‰æãÂåñ DefaultListableBeanFactory ÔºüÂâçÈù¢Êàë‰ª¨ËØ¥‰∫ÜÊúâ‰∏™ÂæàÈáçË¶ÅÁöÑÊé•Âè£ ConfigurableListableBeanFactoryÔºåÂÆÉÂÆûÁé∞‰∫Ü BeanFactory ‰∏ãÈù¢‰∏ÄÂ±ÇÁöÑÊâÄÊúâ‰∏â‰∏™Êé•Âè£ÔºåÊàëÊää‰πãÂâçÁöÑÁªßÊâøÂõæÂÜçÊãøËøáÊù•Â§ßÂÆ∂ÂÜç‰ªîÁªÜÁúã‰∏Ä‰∏ãÔºö Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ ConfigurableListableBeanFactory Âè™Êúâ‰∏Ä‰∏™ÂÆûÁé∞Á±ª DefaultListableBeanFactoryÔºåËÄå‰∏îÂÆûÁé∞Á±ª DefaultListableBeanFactory ËøòÈÄöËøáÂÆûÁé∞Âè≥ËæπÁöÑ AbstractAutowireCapableBeanFactory ÈÄöÂêÉ‰∫ÜÂè≥Ë∑Ø„ÄÇÊâÄ‰ª•ÁªìËÆ∫Â∞±ÊòØÔºåÊúÄÂ∫ï‰∏ãËøô‰∏™ÂÆ∂‰ºô DefaultListableBeanFactory Âü∫Êú¨‰∏äÊòØÊúÄÁâõÁöÑ BeanFactory ‰∫ÜÔºåËøô‰πüÊòØ‰∏∫‰ªÄ‰πàËøôËæπ‰ºö‰ΩøÁî®Ëøô‰∏™Á±ªÊù•ÂÆû‰æãÂåñÁöÑÂéüÂõ†„ÄÇ Â¶ÇÊûú‰Ω†ÊÉ≥Ë¶ÅÂú®Á®ãÂ∫èËøêË°åÁöÑÊó∂ÂÄôÂä®ÊÄÅÂæÄ Spring IOC ÂÆπÂô®Ê≥®ÂÜåÊñ∞ÁöÑ beanÔºåÂ∞±‰ºö‰ΩøÁî®Âà∞Ëøô‰∏™Á±ª„ÄÇÈÇ£Êàë‰ª¨ÊÄé‰πàÂú®ËøêË°åÊó∂Ëé∑ÂæóËøô‰∏™ÂÆû‰æãÂë¢Ôºü ‰πãÂâçÊàë‰ª¨ËØ¥Ëøá ApplicationContext Êé•Âè£ËÉΩËé∑ÂèñÂà∞ AutowireCapableBeanFactoryÔºåÂ∞±ÊòØÊúÄÂè≥‰∏äËßíÈÇ£‰∏™ÔºåÁÑ∂ÂêéÂÆÉÂêë‰∏ãËΩ¨ÂûãÂ∞±ËÉΩÂæóÂà∞ DefaultListableBeanFactory ‰∫Ü„ÄÇ Âú®ÁªßÁª≠ÂæÄ‰∏ã‰πãÂâçÔºåÊàë‰ª¨ÈúÄË¶ÅÂÖà‰∫ÜËß£ BeanDefinition„ÄÇÊàë‰ª¨ËØ¥ BeanFactory ÊòØ Bean ÂÆπÂô®ÔºåÈÇ£‰πà Bean ÂèàÊòØ‰ªÄ‰πàÂë¢Ôºü ËøôÈáåÁöÑ BeanDefinition Â∞±ÊòØÊàë‰ª¨ÊâÄËØ¥ÁöÑ Spring ÁöÑ BeanÔºåÊàë‰ª¨Ëá™Â∑±ÂÆö‰πâÁöÑÂêÑ‰∏™ Bean ÂÖ∂ÂÆû‰ºöËΩ¨Êç¢Êàê‰∏Ä‰∏™‰∏™ BeanDefinition Â≠òÂú®‰∫é Spring ÁöÑ BeanFactory ‰∏≠„ÄÇ ÊâÄ‰ª•ÔºåÂ¶ÇÊûúÊúâ‰∫∫ÈóÆ‰Ω† Bean ÊòØ‰ªÄ‰πàÁöÑÊó∂ÂÄôÔºå‰Ω†Ë¶ÅÁü•ÈÅì Bean Âú®‰ª£Á†ÅÂ±ÇÈù¢‰∏äÂèØ‰ª•ËÆ§‰∏∫ÊòØ BeanDefinition ÁöÑÂÆû‰æã„ÄÇ BeanDefinition ‰∏≠‰øùÂ≠ò‰∫ÜÊàë‰ª¨ÁöÑ Bean ‰ø°ÊÅØÔºåÊØîÂ¶ÇËøô‰∏™ Bean ÊåáÂêëÁöÑÊòØÂì™‰∏™Á±ª„ÄÅÊòØÂê¶ÊòØÂçï‰æãÁöÑ„ÄÅÊòØÂê¶ÊáíÂä†ËΩΩ„ÄÅËøô‰∏™ Bean ‰æùËµñ‰∫ÜÂì™‰∫õ Bean Á≠âÁ≠â„ÄÇ BeanDefinition Êé•Âè£ÂÆö‰πâÊàë‰ª¨Êù•Áúã‰∏ã BeanDefinition ÁöÑÊé•Âè£ÂÆö‰πâÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788public interface BeanDefinition extends AttributeAccessor, BeanMetadataElement &#123; // Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÔºåÈªòËÆ§Âè™Êèê‰æõ sington Âíå prototype ‰∏§ÁßçÔºå // ÂæàÂ§öËØªËÄÖÂèØËÉΩÁü•ÈÅìËøòÊúâ request, session, globalSession, application, websocket ËøôÂá†ÁßçÔºå // ‰∏çËøáÔºåÂÆÉ‰ª¨Â±û‰∫éÂü∫‰∫é web ÁöÑÊâ©Â±ï„ÄÇ String SCOPE_SINGLETON = ConfigurableBeanFactory.SCOPE_SINGLETON; String SCOPE_PROTOTYPE = ConfigurableBeanFactory.SCOPE_PROTOTYPE; // ÊØîËæÉ‰∏çÈáçË¶ÅÔºåÁõ¥Êé•Ë∑≥ËøáÂêß int ROLE_APPLICATION = 0; int ROLE_SUPPORT = 1; int ROLE_INFRASTRUCTURE = 2; // ËÆæÁΩÆÁà∂ BeanÔºåËøôÈáåÊ∂âÂèäÂà∞ bean ÁªßÊâøÔºå‰∏çÊòØ java ÁªßÊâø„ÄÇËØ∑ÂèÇËßÅÈôÑÂΩïÁöÑËØ¶ÁªÜ‰ªãÁªç // ‰∏ÄÂè•ËØùÂ∞±ÊòØÔºöÁªßÊâøÁà∂ Bean ÁöÑÈÖçÁΩÆ‰ø°ÊÅØËÄåÂ∑≤ void setParentName(String parentName); // Ëé∑ÂèñÁà∂ Bean String getParentName(); // ËÆæÁΩÆ Bean ÁöÑÁ±ªÂêçÁß∞ÔºåÂ∞ÜÊù•ÊòØË¶ÅÈÄöËøáÂèçÂ∞ÑÊù•ÁîüÊàêÂÆû‰æãÁöÑ void setBeanClassName(String beanClassName); // Ëé∑Âèñ Bean ÁöÑÁ±ªÂêçÁß∞ String getBeanClassName(); // ËÆæÁΩÆ bean ÁöÑ scope void setScope(String scope); String getScope(); // ËÆæÁΩÆÊòØÂê¶ÊáíÂä†ËΩΩ void setLazyInit(boolean lazyInit); boolean isLazyInit(); // ËÆæÁΩÆËØ• Bean ‰æùËµñÁöÑÊâÄÊúâÁöÑ BeanÔºåÊ≥®ÊÑèÔºåËøôÈáåÁöÑ‰æùËµñ‰∏çÊòØÊåáÂ±ûÊÄß‰æùËµñ(Â¶Ç @Autowire Ê†áËÆ∞ÁöÑ)Ôºå // ÊòØ depends-on="" Â±ûÊÄßËÆæÁΩÆÁöÑÂÄº„ÄÇ void setDependsOn(String... dependsOn); // ËøîÂõûËØ• Bean ÁöÑÊâÄÊúâ‰æùËµñ String[] getDependsOn(); // ËÆæÁΩÆËØ• Bean ÊòØÂê¶ÂèØ‰ª•Ê≥®ÂÖ•Âà∞ÂÖ∂‰ªñ Bean ‰∏≠ÔºåÂè™ÂØπÊ†πÊçÆÁ±ªÂûãÊ≥®ÂÖ•ÊúâÊïàÔºå // Â¶ÇÊûúÊ†πÊçÆÂêçÁß∞Ê≥®ÂÖ•ÔºåÂç≥‰ΩøËøôËæπËÆæÁΩÆ‰∫Ü falseÔºå‰πüÊòØÂèØ‰ª•ÁöÑ void setAutowireCandidate(boolean autowireCandidate); // ËØ• Bean ÊòØÂê¶ÂèØ‰ª•Ê≥®ÂÖ•Âà∞ÂÖ∂‰ªñ Bean ‰∏≠ boolean isAutowireCandidate(); // ‰∏ªË¶ÅÁöÑ„ÄÇÂêå‰∏ÄÊé•Âè£ÁöÑÂ§ö‰∏™ÂÆûÁé∞ÔºåÂ¶ÇÊûú‰∏çÊåáÂÆöÂêçÂ≠óÁöÑËØùÔºåSpring ‰ºö‰ºòÂÖàÈÄâÊã©ËÆæÁΩÆ primary ‰∏∫ true ÁöÑ bean void setPrimary(boolean primary); // ÊòØÂê¶ÊòØ primary ÁöÑ boolean isPrimary(); // Â¶ÇÊûúËØ• Bean ÈááÁî®Â∑•ÂéÇÊñπÊ≥ïÁîüÊàêÔºåÊåáÂÆöÂ∑•ÂéÇÂêçÁß∞„ÄÇÂØπÂ∑•ÂéÇ‰∏çÁÜüÊÇâÁöÑËØªËÄÖÔºåËØ∑ÂèÇÂä†ÈôÑÂΩï // ‰∏ÄÂè•ËØùÂ∞±ÊòØÔºöÊúâ‰∫õÂÆû‰æã‰∏çÊòØÁî®ÂèçÂ∞ÑÁîüÊàêÁöÑÔºåËÄåÊòØÁî®Â∑•ÂéÇÊ®°ÂºèÁîüÊàêÁöÑ void setFactoryBeanName(String factoryBeanName); // Ëé∑ÂèñÂ∑•ÂéÇÂêçÁß∞ String getFactoryBeanName(); // ÊåáÂÆöÂ∑•ÂéÇÁ±ª‰∏≠ÁöÑ Â∑•ÂéÇÊñπÊ≥ïÂêçÁß∞ void setFactoryMethodName(String factoryMethodName); // Ëé∑ÂèñÂ∑•ÂéÇÁ±ª‰∏≠ÁöÑ Â∑•ÂéÇÊñπÊ≥ïÂêçÁß∞ String getFactoryMethodName(); // ÊûÑÈÄ†Âô®ÂèÇÊï∞ ConstructorArgumentValues getConstructorArgumentValues(); // Bean ‰∏≠ÁöÑÂ±ûÊÄßÂÄºÔºåÂêéÈù¢Áªô bean Ê≥®ÂÖ•Â±ûÊÄßÂÄºÁöÑÊó∂ÂÄô‰ºöËØ¥Âà∞ MutablePropertyValues getPropertyValues(); // ÊòØÂê¶ singleton boolean isSingleton(); // ÊòØÂê¶ prototype boolean isPrototype(); // Â¶ÇÊûúËøô‰∏™ Bean ÊòØË¢´ËÆæÁΩÆ‰∏∫ abstractÔºåÈÇ£‰πà‰∏çËÉΩÂÆû‰æãÂåñÔºå // Â∏∏Áî®‰∫é‰Ωú‰∏∫ Áà∂bean Áî®‰∫éÁªßÊâøÔºåÂÖ∂ÂÆû‰πüÂæàÂ∞ëÁî®...... boolean isAbstract(); int getRole(); String getDescription(); String getResourceDescription(); BeanDefinition getOriginatingBeanDefinition();&#125; Ëøô‰∏™ BeanDefinition ÂÖ∂ÂÆûÂ∑≤ÁªèÂåÖÂê´ÂæàÂ§öÁöÑ‰ø°ÊÅØ‰∫ÜÔºåÊöÇÊó∂‰∏çÊ∏ÖÊ•öÊâÄÊúâÁöÑÊñπÊ≥ïÂØπÂ∫î‰ªÄ‰πà‰∏úË•øÊ≤°ÂÖ≥Á≥ªÔºåÂ∏åÊúõÁúãÂÆåÊú¨ÊñáÂêéËØªËÄÖÂèØ‰ª•ÂΩªÂ∫ïÊêûÊ∏ÖÊ•öÈáåÈù¢ÁöÑÊâÄÊúâ‰∏úË•ø„ÄÇ ËøôÈáåÊé•Âè£ËôΩÁÑ∂ÈÇ£‰πàÂ§öÔºå‰ΩÜÊòØÊ≤°ÊúâÁ±ª‰ºº getInstance() ËøôÁßçÊñπÊ≥ïÊù•Ëé∑ÂèñÊàë‰ª¨ÂÆö‰πâÁöÑÁ±ªÁöÑÂÆû‰æãÔºåÁúüÊ≠£ÁöÑÊàë‰ª¨ÂÆö‰πâÁöÑÁ±ªÁîüÊàêÁöÑÂÆû‰æãÂà∞Âì™ÈáåÂéª‰∫ÜÂë¢ÔºüÂà´ÁùÄÊÄ•ÔºåËøô‰∏™Ë¶ÅÂæàÂêéÈù¢ÊâçËÉΩËÆ≤Âà∞„ÄÇ Êúâ‰∫Ü BeanDefinition ÁöÑÊ¶ÇÂøµ‰ª•ÂêéÔºåÊàë‰ª¨ÂÜçÂæÄ‰∏ãÁúã refreshBeanFactory() ÊñπÊ≥ï‰∏≠ÁöÑÂâ©‰ΩôÈÉ®ÂàÜÔºö 12customizeBeanFactory(beanFactory);loadBeanDefinitions(beanFactory); ËôΩÁÑ∂Âè™Êúâ‰∏§‰∏™ÊñπÊ≥ïÔºå‰ΩÜË∑ØËøòÂæàÈïøÂïä„ÄÇ„ÄÇ„ÄÇ customizeBeanFactorycustomizeBeanFactory(beanFactory) ÊØîËæÉÁÆÄÂçïÔºåÂ∞±ÊòØÈÖçÁΩÆÊòØÂê¶ÂÖÅËÆ∏ BeanDefinition Ë¶ÜÁõñ„ÄÅÊòØÂê¶ÂÖÅËÆ∏Âæ™ÁéØÂºïÁî®„ÄÇ 12345678910protected void customizeBeanFactory(DefaultListableBeanFactory beanFactory) &#123; if (this.allowBeanDefinitionOverriding != null) &#123; // ÊòØÂê¶ÂÖÅËÆ∏ Bean ÂÆö‰πâË¶ÜÁõñ beanFactory.setAllowBeanDefinitionOverriding(this.allowBeanDefinitionOverriding); &#125; if (this.allowCircularReferences != null) &#123; // ÊòØÂê¶ÂÖÅËÆ∏ Bean Èó¥ÁöÑÂæ™ÁéØ‰æùËµñ beanFactory.setAllowCircularReferences(this.allowCircularReferences); &#125;&#125; BeanDefinition ÁöÑË¶ÜÁõñÈóÆÈ¢òÂèØËÉΩ‰ºöÊúâÂºÄÂèëËÄÖÁ¢∞Âà∞Ëøô‰∏™ÂùëÔºåÂ∞±ÊòØÂú®ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÂÆö‰πâ bean Êó∂‰ΩøÁî®‰∫ÜÁõ∏ÂêåÁöÑ id Êàñ nameÔºåÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåallowBeanDefinitionOverriding Â±ûÊÄß‰∏∫ nullÔºåÂ¶ÇÊûúÂú®Âêå‰∏ÄÈÖçÁΩÆÊñá‰ª∂‰∏≠ÈáçÂ§ç‰∫ÜÔºå‰ºöÊäõÈîôÔºå‰ΩÜÊòØÂ¶ÇÊûú‰∏çÊòØÂêå‰∏ÄÈÖçÁΩÆÊñá‰ª∂‰∏≠Ôºå‰ºöÂèëÁîüË¶ÜÁõñ„ÄÇ Âæ™ÁéØÂºïÁî®‰πüÂæàÂ•ΩÁêÜËß£ÔºöA ‰æùËµñ BÔºåËÄå B ‰æùËµñ A„ÄÇÊàñ A ‰æùËµñ BÔºåB ‰æùËµñ CÔºåËÄå C ‰æùËµñ A„ÄÇ ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåSpring ÂÖÅËÆ∏Âæ™ÁéØ‰æùËµñÔºåÂΩìÁÑ∂Â¶ÇÊûú‰Ω†Âú® A ÁöÑÊûÑÈÄ†ÊñπÊ≥ï‰∏≠‰æùËµñ BÔºåÂú® B ÁöÑÊûÑÈÄ†ÊñπÊ≥ï‰∏≠‰æùËµñ A ÊòØ‰∏çË°åÁöÑ„ÄÇ Ëá≥‰∫éËøô‰∏§‰∏™Â±ûÊÄßÊÄé‰πàÈÖçÁΩÆÔºüÊàëÂú®ÈôÑÂΩï‰∏≠ËøõË°å‰∫Ü‰ªãÁªçÔºåÂ∞§ÂÖ∂ÂØπ‰∫éË¶ÜÁõñÈóÆÈ¢òÔºåÂæàÂ§ö‰∫∫ÈÉΩÂ∏åÊúõÁ¶ÅÊ≠¢Âá∫Áé∞ Bean Ë¶ÜÁõñÔºåÂèØÊòØ Spring ÈªòËÆ§ÊòØ‰∏çÂêåÊñá‰ª∂ÁöÑÊó∂ÂÄôÂèØ‰ª•Ë¶ÜÁõñÁöÑ„ÄÇ ‰πãÂêéÁöÑÊ∫êÁ†Å‰∏≠Ëøò‰ºöÂá∫Áé∞Ëøô‰∏§‰∏™Â±ûÊÄßÔºåËØªËÄÖÊúâ‰∏™Âç∞Ë±°Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ Âä†ËΩΩ Bean: loadBeanDefinitionsÊé•‰∏ãÊù•ÊòØÊúÄÈáçË¶ÅÁöÑ loadBeanDefinitions(beanFactory) ÊñπÊ≥ï‰∫ÜÔºåËøô‰∏™ÊñπÊ≥ïÂ∞ÜÊ†πÊçÆÈÖçÁΩÆÔºåÂä†ËΩΩÂêÑ‰∏™ BeanÔºåÁÑ∂ÂêéÊîæÂà∞ BeanFactory ‰∏≠„ÄÇ ËØªÂèñÈÖçÁΩÆÁöÑÊìç‰ΩúÂú® XmlBeanDefinitionReader ‰∏≠ÔºåÂÖ∂Ë¥üË¥£Âä†ËΩΩÈÖçÁΩÆ„ÄÅËß£Êûê„ÄÇ // AbstractXmlApplicationContext.java 80 123456789101112131415161718/** Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÔºåÊ≠§ÊñπÊ≥ïÂ∞ÜÈÄöËøá‰∏Ä‰∏™ XmlBeanDefinitionReader ÂÆû‰æãÊù•Âä†ËΩΩÂêÑ‰∏™ Bean„ÄÇ*/@Overrideprotected void loadBeanDefinitions(DefaultListableBeanFactory beanFactory) throws BeansException, IOException &#123; // ÁªôËøô‰∏™ BeanFactory ÂÆû‰æãÂåñ‰∏Ä‰∏™ XmlBeanDefinitionReader XmlBeanDefinitionReader beanDefinitionReader = new XmlBeanDefinitionReader(beanFactory); // Configure the bean definition reader with this context's // resource loading environment. beanDefinitionReader.setEnvironment(this.getEnvironment()); beanDefinitionReader.setResourceLoader(this); beanDefinitionReader.setEntityResolver(new ResourceEntityResolver(this)); // ÂàùÂßãÂåñ BeanDefinitionReaderÔºåÂÖ∂ÂÆûËøô‰∏™ÊòØÊèê‰æõÁªôÂ≠êÁ±ªË¶ÜÂÜôÁöÑÔºå // ÊàëÁúã‰∫Ü‰∏Ä‰∏ãÔºåÊ≤°ÊúâÁ±ªË¶ÜÂÜôËøô‰∏™ÊñπÊ≥ïÔºåÊàë‰ª¨Âßë‰∏îÂΩìÂÅö‰∏çÈáçË¶ÅÂêß initBeanDefinitionReader(beanDefinitionReader); // ÈáçÁÇπÊù•‰∫ÜÔºåÁªßÁª≠ÂæÄ‰∏ã loadBeanDefinitions(beanDefinitionReader);&#125; Áé∞Âú®ËøòÂú®Ëøô‰∏™Á±ª‰∏≠ÔºåÊé•‰∏ãÊù•Áî®ÂàöÂàöÂàùÂßãÂåñÁöÑ Reader ÂºÄÂßãÊù•Âä†ËΩΩ xml ÈÖçÁΩÆÔºåËøôÂùó‰ª£Á†ÅËØªËÄÖÂèØ‰ª•ÈÄâÊã©ÊÄßË∑≥ËøáÔºå‰∏çÊòØÂæàÈáçË¶Å„ÄÇ‰πüÂ∞±ÊòØËØ¥Ôºå‰∏ãÈù¢Ëøô‰∏™‰ª£Á†ÅÂùóÔºåËØªËÄÖÂèØ‰ª•ÂæàËΩªÊùæÂú∞Áï•Ëøá„ÄÇ // AbstractXmlApplicationContext.java 120 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104protected void loadBeanDefinitions(XmlBeanDefinitionReader reader) throws BeansException, IOException &#123; Resource[] configResources = getConfigResources(); if (configResources != null) &#123; // ÂæÄ‰∏ãÁúã reader.loadBeanDefinitions(configResources); &#125; String[] configLocations = getConfigLocations(); if (configLocations != null) &#123; // 2 reader.loadBeanDefinitions(configLocations); &#125;&#125;// ‰∏äÈù¢ËôΩÁÑ∂Êúâ‰∏§‰∏™ÂàÜÊîØÔºå‰∏çËøáÁ¨¨‰∫å‰∏™ÂàÜÊîØÂæàÂø´ÈÄöËøáËß£ÊûêË∑ØÂæÑËΩ¨Êç¢‰∏∫ Resource ‰ª•Âêé‰πü‰ºöËøõÂà∞ËøôÈáå@Overridepublic int loadBeanDefinitions(Resource... resources) throws BeanDefinitionStoreException &#123; Assert.notNull(resources, "Resource array must not be null"); int counter = 0; // Ê≥®ÊÑèËøôÈáåÊòØ‰∏™ for Âæ™ÁéØÔºå‰πüÂ∞±ÊòØÊØè‰∏™Êñá‰ª∂ÊòØ‰∏Ä‰∏™ resource for (Resource resource : resources) &#123; // ÁªßÁª≠ÂæÄ‰∏ãÁúã counter += loadBeanDefinitions(resource); &#125; // ÊúÄÂêéËøîÂõû counterÔºåË°®Á§∫ÊÄªÂÖ±Âä†ËΩΩ‰∫ÜÂ§öÂ∞ëÁöÑ BeanDefinition return counter;&#125;// XmlBeanDefinitionReader 303@Overridepublic int loadBeanDefinitions(Resource resource) throws BeanDefinitionStoreException &#123; return loadBeanDefinitions(new EncodedResource(resource));&#125;// XmlBeanDefinitionReader 314public int loadBeanDefinitions(EncodedResource encodedResource) throws BeanDefinitionStoreException &#123; Assert.notNull(encodedResource, "EncodedResource must not be null"); if (logger.isInfoEnabled()) &#123; logger.info("Loading XML bean definitions from " + encodedResource.getResource()); &#125; // Áî®‰∏Ä‰∏™ ThreadLocal Êù•Â≠òÊîæÈÖçÁΩÆÊñá‰ª∂ËµÑÊ∫ê Set&lt;EncodedResource&gt; currentResources = this.resourcesCurrentlyBeingLoaded.get(); if (currentResources == null) &#123; currentResources = new HashSet&lt;EncodedResource&gt;(4); this.resourcesCurrentlyBeingLoaded.set(currentResources); &#125; if (!currentResources.add(encodedResource)) &#123; throw new BeanDefinitionStoreException( "Detected cyclic loading of " + encodedResource + " - check your import definitions!"); &#125; try &#123; InputStream inputStream = encodedResource.getResource().getInputStream(); try &#123; InputSource inputSource = new InputSource(inputStream); if (encodedResource.getEncoding() != null) &#123; inputSource.setEncoding(encodedResource.getEncoding()); &#125; // Ê†∏ÂøÉÈÉ®ÂàÜÊòØËøôÈáåÔºåÂæÄ‰∏ãÈù¢Áúã return doLoadBeanDefinitions(inputSource, encodedResource.getResource()); &#125; finally &#123; inputStream.close(); &#125; &#125; catch (IOException ex) &#123; throw new BeanDefinitionStoreException( "IOException parsing XML document from " + encodedResource.getResource(), ex); &#125; finally &#123; currentResources.remove(encodedResource); if (currentResources.isEmpty()) &#123; this.resourcesCurrentlyBeingLoaded.remove(); &#125; &#125;&#125;// ËøòÂú®Ëøô‰∏™Êñá‰ª∂‰∏≠ÔºåÁ¨¨ 388 Ë°åprotected int doLoadBeanDefinitions(InputSource inputSource, Resource resource) throws BeanDefinitionStoreException &#123; try &#123; // ËøôÈáåÂ∞±‰∏çÁúã‰∫ÜÔºåÂ∞Ü xml Êñá‰ª∂ËΩ¨Êç¢‰∏∫ Document ÂØπË±° Document doc = doLoadDocument(inputSource, resource); // ÁªßÁª≠ return registerBeanDefinitions(doc, resource); &#125; catch (...&#125;// ËøòÂú®Ëøô‰∏™Êñá‰ª∂‰∏≠ÔºåÁ¨¨ 505 Ë°å// ËøîÂõûÂÄºÔºöËøîÂõû‰ªéÂΩìÂâçÈÖçÁΩÆÊñá‰ª∂Âä†ËΩΩ‰∫ÜÂ§öÂ∞ëÊï∞ÈáèÁöÑ Beanpublic int registerBeanDefinitions(Document doc, Resource resource) throws BeanDefinitionStoreException &#123; BeanDefinitionDocumentReader documentReader = createBeanDefinitionDocumentReader(); int countBefore = getRegistry().getBeanDefinitionCount(); // ËøôÈáå documentReader.registerBeanDefinitions(doc, createReaderContext(resource)); return getRegistry().getBeanDefinitionCount() - countBefore;&#125;// DefaultBeanDefinitionDocumentReader 90@Overridepublic void registerBeanDefinitions(Document doc, XmlReaderContext readerContext) &#123; this.readerContext = readerContext; logger.debug("Loading bean definitions"); Element root = doc.getDocumentElement(); // ‰ªé xml Ê†πËäÇÁÇπÂºÄÂßãËß£ÊûêÊñá‰ª∂ doRegisterBeanDefinitions(root);&#125; ÁªèËøáÊº´ÈïøÁöÑÈìæË∑ØÔºå‰∏Ä‰∏™ÈÖçÁΩÆÊñá‰ª∂Áªà‰∫éËΩ¨Êç¢‰∏∫‰∏ÄÈ¢ó DOM Ê†ë‰∫ÜÔºåÊ≥®ÊÑèÔºåËøôÈáåÊåáÁöÑÊòØÂÖ∂‰∏≠‰∏Ä‰∏™ÈÖçÁΩÆÊñá‰ª∂Ôºå‰∏çÊòØÊâÄÊúâÁöÑÔºåËØªËÄÖÂèØ‰ª•ÁúãÂà∞‰∏äÈù¢Êúâ‰∏™ for Âæ™ÁéØÁöÑ„ÄÇ‰∏ãÈù¢ÂºÄÂßã‰ªéÊ†πËäÇÁÇπÂºÄÂßãËß£ÊûêÔºö doRegisterBeanDefinitionsÔºö123456789101112131415161718192021222324252627282930313233// DefaultBeanDefinitionDocumentReader 116protected void doRegisterBeanDefinitions(Element root) &#123; // Êàë‰ª¨ÁúãÂêçÂ≠óÂ∞±Áü•ÈÅìÔºåBeanDefinitionParserDelegate ÂøÖÂÆöÊòØ‰∏Ä‰∏™ÈáçË¶ÅÁöÑÁ±ªÔºåÂÆÉË¥üË¥£Ëß£Êûê Bean ÂÆö‰πâÔºå // ËøôÈáå‰∏∫‰ªÄ‰πàË¶ÅÂÆö‰πâ‰∏Ä‰∏™ parent? ÁúãÂà∞ÂêéÈù¢Â∞±Áü•ÈÅì‰∫ÜÔºåÊòØÈÄíÂΩíÈóÆÈ¢òÔºå // Âõ†‰∏∫ &lt;beans /&gt; ÂÜÖÈÉ®ÊòØÂèØ‰ª•ÂÆö‰πâ &lt;beans /&gt; ÁöÑÔºåÊâÄ‰ª•Ëøô‰∏™ÊñπÊ≥ïÁöÑ root ÂÖ∂ÂÆû‰∏ç‰∏ÄÂÆöÂ∞±ÊòØ xml ÁöÑÊ†πËäÇÁÇπÔºå‰πüÂèØ‰ª•ÊòØÂµåÂ•óÂú®ÈáåÈù¢ÁöÑ &lt;beans /&gt; ËäÇÁÇπÔºå‰ªéÊ∫êÁ†ÅÂàÜÊûêÁöÑËßíÂ∫¶ÔºåÊàë‰ª¨ÂΩìÂÅöÊ†πËäÇÁÇπÂ∞±Â•Ω‰∫Ü BeanDefinitionParserDelegate parent = this.delegate; this.delegate = createDelegate(getReaderContext(), root, parent); if (this.delegate.isDefaultNamespace(root)) &#123; // ËøôÂùóËØ¥ÁöÑÊòØÊ†πËäÇÁÇπ &lt;beans ... profile="dev" /&gt; ‰∏≠ÁöÑ profile ÊòØÂê¶ÊòØÂΩìÂâçÁéØÂ¢ÉÈúÄË¶ÅÁöÑÔºå // Â¶ÇÊûúÂΩìÂâçÁéØÂ¢ÉÈÖçÁΩÆÁöÑ profile ‰∏çÂåÖÂê´Ê≠§ profileÔºåÈÇ£Â∞±Áõ¥Êé• return ‰∫ÜÔºå‰∏çÂØπÊ≠§ &lt;beans /&gt; Ëß£Êûê // ‰∏çÁÜüÊÇâ profile ‰∏∫‰ΩïÁâ©Ôºå‰∏çÁÜüÊÇâÊÄé‰πàÈÖçÁΩÆ profile ËØªËÄÖÁöÑËØ∑ÁßªÊ≠•ÈôÑÂΩïÂå∫ String profileSpec = root.getAttribute(PROFILE_ATTRIBUTE); if (StringUtils.hasText(profileSpec)) &#123; String[] specifiedProfiles = StringUtils.tokenizeToStringArray( profileSpec, BeanDefinitionParserDelegate.MULTI_VALUE_ATTRIBUTE_DELIMITERS); if (!getReaderContext().getEnvironment().acceptsProfiles(specifiedProfiles)) &#123; if (logger.isInfoEnabled()) &#123; logger.info("Skipped XML bean definition file due to specified profiles [" + profileSpec + "] not matching: " + getReaderContext().getResource()); &#125; return; &#125; &#125; &#125; preProcessXml(root); // Èí©Â≠ê // ÂæÄ‰∏ãÁúã parseBeanDefinitions(root, this.delegate); postProcessXml(root); // Èí©Â≠ê this.delegate = parent;&#125; preProcessXml(root) Âíå postProcessXml(root) ÊòØÁªôÂ≠êÁ±ªÁî®ÁöÑÈí©Â≠êÊñπÊ≥ïÔºåÈâ¥‰∫éÊ≤°ÊúâË¢´‰ΩøÁî®Âà∞Ôºå‰πü‰∏çÊòØÊàë‰ª¨ÁöÑÈáçÁÇπÔºåÊàë‰ª¨Áõ¥Êé•Ë∑≥Ëøá„ÄÇ ËøôÈáåÊ∂âÂèäÂà∞‰∫Ü profile ÁöÑÈóÆÈ¢òÔºåÂØπ‰∫é‰∏ç‰∫ÜËß£ÁöÑËØªËÄÖÔºåÊàëÂú®ÈôÑÂΩï‰∏≠ÂØπ profile ÂÅö‰∫ÜÁÆÄÂçïÁöÑËß£ÈáäÔºåËØªËÄÖÂèØ‰ª•ÂèÇËÄÉ‰∏Ä‰∏ã„ÄÇ Êé•‰∏ãÊù•ÔºåÁúãÊ†∏ÂøÉËß£ÊûêÊñπÊ≥ï parseBeanDefinitions(root, this.delegate) : 123456789101112131415161718192021222324// default namespace Ê∂âÂèäÂà∞ÁöÑÂ∞±Âõõ‰∏™Ê†áÁ≠æ &lt;import /&gt;„ÄÅ&lt;alias /&gt;„ÄÅ&lt;bean /&gt; Âíå &lt;beans /&gt;Ôºå// ÂÖ∂‰ªñÁöÑÂ±û‰∫é custom ÁöÑprotected void parseBeanDefinitions(Element root, BeanDefinitionParserDelegate delegate) &#123; if (delegate.isDefaultNamespace(root)) &#123; NodeList nl = root.getChildNodes(); for (int i = 0; i &lt; nl.getLength(); i++) &#123; Node node = nl.item(i); if (node instanceof Element) &#123; Element ele = (Element) node; if (delegate.isDefaultNamespace(ele)) &#123; // Ëß£Êûê default namespace ‰∏ãÈù¢ÁöÑÂá†‰∏™ÂÖÉÁ¥† parseDefaultElement(ele, delegate); &#125; else &#123; // Ëß£ÊûêÂÖ∂‰ªñ namespace ÁöÑÂÖÉÁ¥† delegate.parseCustomElement(ele); &#125; &#125; &#125; &#125; else &#123; delegate.parseCustomElement(root); &#125;&#125; ‰ªé‰∏äÈù¢ÁöÑ‰ª£Á†ÅÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÔºåÂØπ‰∫éÊØè‰∏™ÈÖçÁΩÆÊù•ËØ¥ÔºåÂàÜÂà´ËøõÂÖ•Âà∞ parseDefaultElement(ele, delegate); Âíå delegate.parseCustomElement(ele); Ëøô‰∏§‰∏™ÂàÜÊîØ‰∫Ü„ÄÇ parseDefaultElement(ele, delegate) ‰ª£Ë°®Ëß£ÊûêÁöÑËäÇÁÇπÊòØ &lt;import /&gt;„ÄÅ&lt;alias /&gt;„ÄÅ&lt;bean /&gt;„ÄÅ&lt;beans /&gt; ËøôÂá†‰∏™„ÄÇ ËøôÈáåÁöÑÂõõ‰∏™Ê†áÁ≠æ‰πãÊâÄ‰ª•ÊòØ default ÁöÑÔºåÊòØÂõ†‰∏∫ÂÆÉ‰ª¨ÊòØÂ§Ñ‰∫éËøô‰∏™ namespace ‰∏ãÂÆö‰πâÁöÑÔºö 12&gt; http://www.springframework.org/schema/beans&gt; ÂèàÂà∞ÂàùÂ≠¶ËÄÖÁßëÊôÆÊó∂Èó¥Ôºå‰∏çÁÜüÊÇâ namespace ÁöÑËØªËÄÖËØ∑Áúã‰∏ãÈù¢Ë¥¥Âá∫Êù•ÁöÑ xmlÔºåËøôÈáåÁöÑÁ¨¨‰∫åË°å xmlns Â∞±ÊòØÂíØ„ÄÇ 1234567&gt; &lt;beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt; xmlns="http://www.springframework.org/schema/beans"&gt; xsi:schemaLocation="&gt; http://www.springframework.org/schema/beans&gt; http://www.springframework.org/schema/beans/spring-beans.xsd"&gt; default-autowire="byName"&gt;&gt; ËÄåÂØπ‰∫éÂÖ∂‰ªñÁöÑÊ†áÁ≠æÔºåÂ∞ÜËøõÂÖ•Âà∞ delegate.parseCustomElement(element) Ëøô‰∏™ÂàÜÊîØ„ÄÇÂ¶ÇÊàë‰ª¨ÁªèÂ∏∏‰ºö‰ΩøÁî®Âà∞ÁöÑ &lt;mvc /&gt;„ÄÅ&lt;task /&gt;„ÄÅ&lt;context /&gt;„ÄÅ&lt;aop /&gt;Á≠â„ÄÇ Ëøô‰∫õÂ±û‰∫éÊâ©Â±ïÔºåÂ¶ÇÊûúÈúÄË¶Å‰ΩøÁî®‰∏äÈù¢Ëøô‰∫õ ‚ÄùÈùû default‚Äú Ê†áÁ≠æÔºåÈÇ£‰πà‰∏äÈù¢ÁöÑ xml Â§¥ÈÉ®ÁöÑÂú∞Êñπ‰πüË¶ÅÂºïÂÖ•Áõ∏Â∫îÁöÑ namespace Âíå .xsd Êñá‰ª∂ÁöÑË∑ØÂæÑÔºåÂ¶Ç‰∏ãÊâÄÁ§∫„ÄÇÂêåÊó∂‰ª£Á†Å‰∏≠ÈúÄË¶ÅÊèê‰æõÁõ∏Â∫îÁöÑ parser Êù•Ëß£ÊûêÔºåÂ¶Ç MvcNamespaceHandler„ÄÅTaskNamespaceHandler„ÄÅContextNamespaceHandler„ÄÅAopNamespaceHandler Á≠â„ÄÇ ÂÅáÂ¶ÇËØªËÄÖÊÉ≥ÂàÜÊûê &lt;context:property-placeholder location=&quot;classpath:xx.properties&quot; /&gt; ÁöÑÂÆûÁé∞ÂéüÁêÜÔºåÂ∞±Â∫îËØ•Âà∞ ContextNamespaceHandler ‰∏≠ÊâæÁ≠îÊ°à„ÄÇ 1234567891011121314&gt; &lt;beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt; xmlns="http://www.springframework.org/schema/beans"&gt; xmlns:context="http://www.springframework.org/schema/context"&gt; xmlns:mvc="http://www.springframework.org/schema/mvc"&gt; xsi:schemaLocation="&gt; http://www.springframework.org/schema/beans &gt; http://www.springframework.org/schema/beans/spring-beans.xsd&gt; http://www.springframework.org/schema/context&gt; http://www.springframework.org/schema/context/spring-context.xsd&gt; http://www.springframework.org/schema/mvc &gt; http://www.springframework.org/schema/mvc/spring-mvc.xsd &gt; "&gt; default-autowire="byName"&gt;&gt; ÂõûËøáÁ•ûÊù•ÔºåÁúãÁúãÂ§ÑÁêÜ default Ê†áÁ≠æÁöÑÊñπÊ≥ïÔºö 12345678910111213141516171819private void parseDefaultElement(Element ele, BeanDefinitionParserDelegate delegate) &#123; if (delegate.nodeNameEquals(ele, IMPORT_ELEMENT)) &#123; // Â§ÑÁêÜ &lt;import /&gt; Ê†áÁ≠æ importBeanDefinitionResource(ele); &#125; else if (delegate.nodeNameEquals(ele, ALIAS_ELEMENT)) &#123; // Â§ÑÁêÜ &lt;alias /&gt; Ê†áÁ≠æÂÆö‰πâ // &lt;alias name="fromName" alias="toName"/&gt; processAliasRegistration(ele); &#125; else if (delegate.nodeNameEquals(ele, BEAN_ELEMENT)) &#123; // Â§ÑÁêÜ &lt;bean /&gt; Ê†áÁ≠æÂÆö‰πâÔºåËøô‰πüÁÆóÊòØÊàë‰ª¨ÁöÑÈáçÁÇπÂêß processBeanDefinition(ele, delegate); &#125; else if (delegate.nodeNameEquals(ele, NESTED_BEANS_ELEMENT)) &#123; // Â¶ÇÊûúÁ¢∞Âà∞ÁöÑÊòØÂµåÂ•óÁöÑ &lt;beans /&gt; Ê†áÁ≠æÔºåÈúÄË¶ÅÈÄíÂΩí doRegisterBeanDefinitions(ele); &#125;&#125; Â¶ÇÊûúÊØè‰∏™Ê†áÁ≠æÈÉΩËØ¥ÔºåÈÇ£Êàë‰∏çÂêêË°ÄÔºå‰Ω†‰ª¨ÈÉΩË¶ÅÂêêË°Ä‰∫Ü„ÄÇÊàë‰ª¨ÊåëÊàë‰ª¨ÁöÑÈáçÁÇπ &lt;bean /&gt; Ê†áÁ≠æÂá∫Êù•ËØ¥„ÄÇ processBeanDefinition Ëß£Êûê bean Ê†áÁ≠æ‰∏ãÈù¢ÊòØ processBeanDefinition Ëß£Êûê &lt;bean /&gt; Ê†áÁ≠æÔºö // DefaultBeanDefinitionDocumentReader 298 1234567891011121314151617181920protected void processBeanDefinition(Element ele, BeanDefinitionParserDelegate delegate) &#123; // Â∞Ü &lt;bean /&gt; ËäÇÁÇπ‰∏≠ÁöÑ‰ø°ÊÅØÊèêÂèñÂá∫Êù•ÔºåÁÑ∂ÂêéÂ∞ÅË£ÖÂà∞‰∏Ä‰∏™ BeanDefinitionHolder ‰∏≠ÔºåÁªÜËäÇÂæÄ‰∏ãÁúã BeanDefinitionHolder bdHolder = delegate.parseBeanDefinitionElement(ele); // ‰∏ãÈù¢ÁöÑÂá†Ë°åÂÖà‰∏çË¶ÅÁúãÔºåË∑≥ËøáÂÖàÔºåË∑≥ËøáÂÖàÔºåË∑≥ËøáÂÖàÔºåÂêéÈù¢‰ºöÁªßÁª≠ËØ¥ÁöÑ if (bdHolder != null) &#123; bdHolder = delegate.decorateBeanDefinitionIfRequired(ele, bdHolder); try &#123; // Register the final decorated instance. BeanDefinitionReaderUtils.registerBeanDefinition(bdHolder, getReaderContext().getRegistry()); &#125; catch (BeanDefinitionStoreException ex) &#123; getReaderContext().error("Failed to register bean definition with name '" + bdHolder.getBeanName() + "'", ele, ex); &#125; // Send registration event. getReaderContext().fireComponentRegistered(new BeanComponentDefinition(bdHolder)); &#125;&#125; ÁªßÁª≠ÂæÄ‰∏ãÁúãÊÄé‰πàËß£Êûê‰πãÂâçÔºåÊàë‰ª¨ÂÖàÁúã‰∏ã &lt;bean /&gt; Ê†áÁ≠æ‰∏≠ÂèØ‰ª•ÂÆö‰πâÂì™‰∫õÂ±ûÊÄßÔºö Property class Á±ªÁöÑÂÖ®ÈôêÂÆöÂêç name ÂèØÊåáÂÆö id„ÄÅname(Áî®ÈÄóÂè∑„ÄÅÂàÜÂè∑„ÄÅÁ©∫Ê†ºÂàÜÈöî) scope ‰ΩúÁî®Âüü constructor arguments ÊåáÂÆöÊûÑÈÄ†ÂèÇÊï∞ properties ËÆæÁΩÆÂ±ûÊÄßÁöÑÂÄº autowiring mode no(ÈªòËÆ§ÂÄº)„ÄÅbyName„ÄÅbyType„ÄÅ constructor lazy-initialization mode ÊòØÂê¶ÊáíÂä†ËΩΩ(Â¶ÇÊûúË¢´ÈùûÊáíÂä†ËΩΩÁöÑbean‰æùËµñ‰∫ÜÈÇ£‰πàÂÖ∂ÂÆû‰πüÂ∞±‰∏çËÉΩÊáíÂä†ËΩΩ‰∫Ü) initialization method bean Â±ûÊÄßËÆæÁΩÆÂÆåÊàêÂêéÔºå‰ºöË∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ï destruction method bean ÈîÄÊØÅÂêéÁöÑÂõûË∞ÉÊñπÊ≥ï ‰∏äÈù¢Ë°®Ê†º‰∏≠ÁöÑÂÜÖÂÆπÊàëÊÉ≥Â§ßÂÆ∂ÈÉΩÈùûÂ∏∏ÁÜüÊÇâÂêßÔºåÂ¶ÇÊûú‰∏çÁÜüÊÇâÔºåÈÇ£Â∞±ÊòØ‰Ω†‰∏çÂ§ü‰∫ÜËß£ Spring ÁöÑÈÖçÁΩÆ‰∫Ü„ÄÇ ÁÆÄÂçïÂú∞ËØ¥Â∞±ÊòØÂÉè‰∏ãÈù¢ËøôÊ†∑Â≠êÔºö 123456789101112131415&lt;bean id="exampleBean" name="name1, name2, name3" class="com.javadoop.ExampleBean" scope="singleton" lazy-init="true" init-method="init" destroy-method="cleanup"&gt; &lt;!-- ÂèØ‰ª•Áî®‰∏ãÈù¢‰∏âÁßçÂΩ¢ÂºèÊåáÂÆöÊûÑÈÄ†ÂèÇÊï∞ --&gt; &lt;constructor-arg type="int" value="7500000"/&gt; &lt;constructor-arg name="years" value="7500000"/&gt; &lt;constructor-arg index="0" value="7500000"/&gt; &lt;!-- property ÁöÑÂá†ÁßçÊÉÖÂÜµ --&gt; &lt;property name="beanOne"&gt; &lt;ref bean="anotherExampleBean"/&gt; &lt;/property&gt; &lt;property name="beanTwo" ref="yetAnotherBean"/&gt; &lt;property name="integerProperty" value="1"/&gt;&lt;/bean&gt; ÂΩìÁÑ∂ÔºåÈô§‰∫Ü‰∏äÈù¢‰∏æ‰æãÂá∫Êù•ÁöÑËøô‰∫õÔºåËøòÊúâ factory-bean„ÄÅfactory-method„ÄÅ&lt;lockup-method /&gt;„ÄÅ&lt;replaced-method /&gt;„ÄÅ&lt;meta /&gt;„ÄÅ&lt;qualifier /&gt; ËøôÂá†‰∏™ÔºåÂ§ßÂÆ∂ÊòØ‰∏çÊòØÁÜüÊÇâÂë¢ÔºüËá™Â∑±Ê£ÄÈ™å‰∏Ä‰∏ãËá™Â∑±ÂØπ Spring ‰∏≠ bean ÁöÑ‰∫ÜËß£Á®ãÂ∫¶„ÄÇ Êúâ‰∫Ü‰ª•‰∏äËøô‰∫õÁü•ËØÜ‰ª•ÂêéÔºåÊàë‰ª¨ÂÜçÁªßÁª≠ÂæÄÈáåÁúãÊÄé‰πàËß£Êûê bean ÂÖÉÁ¥†ÔºåÊòØÊÄé‰πàËΩ¨Êç¢Âà∞ BeanDefinitionHolder ÁöÑ„ÄÇ // BeanDefinitionParserDelegate 428 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778public BeanDefinitionHolder parseBeanDefinitionElement(Element ele) &#123; return parseBeanDefinitionElement(ele, null);&#125;public BeanDefinitionHolder parseBeanDefinitionElement(Element ele, BeanDefinition containingBean) &#123; String id = ele.getAttribute(ID_ATTRIBUTE); String nameAttr = ele.getAttribute(NAME_ATTRIBUTE); List&lt;String&gt; aliases = new ArrayList&lt;String&gt;(); // Â∞Ü name Â±ûÊÄßÁöÑÂÆö‰πâÊåâÁÖß ‚ÄúÈÄóÂè∑„ÄÅÂàÜÂè∑„ÄÅÁ©∫Ê†º‚Äù ÂàáÂàÜÔºåÂΩ¢Êàê‰∏Ä‰∏™ Âà´ÂêçÂàóË°®Êï∞ÁªÑÔºå // ÂΩìÁÑ∂ÔºåÂ¶ÇÊûú‰Ω†‰∏çÂÆö‰πâ name Â±ûÊÄßÁöÑËØùÔºåÂ∞±ÊòØÁ©∫ÁöÑ‰∫Ü // ÊàëÂú®ÈôÑÂΩï‰∏≠ÁÆÄÂçï‰ªãÁªç‰∫Ü‰∏Ä‰∏ã id Âíå name ÁöÑÈÖçÁΩÆÔºåÂ§ßÂÆ∂ÂèØ‰ª•Áúã‰∏ÄÁúºÔºåÊúâ‰∏™20ÁßíÂ∞±ÂèØ‰ª•‰∫Ü if (StringUtils.hasLength(nameAttr)) &#123; String[] nameArr = StringUtils.tokenizeToStringArray(nameAttr, MULTI_VALUE_ATTRIBUTE_DELIMITERS); aliases.addAll(Arrays.asList(nameArr)); &#125; String beanName = id; // Â¶ÇÊûúÊ≤°ÊúâÊåáÂÆöid, ÈÇ£‰πàÁî®Âà´ÂêçÂàóË°®ÁöÑÁ¨¨‰∏Ä‰∏™ÂêçÂ≠ó‰Ωú‰∏∫beanName if (!StringUtils.hasText(beanName) &amp;&amp; !aliases.isEmpty()) &#123; beanName = aliases.remove(0); if (logger.isDebugEnabled()) &#123; logger.debug("No XML 'id' specified - using '" + beanName + "' as bean name and " + aliases + " as aliases"); &#125; &#125; if (containingBean == null) &#123; checkNameUniqueness(beanName, aliases, ele); &#125; // Ê†πÊçÆ &lt;bean ...&gt;...&lt;/bean&gt; ‰∏≠ÁöÑÈÖçÁΩÆÂàõÂª∫ BeanDefinitionÔºåÁÑ∂ÂêéÊääÈÖçÁΩÆ‰∏≠ÁöÑ‰ø°ÊÅØÈÉΩËÆæÁΩÆÂà∞ÂÆû‰æã‰∏≠, // ÁªÜËäÇÂêéÈù¢ÁªÜËØ¥ÔºåÂÖàÁü•ÈÅì‰∏ãÈù¢ËøôË°åÁªìÊùüÂêéÔºå‰∏Ä‰∏™ BeanDefinition ÂÆû‰æãÂ∞±Âá∫Êù•‰∫Ü„ÄÇ AbstractBeanDefinition beanDefinition = parseBeanDefinitionElement(ele, beanName, containingBean); // Âà∞ËøôÈáåÔºåÊï¥‰∏™ &lt;bean /&gt; Ê†áÁ≠æÂ∞±ÁÆóËß£ÊûêÁªìÊùü‰∫ÜÔºå‰∏Ä‰∏™ BeanDefinition Â∞±ÂΩ¢Êàê‰∫Ü„ÄÇ if (beanDefinition != null) &#123; // Â¶ÇÊûúÈÉΩÊ≤°ÊúâËÆæÁΩÆ id Âíå nameÔºåÈÇ£‰πàÊ≠§Êó∂ÁöÑ beanName Â∞±‰ºö‰∏∫ nullÔºåËøõÂÖ•‰∏ãÈù¢ËøôÂùó‰ª£Á†Å‰∫ßÁîü // Â¶ÇÊûúËØªËÄÖ‰∏çÊÑüÂÖ¥Ë∂£ÁöÑËØùÔºåÊàëËßâÂæó‰∏çÈúÄË¶ÅÂÖ≥ÂøÉËøôÂùó‰ª£Á†ÅÔºåÂØπÊú¨ÊñáÊ∫êÁ†ÅÂàÜÊûêÊù•ËØ¥ÔºåËøô‰∫õ‰∏úË•ø‰∏çÈáçË¶Å if (!StringUtils.hasText(beanName)) &#123; try &#123; if (containingBean != null) &#123;// ÊåâÁÖßÊàë‰ª¨ÁöÑÊÄùË∑ØÔºåËøôÈáå containingBean ÊòØ null ÁöÑ beanName = BeanDefinitionReaderUtils.generateBeanName( beanDefinition, this.readerContext.getRegistry(), true); &#125; else &#123; // Â¶ÇÊûúÊàë‰ª¨‰∏çÂÆö‰πâ id Âíå nameÔºåÈÇ£‰πàÊàë‰ª¨ÂºïË®ÄÈáåÁöÑÈÇ£‰∏™‰æãÂ≠êÔºö // 1. beanName ‰∏∫Ôºöcom.javadoop.example.MessageServiceImpl#0 // 2. beanClassName ‰∏∫Ôºöcom.javadoop.example.MessageServiceImpl beanName = this.readerContext.generateBeanName(beanDefinition); String beanClassName = beanDefinition.getBeanClassName(); if (beanClassName != null &amp;&amp; beanName.startsWith(beanClassName) &amp;&amp; beanName.length() &gt; beanClassName.length() &amp;&amp; !this.readerContext.getRegistry().isBeanNameInUse(beanClassName)) &#123; // Êää beanClassName ËÆæÁΩÆ‰∏∫ Bean ÁöÑÂà´Âêç aliases.add(beanClassName); &#125; &#125; if (logger.isDebugEnabled()) &#123; logger.debug("Neither XML 'id' nor 'name' specified - " + "using generated bean name [" + beanName + "]"); &#125; &#125; catch (Exception ex) &#123; error(ex.getMessage(), ele); return null; &#125; &#125; String[] aliasesArray = StringUtils.toStringArray(aliases); // ËøîÂõû BeanDefinitionHolder return new BeanDefinitionHolder(beanDefinition, beanName, aliasesArray); &#125; return null;&#125; ÁÑ∂ÂêéÔºåÊàë‰ª¨ÂÜçÁúãÁúãÊÄé‰πàÊ†πÊçÆÈÖçÁΩÆÂàõÂª∫ BeanDefinition ÂÆû‰æãÁöÑÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960public AbstractBeanDefinition parseBeanDefinitionElement( Element ele, String beanName, BeanDefinition containingBean) &#123; this.parseState.push(new BeanEntry(beanName)); String className = null; if (ele.hasAttribute(CLASS_ATTRIBUTE)) &#123; className = ele.getAttribute(CLASS_ATTRIBUTE).trim(); &#125; try &#123; String parent = null; if (ele.hasAttribute(PARENT_ATTRIBUTE)) &#123; parent = ele.getAttribute(PARENT_ATTRIBUTE); &#125; // ÂàõÂª∫ BeanDefinitionÔºåÁÑ∂ÂêéËÆæÁΩÆÁ±ª‰ø°ÊÅØËÄåÂ∑≤ÔºåÂæàÁÆÄÂçïÔºåÂ∞±‰∏çË¥¥‰ª£Á†Å‰∫Ü AbstractBeanDefinition bd = createBeanDefinition(className, parent); // ËÆæÁΩÆ BeanDefinition ÁöÑ‰∏ÄÂ†ÜÂ±ûÊÄßÔºåËøô‰∫õÂ±ûÊÄßÂÆö‰πâÂú® AbstractBeanDefinition ‰∏≠ parseBeanDefinitionAttributes(ele, beanName, containingBean, bd); bd.setDescription(DomUtils.getChildElementValueByTagName(ele, DESCRIPTION_ELEMENT)); /** * ‰∏ãÈù¢ÁöÑ‰∏ÄÂ†ÜÊòØËß£Êûê &lt;bean&gt;......&lt;/bean&gt; ÂÜÖÈÉ®ÁöÑÂ≠êÂÖÉÁ¥†Ôºå * Ëß£ÊûêÂá∫Êù•‰ª•ÂêéÁöÑ‰ø°ÊÅØÈÉΩÊîæÂà∞ bd ÁöÑÂ±ûÊÄß‰∏≠ */ // Ëß£Êûê &lt;meta /&gt; parseMetaElements(ele, bd); // Ëß£Êûê &lt;lookup-method /&gt; parseLookupOverrideSubElements(ele, bd.getMethodOverrides()); // Ëß£Êûê &lt;replaced-method /&gt; parseReplacedMethodSubElements(ele, bd.getMethodOverrides()); // Ëß£Êûê &lt;constructor-arg /&gt; parseConstructorArgElements(ele, bd); // Ëß£Êûê &lt;property /&gt; parsePropertyElements(ele, bd); // Ëß£Êûê &lt;qualifier /&gt; parseQualifierElements(ele, bd); bd.setResource(this.readerContext.getResource()); bd.setSource(extractSource(ele)); return bd; &#125; catch (ClassNotFoundException ex) &#123; error("Bean class [" + className + "] not found", ele, ex); &#125; catch (NoClassDefFoundError err) &#123; error("Class that bean class [" + className + "] depends on not found", ele, err); &#125; catch (Throwable ex) &#123; error("Unexpected failure during bean definition parsing", ele, ex); &#125; finally &#123; this.parseState.pop(); &#125; return null;&#125; Âà∞ËøôÈáåÔºåÊàë‰ª¨Â∑≤ÁªèÂÆåÊàê‰∫ÜÊ†πÊçÆ &lt;bean /&gt; ÈÖçÁΩÆÂàõÂª∫‰∫Ü‰∏Ä‰∏™ BeanDefinitionHolder ÂÆû‰æã„ÄÇÊ≥®ÊÑèÔºåÊòØ‰∏Ä‰∏™„ÄÇ Êàë‰ª¨ÂõûÂà∞Ëß£Êûê &lt;bean /&gt; ÁöÑÂÖ•Âè£ÊñπÊ≥ï: 123456789101112131415161718protected void processBeanDefinition(Element ele, BeanDefinitionParserDelegate delegate) &#123; // Â∞Ü &lt;bean /&gt; ËäÇÁÇπËΩ¨Êç¢‰∏∫ BeanDefinitionHolderÔºåÂ∞±ÊòØ‰∏äÈù¢ËØ¥ÁöÑ‰∏ÄÂ†Ü BeanDefinitionHolder bdHolder = delegate.parseBeanDefinitionElement(ele); if (bdHolder != null) &#123; // Â¶ÇÊûúÊúâËá™ÂÆö‰πâÂ±ûÊÄßÁöÑËØùÔºåËøõË°åÁõ∏Â∫îÁöÑËß£ÊûêÔºåÂÖàÂøΩÁï• bdHolder = delegate.decorateBeanDefinitionIfRequired(ele, bdHolder); try &#123; // Êàë‰ª¨ÊääËøôÊ≠•Âè´ÂÅö Ê≥®ÂÜåBean Âêß BeanDefinitionReaderUtils.registerBeanDefinition(bdHolder, getReaderContext().getRegistry()); &#125; catch (BeanDefinitionStoreException ex) &#123; getReaderContext().error("Failed to register bean definition with name '" + bdHolder.getBeanName() + "'", ele, ex); &#125; // Ê≥®ÂÜåÂÆåÊàêÂêéÔºåÂèëÈÄÅ‰∫ã‰ª∂ÔºåÊú¨Êñá‰∏çÂ±ïÂºÄËØ¥Ëøô‰∏™ getReaderContext().fireComponentRegistered(new BeanComponentDefinition(bdHolder)); &#125;&#125; Â§ßÂÆ∂ÂÜç‰ªîÁªÜÁúã‰∏Ä‰∏ãËøôÂùóÂêßÔºåÊàë‰ª¨ÂêéÈù¢Â∞±‰∏çÂõûÊù•ËØ¥Ëøô‰∏™‰∫Ü„ÄÇËøôÈáåÂ∑≤ÁªèÊ†πÊçÆ‰∏Ä‰∏™ &lt;bean /&gt; Ê†áÁ≠æ‰∫ßÁîü‰∫Ü‰∏Ä‰∏™ BeanDefinitionHolder ÁöÑÂÆû‰æãÔºåËøô‰∏™ÂÆû‰æãÈáåÈù¢‰πüÂ∞±ÊòØ‰∏Ä‰∏™ BeanDefinition ÁöÑÂÆû‰æãÂíåÂÆÉÁöÑ beanName„ÄÅaliases Ëøô‰∏â‰∏™‰ø°ÊÅØÔºåÊ≥®ÊÑèÔºåÊàë‰ª¨ÁöÑÂÖ≥Ê≥®ÁÇπÂßãÁªàÂú® BeanDefinition ‰∏äÔºö 12345678public class BeanDefinitionHolder implements BeanMetadataElement &#123; private final BeanDefinition beanDefinition; private final String beanName; private final String[] aliases;... ÁÑ∂ÂêéÊàë‰ª¨ÂáÜÂ§áÊ≥®ÂÜåËøô‰∏™ BeanDefinitionÔºåÊúÄÂêéÔºåÊääËøô‰∏™Ê≥®ÂÜå‰∫ã‰ª∂ÂèëÈÄÅÂá∫Âéª„ÄÇ ‰∏ãÈù¢ÔºåÊàë‰ª¨ÂºÄÂßãËØ¥ËØ¥Ê≥®ÂÜå Bean Âêß„ÄÇ Ê≥®ÂÜå Bean// BeanDefinitionReaderUtils 143 123456789101112131415161718public static void registerBeanDefinition( BeanDefinitionHolder definitionHolder, BeanDefinitionRegistry registry) throws BeanDefinitionStoreException &#123; String beanName = definitionHolder.getBeanName(); // Ê≥®ÂÜåËøô‰∏™ Bean registry.registerBeanDefinition(beanName, definitionHolder.getBeanDefinition()); // Â¶ÇÊûúËøòÊúâÂà´ÂêçÁöÑËØùÔºå‰πüË¶ÅÊ†πÊçÆÂà´ÂêçÂÖ®ÈÉ®Ê≥®ÂÜå‰∏ÄÈÅçÔºå‰∏çÁÑ∂Ê†πÊçÆÂà´ÂêçÂ∞±‰ºöÊâæ‰∏çÂà∞ Bean ‰∫Ü String[] aliases = definitionHolder.getAliases(); if (aliases != null) &#123; for (String alias : aliases) &#123; // alias -&gt; beanName ‰øùÂ≠òÂÆÉ‰ª¨ÁöÑÂà´Âêç‰ø°ÊÅØÔºåËøô‰∏™ÂæàÁÆÄÂçïÔºåÁî®‰∏Ä‰∏™ map ‰øùÂ≠ò‰∏Ä‰∏ãÂ∞±ÂèØ‰ª•‰∫ÜÔºå // Ëé∑ÂèñÁöÑÊó∂ÂÄôÔºå‰ºöÂÖàÂ∞Ü alias ËΩ¨Êç¢‰∏∫ beanNameÔºåÁÑ∂ÂêéÂÜçÊü•Êâæ registry.registerAlias(beanName, alias); &#125; &#125;&#125; Âà´ÂêçÊ≥®ÂÜåÁöÑÊîæ‰∏ÄËæπÔºåÊØïÁ´üÂÆÉÂæàÁÆÄÂçïÔºåÊàë‰ª¨ÁúãÁúãÊÄé‰πàÊ≥®ÂÜå Bean„ÄÇ // DefaultListableBeanFactory 793 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182@Overridepublic void registerBeanDefinition(String beanName, BeanDefinition beanDefinition) throws BeanDefinitionStoreException &#123; Assert.hasText(beanName, "Bean name must not be empty"); Assert.notNull(beanDefinition, "BeanDefinition must not be null"); if (beanDefinition instanceof AbstractBeanDefinition) &#123; try &#123; ((AbstractBeanDefinition) beanDefinition).validate(); &#125; catch (BeanDefinitionValidationException ex) &#123; throw new BeanDefinitionStoreException(...); &#125; &#125; // old? ËøòËÆ∞Âæó ‚ÄúÂÖÅËÆ∏ bean Ë¶ÜÁõñ‚Äù Ëøô‰∏™ÈÖçÁΩÆÂêóÔºüallowBeanDefinitionOverriding BeanDefinition oldBeanDefinition; // ‰πãÂêé‰ºöÁúãÂà∞ÔºåÊâÄÊúâÁöÑ Bean Ê≥®ÂÜåÂêé‰ºöÊîæÂÖ•Ëøô‰∏™ beanDefinitionMap ‰∏≠ oldBeanDefinition = this.beanDefinitionMap.get(beanName); // Â§ÑÁêÜÈáçÂ§çÂêçÁß∞ÁöÑ Bean ÂÆö‰πâÁöÑÊÉÖÂÜµ if (oldBeanDefinition != null) &#123; if (!isAllowBeanDefinitionOverriding()) &#123; // Â¶ÇÊûú‰∏çÂÖÅËÆ∏Ë¶ÜÁõñÁöÑËØùÔºåÊäõÂºÇÂ∏∏ throw new BeanDefinitionStoreException(beanDefinition.getResourceDescription()... &#125; else if (oldBeanDefinition.getRole() &lt; beanDefinition.getRole()) &#123; // log...Áî®Ê°ÜÊû∂ÂÆö‰πâÁöÑ Bean Ë¶ÜÁõñÁî®Êà∑Ëá™ÂÆö‰πâÁöÑ Bean &#125; else if (!beanDefinition.equals(oldBeanDefinition)) &#123; // log...Áî®Êñ∞ÁöÑ Bean Ë¶ÜÁõñÊóßÁöÑ Bean &#125; else &#123; // log...Áî®ÂêåÁ≠âÁöÑ Bean Ë¶ÜÁõñÊóßÁöÑ BeanÔºåËøôÈáåÊåáÁöÑÊòØ equals ÊñπÊ≥ïËøîÂõû true ÁöÑ Bean &#125; // Ë¶ÜÁõñ this.beanDefinitionMap.put(beanName, beanDefinition); &#125; else &#123; // Âà§Êñ≠ÊòØÂê¶Â∑≤ÁªèÊúâÂÖ∂‰ªñÁöÑ Bean ÂºÄÂßãÂàùÂßãÂåñ‰∫Ü. // Ê≥®ÊÑèÔºå"Ê≥®ÂÜåBean" Ëøô‰∏™Âä®‰ΩúÁªìÊùüÔºåBean ‰æùÁÑ∂ËøòÊ≤°ÊúâÂàùÂßãÂåñÔºåÊàë‰ª¨ÂêéÈù¢‰ºöÊúâÂ§ßÁØáÂπÖËØ¥ÂàùÂßãÂåñËøáÁ®ãÔºå // Âú® Spring ÂÆπÂô®ÂêØÂä®ÁöÑÊúÄÂêéÔºå‰ºö È¢ÑÂàùÂßãÂåñ ÊâÄÊúâÁöÑ singleton beans if (hasBeanCreationStarted()) &#123; // Cannot modify startup-time collection elements anymore (for stable iteration) synchronized (this.beanDefinitionMap) &#123; this.beanDefinitionMap.put(beanName, beanDefinition); List&lt;String&gt; updatedDefinitions = new ArrayList&lt;String&gt;(this.beanDefinitionNames.size() + 1); updatedDefinitions.addAll(this.beanDefinitionNames); updatedDefinitions.add(beanName); this.beanDefinitionNames = updatedDefinitions; if (this.manualSingletonNames.contains(beanName)) &#123; Set&lt;String&gt; updatedSingletons = new LinkedHashSet&lt;String&gt;(this.manualSingletonNames); updatedSingletons.remove(beanName); this.manualSingletonNames = updatedSingletons; &#125; &#125; &#125; else &#123; // ÊúÄÊ≠£Â∏∏ÁöÑÂ∫îËØ•ÊòØËøõÂà∞Ëøô‰∏™ÂàÜÊîØ„ÄÇ // Â∞Ü BeanDefinition ÊîæÂà∞Ëøô‰∏™ map ‰∏≠ÔºåËøô‰∏™ map ‰øùÂ≠ò‰∫ÜÊâÄÊúâÁöÑ BeanDefinition this.beanDefinitionMap.put(beanName, beanDefinition); // ËøôÊòØ‰∏™ ArrayListÔºåÊâÄ‰ª•‰ºöÊåâÁÖß bean ÈÖçÁΩÆÁöÑÈ°∫Â∫è‰øùÂ≠òÊØè‰∏Ä‰∏™Ê≥®ÂÜåÁöÑ Bean ÁöÑÂêçÂ≠ó this.beanDefinitionNames.add(beanName); // ËøôÊòØ‰∏™ LinkedHashSetÔºå‰ª£Ë°®ÁöÑÊòØÊâãÂä®Ê≥®ÂÜåÁöÑ singleton beanÔºå // Ê≥®ÊÑèËøôÈáåÊòØ remove ÊñπÊ≥ïÔºåÂà∞ËøôÈáåÁöÑ Bean ÂΩìÁÑ∂‰∏çÊòØÊâãÂä®Ê≥®ÂÜåÁöÑ // ÊâãÂä®ÊåáÁöÑÊòØÈÄöËøáË∞ÉÁî®‰ª•‰∏ãÊñπÊ≥ïÊ≥®ÂÜåÁöÑ bean Ôºö // registerSingleton(String beanName, Object singletonObject) // Ëøô‰∏çÊòØÈáçÁÇπÔºåËß£ÈáäÂè™ÊòØ‰∏∫‰∫Ü‰∏çËÆ©Â§ßÂÆ∂ÁñëÊÉë„ÄÇSpring ‰ºöÂú®ÂêéÈù¢"ÊâãÂä®"Ê≥®ÂÜå‰∏Ä‰∫õ BeanÔºå // Â¶Ç "environment"„ÄÅ"systemProperties" Á≠â beanÔºåÊàë‰ª¨Ëá™Â∑±‰πüÂèØ‰ª•Âú®ËøêË°åÊó∂Ê≥®ÂÜå Bean Âà∞ÂÆπÂô®‰∏≠ÁöÑ this.manualSingletonNames.remove(beanName); &#125; // Ëøô‰∏™‰∏çÈáçË¶ÅÔºåÂú®È¢ÑÂàùÂßãÂåñÁöÑÊó∂ÂÄô‰ºöÁî®Âà∞Ôºå‰∏çÂøÖÁÆ°ÂÆÉ„ÄÇ this.frozenBeanDefinitionNames = null; &#125; if (oldBeanDefinition != null || containsSingleton(beanName)) &#123; resetBeanDefinition(beanName); &#125;&#125; ÊÄªÁªì‰∏Ä‰∏ãÔºåÂà∞ËøôÈáåÂ∑≤ÁªèÂàùÂßãÂåñ‰∫Ü Bean ÂÆπÂô®Ôºå&lt;bean /&gt; ÈÖçÁΩÆ‰πüÁõ∏Â∫îÁöÑËΩ¨Êç¢‰∏∫‰∫Ü‰∏Ä‰∏™‰∏™ BeanDefinitionÔºåÁÑ∂ÂêéÊ≥®ÂÜå‰∫ÜÂêÑ‰∏™ BeanDefinition Âà∞Ê≥®ÂÜå‰∏≠ÂøÉÔºåÂπ∂‰∏îÂèëÈÄÅ‰∫ÜÊ≥®ÂÜå‰∫ã‰ª∂„ÄÇ Âà∞ËøôÈáåÊòØ‰∏Ä‰∏™ÂàÜÊ∞¥Â≤≠ÔºåÂâçÈù¢ÁöÑÂÜÖÂÆπÈÉΩËøòÁÆóÊØîËæÉÁÆÄÂçïÔºåÂ§ßÂÆ∂Ë¶ÅÊ∏ÖÊ•öÂú∞Áü•ÈÅìÂâçÈù¢ÈÉΩÂÅö‰∫ÜÂì™‰∫õ‰∫ãÊÉÖ„ÄÇ Bean ÂÆπÂô®ÂÆû‰æãÂåñÂÆåÊàêÂêéËØ¥Âà∞ËøôÈáåÔºåÊàë‰ª¨ÂõûÂà∞ refresh() ÊñπÊ≥ïÔºåÊàëÈáçÊñ∞Ë¥¥‰∫Ü‰∏ÄÈÅç‰ª£Á†ÅÔºåÁúãÁúãÊàë‰ª¨ËØ¥Âà∞Âì™‰∫Ü„ÄÇÊòØÁöÑÔºåÊàë‰ª¨ÊâçËØ¥ÂÆå obtainFreshBeanFactory() ÊñπÊ≥ï„ÄÇ ËÄÉËôëÂà∞ÁØáÂπÖÔºåËøôÈáåÂºÄÂßãÂ§ßÂπÖÁº©ÂáèÊéâÊ≤°ÂøÖË¶ÅËØ¶ÁªÜ‰ªãÁªçÁöÑÈÉ®ÂàÜÔºåÂ§ßÂÆ∂Áõ¥Êé•Áúã‰∏ãÈù¢ÁöÑ‰ª£Á†Å‰∏≠ÁöÑÊ≥®ÈáäÂ∞±Â•Ω‰∫Ü„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980@Overridepublic void refresh() throws BeansException, IllegalStateException &#123; // Êù•‰∏™ÈîÅÔºå‰∏çÁÑ∂ refresh() ËøòÊ≤°ÁªìÊùüÔºå‰Ω†ÂèàÊù•‰∏™ÂêØÂä®ÊàñÈîÄÊØÅÂÆπÂô®ÁöÑÊìç‰ΩúÔºåÈÇ£‰∏çÂ∞±‰π±Â•ó‰∫ÜÂòõ synchronized (this.startupShutdownMonitor) &#123; // ÂáÜÂ§áÂ∑•‰ΩúÔºåËÆ∞ÂΩï‰∏ãÂÆπÂô®ÁöÑÂêØÂä®Êó∂Èó¥„ÄÅÊ†áËÆ∞‚ÄúÂ∑≤ÂêØÂä®‚ÄùÁä∂ÊÄÅ„ÄÅÂ§ÑÁêÜÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑÂç†‰ΩçÁ¨¶ prepareRefresh(); // ËøôÊ≠•ÊØîËæÉÂÖ≥ÈîÆÔºåËøôÊ≠•ÂÆåÊàêÂêéÔºåÈÖçÁΩÆÊñá‰ª∂Â∞±‰ºöËß£ÊûêÊàê‰∏Ä‰∏™‰∏™ Bean ÂÆö‰πâÔºåÊ≥®ÂÜåÂà∞ BeanFactory ‰∏≠Ôºå // ÂΩìÁÑ∂ÔºåËøôÈáåËØ¥ÁöÑ Bean ËøòÊ≤°ÊúâÂàùÂßãÂåñÔºåÂè™ÊòØÈÖçÁΩÆ‰ø°ÊÅØÈÉΩÊèêÂèñÂá∫Êù•‰∫ÜÔºå // Ê≥®ÂÜå‰πüÂè™ÊòØÂ∞ÜËøô‰∫õ‰ø°ÊÅØÈÉΩ‰øùÂ≠òÂà∞‰∫ÜÊ≥®ÂÜå‰∏≠ÂøÉ(ËØ¥Âà∞Â∫ïÊ†∏ÂøÉÊòØ‰∏Ä‰∏™ beanName-&gt; beanDefinition ÁöÑ map) ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory(); // ËÆæÁΩÆ BeanFactory ÁöÑÁ±ªÂä†ËΩΩÂô®ÔºåÊ∑ªÂä†Âá†‰∏™ BeanPostProcessorÔºåÊâãÂä®Ê≥®ÂÜåÂá†‰∏™ÁâπÊÆäÁöÑ bean // ËøôÂùóÂæÖ‰ºö‰ºöÂ±ïÂºÄËØ¥ prepareBeanFactory(beanFactory); try &#123; // „ÄêËøôÈáåÈúÄË¶ÅÁü•ÈÅì BeanFactoryPostProcessor Ëøô‰∏™Áü•ËØÜÁÇπÔºåBean Â¶ÇÊûúÂÆûÁé∞‰∫ÜÊ≠§Êé•Âè£Ôºå // ÈÇ£‰πàÂú®ÂÆπÂô®ÂàùÂßãÂåñ‰ª•ÂêéÔºåSpring ‰ºöË¥üË¥£Ë∞ÉÁî®ÈáåÈù¢ÁöÑ postProcessBeanFactory ÊñπÊ≥ï„ÄÇ„Äë // ËøôÈáåÊòØÊèê‰æõÁªôÂ≠êÁ±ªÁöÑÊâ©Â±ïÁÇπÔºåÂà∞ËøôÈáåÁöÑÊó∂ÂÄôÔºåÊâÄÊúâÁöÑ Bean ÈÉΩÂä†ËΩΩ„ÄÅÊ≥®ÂÜåÂÆåÊàê‰∫ÜÔºå‰ΩÜÊòØÈÉΩËøòÊ≤°ÊúâÂàùÂßãÂåñ // ÂÖ∑‰ΩìÁöÑÂ≠êÁ±ªÂèØ‰ª•Âú®ËøôÊ≠•ÁöÑÊó∂ÂÄôÊ∑ªÂä†‰∏Ä‰∫õÁâπÊÆäÁöÑ BeanFactoryPostProcessor ÁöÑÂÆûÁé∞Á±ªÊàñÂÅöÁÇπ‰ªÄ‰πà‰∫ã postProcessBeanFactory(beanFactory); // Ë∞ÉÁî® BeanFactoryPostProcessor ÂêÑ‰∏™ÂÆûÁé∞Á±ªÁöÑ postProcessBeanFactory(factory) ÂõûË∞ÉÊñπÊ≥ï invokeBeanFactoryPostProcessors(beanFactory); // Ê≥®ÂÜå BeanPostProcessor ÁöÑÂÆûÁé∞Á±ªÔºåÊ≥®ÊÑèÁúãÂíå BeanFactoryPostProcessor ÁöÑÂå∫Âà´ // Ê≠§Êé•Âè£‰∏§‰∏™ÊñπÊ≥ï: postProcessBeforeInitialization Âíå postProcessAfterInitialization // ‰∏§‰∏™ÊñπÊ≥ïÂàÜÂà´Âú® Bean ÂàùÂßãÂåñ‰πãÂâçÂíåÂàùÂßãÂåñ‰πãÂêéÂæóÂà∞ÊâßË°å„ÄÇËøôÈáå‰ªÖ‰ªÖÊòØÊ≥®ÂÜåÔºå‰πãÂêé‰ºöÁúãÂà∞ÂõûË∞ÉËøô‰∏§ÊñπÊ≥ïÁöÑÊó∂Êú∫ registerBeanPostProcessors(beanFactory); // ÂàùÂßãÂåñÂΩìÂâç ApplicationContext ÁöÑ MessageSourceÔºåÂõΩÈôÖÂåñËøôÈáåÂ∞±‰∏çÂ±ïÂºÄËØ¥‰∫ÜÔºå‰∏çÁÑ∂Ê≤°ÂÆåÊ≤°‰∫Ü‰∫Ü initMessageSource(); // ÂàùÂßãÂåñÂΩìÂâç ApplicationContext ÁöÑ‰∫ã‰ª∂ÂπøÊí≠Âô®ÔºåËøôÈáå‰πü‰∏çÂ±ïÂºÄ‰∫Ü initApplicationEventMulticaster(); // ‰ªéÊñπÊ≥ïÂêçÂ∞±ÂèØ‰ª•Áü•ÈÅìÔºåÂÖ∏ÂûãÁöÑÊ®°ÊùøÊñπÊ≥ï(Èí©Â≠êÊñπÊ≥ï)Ôºå‰∏çÂ±ïÂºÄËØ¥ // ÂÖ∑‰ΩìÁöÑÂ≠êÁ±ªÂèØ‰ª•Âú®ËøôÈáåÂàùÂßãÂåñ‰∏Ä‰∫õÁâπÊÆäÁöÑ BeanÔºàÂú®ÂàùÂßãÂåñ singleton beans ‰πãÂâçÔºâ onRefresh(); // Ê≥®ÂÜå‰∫ã‰ª∂ÁõëÂê¨Âô®ÔºåÁõëÂê¨Âô®ÈúÄË¶ÅÂÆûÁé∞ ApplicationListener Êé•Âè£„ÄÇËøô‰πü‰∏çÊòØÊàë‰ª¨ÁöÑÈáçÁÇπÔºåËøá registerListeners(); // ÈáçÁÇπÔºåÈáçÁÇπÔºåÈáçÁÇπ // ÂàùÂßãÂåñÊâÄÊúâÁöÑ singleton beans //Ôºàlazy-init ÁöÑÈô§Â§ñÔºâ finishBeanFactoryInitialization(beanFactory); // ÊúÄÂêéÔºåÂπøÊí≠‰∫ã‰ª∂ÔºåApplicationContext ÂàùÂßãÂåñÂÆåÊàêÔºå‰∏çÂ±ïÂºÄ finishRefresh(); &#125; catch (BeansException ex) &#123; if (logger.isWarnEnabled()) &#123; logger.warn("Exception encountered during context initialization - " + "cancelling refresh attempt: " + ex); &#125; // Destroy already created singletons to avoid dangling resources. // ÈîÄÊØÅÂ∑≤ÁªèÂàùÂßãÂåñÁöÑ singleton ÁöÑ BeansÔºå‰ª•ÂÖçÊúâ‰∫õ bean ‰ºö‰∏ÄÁõ¥Âç†Áî®ËµÑÊ∫ê destroyBeans(); // Reset 'active' flag. cancelRefresh(ex); // ÊääÂºÇÂ∏∏ÂæÄÂ§ñÊäõ throw ex; &#125; finally &#123; // Reset common introspection caches in Spring's core, since we // might not ever need metadata for singleton beans anymore... resetCommonCaches(); &#125; &#125;&#125; ÂáÜÂ§á Bean ÂÆπÂô®: prepareBeanFactory‰πãÂâçÊàë‰ª¨ËØ¥ËøáÔºåSpring ÊääÊàë‰ª¨Âú® xml ÈÖçÁΩÆÁöÑ bean ÈÉΩÊ≥®ÂÜå‰ª•ÂêéÔºå‰ºö‚ÄùÊâãÂä®‚ÄùÊ≥®ÂÜå‰∏Ä‰∫õÁâπÊÆäÁöÑ bean„ÄÇ ËøôÈáåÁÆÄÂçï‰ªãÁªç‰∏ã prepareBeanFactory(factory) ÊñπÊ≥ïÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374/** * Configure the factory's standard context characteristics, * such as the context's ClassLoader and post-processors. * @param beanFactory the BeanFactory to configure */protected void prepareBeanFactory(ConfigurableListableBeanFactory beanFactory) &#123; // ËÆæÁΩÆ BeanFactory ÁöÑÁ±ªÂä†ËΩΩÂô®ÔºåÊàë‰ª¨Áü•ÈÅì BeanFactory ÈúÄË¶ÅÂä†ËΩΩÁ±ªÔºå‰πüÂ∞±ÈúÄË¶ÅÁ±ªÂä†ËΩΩÂô®Ôºå // ËøôÈáåËÆæÁΩÆ‰∏∫Âä†ËΩΩÂΩìÂâç ApplicationContext Á±ªÁöÑÁ±ªÂä†ËΩΩÂô® beanFactory.setBeanClassLoader(getClassLoader()); // ËÆæÁΩÆ BeanExpressionResolver beanFactory.setBeanExpressionResolver(new StandardBeanExpressionResolver(beanFactory.getBeanClassLoader())); // beanFactory.addPropertyEditorRegistrar(new ResourceEditorRegistrar(this, getEnvironment())); // Ê∑ªÂä†‰∏Ä‰∏™ BeanPostProcessorÔºåËøô‰∏™ processor ÊØîËæÉÁÆÄÂçïÔºö // ÂÆûÁé∞‰∫Ü Aware Êé•Âè£ÁöÑ beans Âú®ÂàùÂßãÂåñÁöÑÊó∂ÂÄôÔºåËøô‰∏™ processor Ë¥üË¥£ÂõûË∞ÉÔºå // Ëøô‰∏™Êàë‰ª¨ÂæàÂ∏∏Áî®ÔºåÂ¶ÇÊàë‰ª¨‰ºö‰∏∫‰∫ÜËé∑Âèñ ApplicationContext ËÄå implement ApplicationContextAware // Ê≥®ÊÑèÔºöÂÆÉ‰∏ç‰ªÖ‰ªÖÂõûË∞É ApplicationContextAwareÔºå // Ëøò‰ºöË¥üË¥£ÂõûË∞É EnvironmentAware„ÄÅResourceLoaderAware Á≠âÔºåÁúã‰∏ãÊ∫êÁ†ÅÂ∞±Ê∏ÖÊ•ö‰∫Ü beanFactory.addBeanPostProcessor(new ApplicationContextAwareProcessor(this)); // ‰∏ãÈù¢Âá†Ë°åÁöÑÊÑèÊÄùÂ∞±ÊòØÔºåÂ¶ÇÊûúÊüê‰∏™ bean ‰æùËµñ‰∫é‰ª•‰∏ãÂá†‰∏™Êé•Âè£ÁöÑÂÆûÁé∞Á±ªÔºåÂú®Ëá™Âä®Ë£ÖÈÖçÁöÑÊó∂ÂÄôÂøΩÁï•ÂÆÉ‰ª¨Ôºå // Spring ‰ºöÈÄöËøáÂÖ∂‰ªñÊñπÂºèÊù•Â§ÑÁêÜËøô‰∫õ‰æùËµñ„ÄÇ beanFactory.ignoreDependencyInterface(EnvironmentAware.class); beanFactory.ignoreDependencyInterface(EmbeddedValueResolverAware.class); beanFactory.ignoreDependencyInterface(ResourceLoaderAware.class); beanFactory.ignoreDependencyInterface(ApplicationEventPublisherAware.class); beanFactory.ignoreDependencyInterface(MessageSourceAware.class); beanFactory.ignoreDependencyInterface(ApplicationContextAware.class); /** * ‰∏ãÈù¢Âá†Ë°åÂ∞±ÊòØ‰∏∫ÁâπÊÆäÁöÑÂá†‰∏™ bean ËµãÂÄºÔºåÂ¶ÇÊûúÊúâ bean ‰æùËµñ‰∫Ü‰ª•‰∏ãÂá†‰∏™Ôºå‰ºöÊ≥®ÂÖ•ËøôËæπÁõ∏Â∫îÁöÑÂÄºÔºå * ‰πãÂâçÊàë‰ª¨ËØ¥ËøáÔºå"ÂΩìÂâç ApplicationContext ÊåÅÊúâ‰∏Ä‰∏™ BeanFactory"ÔºåËøôÈáåËß£Èáä‰∫ÜÁ¨¨‰∏ÄË°å * ApplicationContext ËøòÁªßÊâø‰∫Ü ResourceLoader„ÄÅApplicationEventPublisher„ÄÅMessageSource * ÊâÄ‰ª•ÂØπ‰∫éËøôÂá†‰∏™‰æùËµñÔºåÂèØ‰ª•ËµãÂÄº‰∏∫ thisÔºåÊ≥®ÊÑè this ÊòØ‰∏Ä‰∏™ ApplicationContext * ÈÇ£ËøôÈáåÊÄé‰πàÊ≤°ÁúãÂà∞‰∏∫ MessageSource ËµãÂÄºÂë¢ÔºüÈÇ£ÊòØÂõ†‰∏∫ MessageSource Ë¢´Ê≥®ÂÜåÊàê‰∏∫‰∫Ü‰∏Ä‰∏™ÊôÆÈÄöÁöÑ bean */ beanFactory.registerResolvableDependency(BeanFactory.class, beanFactory); beanFactory.registerResolvableDependency(ResourceLoader.class, this); beanFactory.registerResolvableDependency(ApplicationEventPublisher.class, this); beanFactory.registerResolvableDependency(ApplicationContext.class, this); // Ëøô‰∏™ BeanPostProcessor ‰πüÂæàÁÆÄÂçïÔºåÂú® bean ÂÆû‰æãÂåñÂêéÔºåÂ¶ÇÊûúÊòØ ApplicationListener ÁöÑÂ≠êÁ±ªÔºå // ÈÇ£‰πàÂ∞ÜÂÖ∂Ê∑ªÂä†Âà∞ listener ÂàóË°®‰∏≠ÔºåÂèØ‰ª•ÁêÜËß£ÊàêÔºöÊ≥®ÂÜå ‰∫ã‰ª∂ÁõëÂê¨Âô® beanFactory.addBeanPostProcessor(new ApplicationListenerDetector(this)); // ËøôÈáåÊ∂âÂèäÂà∞ÁâπÊÆäÁöÑ beanÔºåÂêç‰∏∫ÔºöloadTimeWeaverÔºåËøô‰∏çÊòØÊàë‰ª¨ÁöÑÈáçÁÇπÔºåÂøΩÁï•ÂÆÉ // tips: ltw ÊòØ AspectJ ÁöÑÊ¶ÇÂøµÔºåÊåáÁöÑÊòØÂú®ËøêË°åÊúüËøõË°åÁªáÂÖ•ÔºåËøô‰∏™Âíå Spring AOP ‰∏ç‰∏ÄÊ†∑Ôºå // ÊÑüÂÖ¥Ë∂£ÁöÑËØªËÄÖËØ∑ÂèÇËÄÉÊàëÂÜôÁöÑÂÖ≥‰∫é AspectJ ÁöÑÂè¶‰∏ÄÁØáÊñáÁ´† https://www.javadoop.com/post/aspectj if (beanFactory.containsBean(LOAD_TIME_WEAVER_BEAN_NAME)) &#123; beanFactory.addBeanPostProcessor(new LoadTimeWeaverAwareProcessor(beanFactory)); // Set a temporary ClassLoader for type matching. beanFactory.setTempClassLoader(new ContextTypeMatchClassLoader(beanFactory.getBeanClassLoader())); &#125; /** * ‰ªé‰∏ãÈù¢Âá†Ë°å‰ª£Á†ÅÊàë‰ª¨ÂèØ‰ª•Áü•ÈÅìÔºåSpring ÂæÄÂæÄÂæà "Êô∫ËÉΩ" Â∞±ÊòØÂõ†‰∏∫ÂÆÉ‰ºöÂ∏ÆÊàë‰ª¨ÈªòËÆ§Ê≥®ÂÜå‰∏Ä‰∫õÊúâÁî®ÁöÑ beanÔºå * Êàë‰ª¨‰πüÂèØ‰ª•ÈÄâÊã©Ë¶ÜÁõñ */ // Â¶ÇÊûúÊ≤°ÊúâÂÆö‰πâ "environment" Ëøô‰∏™ beanÔºåÈÇ£‰πà Spring ‰ºö "ÊâãÂä®" Ê≥®ÂÜå‰∏Ä‰∏™ if (!beanFactory.containsLocalBean(ENVIRONMENT_BEAN_NAME)) &#123; beanFactory.registerSingleton(ENVIRONMENT_BEAN_NAME, getEnvironment()); &#125; // Â¶ÇÊûúÊ≤°ÊúâÂÆö‰πâ "systemProperties" Ëøô‰∏™ beanÔºåÈÇ£‰πà Spring ‰ºö "ÊâãÂä®" Ê≥®ÂÜå‰∏Ä‰∏™ if (!beanFactory.containsLocalBean(SYSTEM_PROPERTIES_BEAN_NAME)) &#123; beanFactory.registerSingleton(SYSTEM_PROPERTIES_BEAN_NAME, getEnvironment().getSystemProperties()); &#125; // Â¶ÇÊûúÊ≤°ÊúâÂÆö‰πâ "systemEnvironment" Ëøô‰∏™ beanÔºåÈÇ£‰πà Spring ‰ºö "ÊâãÂä®" Ê≥®ÂÜå‰∏Ä‰∏™ if (!beanFactory.containsLocalBean(SYSTEM_ENVIRONMENT_BEAN_NAME)) &#123; beanFactory.registerSingleton(SYSTEM_ENVIRONMENT_BEAN_NAME, getEnvironment().getSystemEnvironment()); &#125;&#125; Âú®‰∏äÈù¢ËøôÂùó‰ª£Á†Å‰∏≠ÔºåSpring ÂØπ‰∏Ä‰∫õÁâπÊÆäÁöÑ bean ËøõË°å‰∫ÜÂ§ÑÁêÜÔºåËØªËÄÖÂ¶ÇÊûúÊöÇÊó∂Ëøò‰∏çËÉΩÊ∂àÂåñÂÆÉ‰ª¨‰πüÊ≤°ÊúâÂÖ≥Á≥ªÔºåÊÖ¢ÊÖ¢ÂæÄ‰∏ãÁúã„ÄÇ ÂàùÂßãÂåñÊâÄÊúâÁöÑ singleton beansÊàë‰ª¨ÁöÑÈáçÁÇπÂΩìÁÑ∂ÊòØ finishBeanFactoryInitialization(beanFactory); Ëøô‰∏™Â∑®Â§¥‰∫ÜÔºåËøôÈáå‰ºöË¥üË¥£ÂàùÂßãÂåñÊâÄÊúâÁöÑ singleton beans„ÄÇ Ê≥®ÊÑèÔºåÂêéÈù¢ÁöÑÊèèËø∞‰∏≠ÔºåÊàëÈÉΩ‰ºö‰ΩøÁî®ÂàùÂßãÂåñÊàñÈ¢ÑÂàùÂßãÂåñÊù•‰ª£Ë°®Ëøô‰∏™Èò∂ÊÆµÔºåSpring ‰ºöÂú®Ëøô‰∏™Èò∂ÊÆµÂÆåÊàêÊâÄÊúâÁöÑ singleton beans ÁöÑÂÆû‰æãÂåñ„ÄÇ Êàë‰ª¨Êù•ÊÄªÁªì‰∏Ä‰∏ãÔºåÂà∞ÁõÆÂâç‰∏∫Ê≠¢ÔºåÂ∫îËØ•ËØ¥ BeanFactory Â∑≤ÁªèÂàõÂª∫ÂÆåÊàêÔºåÂπ∂‰∏îÊâÄÊúâÁöÑÂÆûÁé∞‰∫Ü BeanFactoryPostProcessor Êé•Âè£ÁöÑ Bean ÈÉΩÂ∑≤ÁªèÂàùÂßãÂåñÂπ∂‰∏îÂÖ∂‰∏≠ÁöÑ postProcessBeanFactory(factory) ÊñπÊ≥ïÂ∑≤ÁªèÂæóÂà∞ÂõûË∞ÉÊâßË°å‰∫Ü„ÄÇËÄå‰∏î Spring Â∑≤Áªè‚ÄúÊâãÂä®‚ÄùÊ≥®ÂÜå‰∫Ü‰∏Ä‰∫õÁâπÊÆäÁöÑ BeanÔºåÂ¶Ç ‚Äòenvironment‚Äô„ÄÅ‚ÄòsystemProperties‚Äô Á≠â„ÄÇ Ââ©‰∏ãÁöÑÂ∞±ÊòØÂàùÂßãÂåñ singleton beans ‰∫ÜÔºåÊàë‰ª¨Áü•ÈÅìÂÆÉ‰ª¨ÊòØÂçï‰æãÁöÑÔºåÂ¶ÇÊûúÊ≤°ÊúâËÆæÁΩÆÊáíÂä†ËΩΩÔºåÈÇ£‰πà Spring ‰ºöÂú®Êé•‰∏ãÊù•ÂàùÂßãÂåñÊâÄÊúâÁöÑ singleton beans„ÄÇ // AbstractApplicationContext.java 834 1234567891011121314151617181920212223242526272829303132333435363738394041// ÂàùÂßãÂåñÂâ©‰ΩôÁöÑ singleton beansprotected void finishBeanFactoryInitialization(ConfigurableListableBeanFactory beanFactory) &#123; // È¶ñÂÖàÔºåÂàùÂßãÂåñÂêçÂ≠ó‰∏∫ conversionService ÁöÑ Bean„ÄÇÊú¨ÁùÄÈÄÅ‰ΩõÈÄÅÂà∞Ë•øÁöÑÁ≤æÁ•ûÔºåÊàëÂú®ÈôÑÂΩï‰∏≠ÁÆÄÂçï‰ªãÁªç‰∫Ü‰∏Ä‰∏ã ConversionServiceÔºåÂõ†‰∏∫ËøôÂÆûÂú®Â§™ÂÆûÁî®‰∫Ü // ‰ªÄ‰πàÔºåÁúã‰ª£Á†ÅËøôÈáåÊ≤°ÊúâÂàùÂßãÂåñ Bean ÂïäÔºÅ // Ê≥®ÊÑè‰∫ÜÔºåÂàùÂßãÂåñÁöÑÂä®‰ΩúÂåÖË£ÖÂú® beanFactory.getBean(...) ‰∏≠ÔºåËøôÈáåÂÖà‰∏çËØ¥ÁªÜËäÇÔºåÂÖàÂæÄ‰∏ãÁúãÂêß if (beanFactory.containsBean(CONVERSION_SERVICE_BEAN_NAME) &amp;&amp; beanFactory.isTypeMatch(CONVERSION_SERVICE_BEAN_NAME, ConversionService.class)) &#123; beanFactory.setConversionService( beanFactory.getBean(CONVERSION_SERVICE_BEAN_NAME, ConversionService.class)); &#125; // Register a default embedded value resolver if no bean post-processor // (such as a PropertyPlaceholderConfigurer bean) registered any before: // at this point, primarily for resolution in annotation attribute values. if (!beanFactory.hasEmbeddedValueResolver()) &#123; beanFactory.addEmbeddedValueResolver(new StringValueResolver() &#123; @Override public String resolveStringValue(String strVal) &#123; return getEnvironment().resolvePlaceholders(strVal); &#125; &#125;); &#125; // ÂÖàÂàùÂßãÂåñ LoadTimeWeaverAware Á±ªÂûãÁöÑ Bean // ‰πãÂâç‰πüËØ¥ËøáÔºåËøôÊòØ AspectJ Áõ∏ÂÖ≥ÁöÑÂÜÖÂÆπÔºåÊîæÂøÉË∑≥ËøáÂêß String[] weaverAwareNames = beanFactory.getBeanNamesForType(LoadTimeWeaverAware.class, false, false); for (String weaverAwareName : weaverAwareNames) &#123; getBean(weaverAwareName); &#125; // Stop using the temporary ClassLoader for type matching. beanFactory.setTempClassLoader(null); // Ê≤°‰ªÄ‰πàÂà´ÁöÑÁõÆÁöÑÔºåÂõ†‰∏∫Âà∞Ëøô‰∏ÄÊ≠•ÁöÑÊó∂ÂÄôÔºåSpring Â∑≤ÁªèÂºÄÂßãÈ¢ÑÂàùÂßãÂåñ singleton beans ‰∫ÜÔºå // ËÇØÂÆö‰∏çÂ∏åÊúõËøô‰∏™Êó∂ÂÄôËøòÂá∫Áé∞ bean ÂÆö‰πâËß£Êûê„ÄÅÂä†ËΩΩ„ÄÅÊ≥®ÂÜå„ÄÇ beanFactory.freezeConfiguration(); // ÂºÄÂßãÂàùÂßãÂåñ beanFactory.preInstantiateSingletons();&#125; ‰ªé‰∏äÈù¢ÊúÄÂêé‰∏ÄË°åÂæÄÈáåÁúãÔºåÊàë‰ª¨Â∞±ÂèàÂõûÂà∞ DefaultListableBeanFactory Ëøô‰∏™Á±ª‰∫ÜÔºåËøô‰∏™Á±ªÂ§ßÂÆ∂Â∫îËØ•ÈÉΩ‰∏çÈôåÁîü‰∫ÜÂêß„ÄÇ preInstantiateSingletons// DefaultListableBeanFactory 728 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869@Overridepublic void preInstantiateSingletons() throws BeansException &#123; if (this.logger.isDebugEnabled()) &#123; this.logger.debug("Pre-instantiating singletons in " + this); &#125; // this.beanDefinitionNames ‰øùÂ≠ò‰∫ÜÊâÄÊúâÁöÑ beanNames List&lt;String&gt; beanNames = new ArrayList&lt;String&gt;(this.beanDefinitionNames); // Ëß¶ÂèëÊâÄÊúâÁöÑÈùûÊáíÂä†ËΩΩÁöÑ singleton beans ÁöÑÂàùÂßãÂåñÊìç‰Ωú for (String beanName : beanNames) &#123; // ÂêàÂπ∂Áà∂ Bean ‰∏≠ÁöÑÈÖçÁΩÆÔºåÊ≥®ÊÑè &lt;bean id="" class="" parent="" /&gt; ‰∏≠ÁöÑ parentÔºåÁî®ÁöÑ‰∏çÂ§öÂêßÔºå // ËÄÉËôëÂà∞ËøôÂèØËÉΩ‰ºöÂΩ±ÂìçÂ§ßÂÆ∂ÁöÑÁêÜËß£ÔºåÊàëÂú®ÈôÑÂΩï‰∏≠Ëß£Èáä‰∫Ü‰∏Ä‰∏ã "Bean ÁªßÊâø"Ôºå‰∏ç‰∫ÜËß£ÁöÑËØ∑Âà∞ÈôÑÂΩï‰∏≠Áúã‰∏Ä‰∏ã RootBeanDefinition bd = getMergedLocalBeanDefinition(beanName); // ÈùûÊäΩË±°„ÄÅÈùûÊáíÂä†ËΩΩÁöÑ singletons„ÄÇÂ¶ÇÊûúÈÖçÁΩÆ‰∫Ü 'abstract = true'ÔºåÈÇ£ÊòØ‰∏çÈúÄË¶ÅÂàùÂßãÂåñÁöÑ if (!bd.isAbstract() &amp;&amp; bd.isSingleton() &amp;&amp; !bd.isLazyInit()) &#123; // Â§ÑÁêÜ FactoryBean(ËØªËÄÖÂ¶ÇÊûú‰∏çÁÜüÊÇâ FactoryBeanÔºåËØ∑ÁßªÊ≠•ÈôÑÂΩïÂå∫‰∫ÜËß£) if (isFactoryBean(beanName)) &#123; // FactoryBean ÁöÑËØùÔºåÂú® beanName ÂâçÈù¢Âä†‰∏ä ‚Äò&amp;‚Äô Á¨¶Âè∑„ÄÇÂÜçË∞ÉÁî® getBeanÔºågetBean ÊñπÊ≥ïÂà´ÊÄ• final FactoryBean&lt;?&gt; factory = (FactoryBean&lt;?&gt;) getBean(FACTORY_BEAN_PREFIX + beanName); // Âà§Êñ≠ÂΩìÂâç FactoryBean ÊòØÂê¶ÊòØ SmartFactoryBean ÁöÑÂÆûÁé∞ÔºåÊ≠§Â§ÑÂøΩÁï•ÔºåÁõ¥Êé•Ë∑≥Ëøá boolean isEagerInit; if (System.getSecurityManager() != null &amp;&amp; factory instanceof SmartFactoryBean) &#123; isEagerInit = AccessController.doPrivileged(new PrivilegedAction&lt;Boolean&gt;() &#123; @Override public Boolean run() &#123; return ((SmartFactoryBean&lt;?&gt;) factory).isEagerInit(); &#125; &#125;, getAccessControlContext()); &#125; else &#123; isEagerInit = (factory instanceof SmartFactoryBean &amp;&amp; ((SmartFactoryBean&lt;?&gt;) factory).isEagerInit()); &#125; if (isEagerInit) &#123; getBean(beanName); &#125; &#125; else &#123; // ÂØπ‰∫éÊôÆÈÄöÁöÑ BeanÔºåÂè™Ë¶ÅË∞ÉÁî® getBean(beanName) Ëøô‰∏™ÊñπÊ≥ïÂ∞±ÂèØ‰ª•ËøõË°åÂàùÂßãÂåñ‰∫Ü getBean(beanName); &#125; &#125; &#125; // Âà∞ËøôÈáåËØ¥ÊòéÊâÄÊúâÁöÑÈùûÊáíÂä†ËΩΩÁöÑ singleton beans Â∑≤ÁªèÂÆåÊàê‰∫ÜÂàùÂßãÂåñ // Â¶ÇÊûúÊàë‰ª¨ÂÆö‰πâÁöÑ bean ÊòØÂÆûÁé∞‰∫Ü SmartInitializingSingleton Êé•Âè£ÁöÑÔºåÈÇ£‰πàÂú®ËøôÈáåÂæóÂà∞ÂõûË∞ÉÔºåÂøΩÁï• for (String beanName : beanNames) &#123; Object singletonInstance = getSingleton(beanName); if (singletonInstance instanceof SmartInitializingSingleton) &#123; final SmartInitializingSingleton smartSingleton = (SmartInitializingSingleton) singletonInstance; if (System.getSecurityManager() != null) &#123; AccessController.doPrivileged(new PrivilegedAction&lt;Object&gt;() &#123; @Override public Object run() &#123; smartSingleton.afterSingletonsInstantiated(); return null; &#125; &#125;, getAccessControlContext()); &#125; else &#123; smartSingleton.afterSingletonsInstantiated(); &#125; &#125; &#125;&#125; Êé•‰∏ãÊù•ÔºåÊàë‰ª¨Â∞±ËøõÂÖ•Âà∞ getBean(beanName) ÊñπÊ≥ï‰∫ÜÔºåËøô‰∏™ÊñπÊ≥ïÊàë‰ª¨ÁªèÂ∏∏Áî®Êù•‰ªé BeanFactory ‰∏≠Ëé∑Âèñ‰∏Ä‰∏™ BeanÔºåËÄåÂàùÂßãÂåñÁöÑËøáÁ®ã‰πüÂ∞ÅË£ÖÂà∞‰∫ÜËøô‰∏™ÊñπÊ≥ïÈáå„ÄÇ getBeanÂú®ÁªßÁª≠ÂâçËøõ‰πãÂâçÔºåËØªËÄÖÂ∫îËØ•ÂÖ∑Â§á FactoryBean ÁöÑÁü•ËØÜÔºåÂ¶ÇÊûúËØªËÄÖËøò‰∏çÁÜüÊÇâÔºåËØ∑ÁßªÊ≠•ÈôÑÂΩïÈÉ®ÂàÜ‰∫ÜËß£ FactoryBean„ÄÇ // AbstractBeanFactory 196 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176@Overridepublic Object getBean(String name) throws BeansException &#123; return doGetBean(name, null, null, false);&#125;// Êàë‰ª¨Âú®ÂâñÊûêÂàùÂßãÂåñ Bean ÁöÑËøáÁ®ãÔºå‰ΩÜÊòØ getBean ÊñπÊ≥ïÊàë‰ª¨ÁªèÂ∏∏ÊòØÁî®Êù•‰ªéÂÆπÂô®‰∏≠Ëé∑Âèñ Bean Áî®ÁöÑÔºåÊ≥®ÊÑèÂàáÊç¢ÊÄùË∑ØÔºå// Â∑≤ÁªèÂàùÂßãÂåñËøá‰∫ÜÂ∞±‰ªéÂÆπÂô®‰∏≠Áõ¥Êé•ËøîÂõûÔºåÂê¶ÂàôÂ∞±ÂÖàÂàùÂßãÂåñÂÜçËøîÂõû@SuppressWarnings("unchecked")protected &lt;T&gt; T doGetBean( final String name, final Class&lt;T&gt; requiredType, final Object[] args, boolean typeCheckOnly) throws BeansException &#123; // Ëé∑Âèñ‰∏Ä‰∏™ ‚ÄúÊ≠£ÁªüÁöÑ‚Äù beanNameÔºåÂ§ÑÁêÜ‰∏§ÁßçÊÉÖÂÜµÔºå‰∏Ä‰∏™ÊòØÂâçÈù¢ËØ¥ÁöÑ FactoryBean(ÂâçÈù¢Â∏¶ ‚Äò&amp;‚Äô)Ôºå // ‰∏Ä‰∏™ÊòØÂà´ÂêçÈóÆÈ¢òÔºåÂõ†‰∏∫Ëøô‰∏™ÊñπÊ≥ïÊòØ getBeanÔºåËé∑Âèñ Bean Áî®ÁöÑÔºå‰Ω†Ë¶ÅÊòØ‰º†‰∏Ä‰∏™Âà´ÂêçËøõÊù•ÔºåÊòØÂÆåÂÖ®ÂèØ‰ª•ÁöÑ final String beanName = transformedBeanName(name); // Ê≥®ÊÑèË∑üÁùÄËøô‰∏™ÔºåËøô‰∏™ÊòØËøîÂõûÂÄº Object bean; // Ê£ÄÊü•‰∏ãÊòØ‰∏çÊòØÂ∑≤ÁªèÂàõÂª∫Ëøá‰∫Ü Object sharedInstance = getSingleton(beanName); // ËøôÈáåËØ¥‰∏ã args ÂëóÔºåËôΩÁÑ∂Áúã‰∏äÂéª‰∏ÄÁÇπ‰∏çÈáçË¶Å„ÄÇÂâçÈù¢Êàë‰ª¨‰∏ÄË∑ØËøõÊù•ÁöÑÊó∂ÂÄôÈÉΩÊòØ getBean(beanName)Ôºå // ÊâÄ‰ª• args ‰º†ÂèÇÂÖ∂ÂÆûÊòØ null ÁöÑÔºå‰ΩÜÊòØÂ¶ÇÊûú args ‰∏ç‰∏∫Á©∫ÁöÑÊó∂ÂÄôÔºåÈÇ£‰πàÊÑèÂë≥ÁùÄË∞ÉÁî®Êñπ‰∏çÊòØÂ∏åÊúõËé∑Âèñ BeanÔºåËÄåÊòØÂàõÂª∫ Bean if (sharedInstance != null &amp;&amp; args == null) &#123; if (logger.isDebugEnabled()) &#123; if (isSingletonCurrentlyInCreation(beanName)) &#123; logger.debug("..."); &#125; else &#123; logger.debug("Returning cached instance of singleton bean '" + beanName + "'"); &#125; &#125; // ‰∏ãÈù¢Ëøô‰∏™ÊñπÊ≥ïÔºöÂ¶ÇÊûúÊòØÊôÆÈÄö Bean ÁöÑËØùÔºåÁõ¥Êé•ËøîÂõû sharedInstanceÔºå // Â¶ÇÊûúÊòØ FactoryBean ÁöÑËØùÔºåËøîÂõûÂÆÉÂàõÂª∫ÁöÑÈÇ£‰∏™ÂÆû‰æãÂØπË±° // (FactoryBean Áü•ËØÜÔºåËØªËÄÖËã•‰∏çÊ∏ÖÊ•öËØ∑ÁßªÊ≠•ÈôÑÂΩï) bean = getObjectForBeanInstance(sharedInstance, name, beanName, null); &#125; else &#123; if (isPrototypeCurrentlyInCreation(beanName)) &#123; // ÂàõÂª∫Ëøá‰∫ÜÊ≠§ beanName ÁöÑ prototype Á±ªÂûãÁöÑ beanÔºåÈÇ£‰πàÊäõÂºÇÂ∏∏Ôºå // ÂæÄÂæÄÊòØÂõ†‰∏∫Èô∑ÂÖ•‰∫ÜÂæ™ÁéØÂºïÁî® throw new BeanCurrentlyInCreationException(beanName); &#125; // Ê£ÄÊü•‰∏Ä‰∏ãËøô‰∏™ BeanDefinition Âú®ÂÆπÂô®‰∏≠ÊòØÂê¶Â≠òÂú® BeanFactory parentBeanFactory = getParentBeanFactory(); if (parentBeanFactory != null &amp;&amp; !containsBeanDefinition(beanName)) &#123; // Â¶ÇÊûúÂΩìÂâçÂÆπÂô®‰∏çÂ≠òÂú®Ëøô‰∏™ BeanDefinitionÔºåËØïËØïÁà∂ÂÆπÂô®‰∏≠ÊúâÊ≤°Êúâ String nameToLookup = originalBeanName(name); if (args != null) &#123; // ËøîÂõûÁà∂ÂÆπÂô®ÁöÑÊü•ËØ¢ÁªìÊûú return (T) parentBeanFactory.getBean(nameToLookup, args); &#125; else &#123; // No args -&gt; delegate to standard getBean method. return parentBeanFactory.getBean(nameToLookup, requiredType); &#125; &#125; if (!typeCheckOnly) &#123; // typeCheckOnly ‰∏∫ falseÔºåÂ∞ÜÂΩìÂâç beanName ÊîæÂÖ•‰∏Ä‰∏™ alreadyCreated ÁöÑ Set ÈõÜÂêà‰∏≠„ÄÇ markBeanAsCreated(beanName); &#125; /* * Á®çÁ®çÊÄªÁªì‰∏Ä‰∏ãÔºö * Âà∞ËøôÈáåÁöÑËØùÔºåË¶ÅÂáÜÂ§áÂàõÂª∫ Bean ‰∫ÜÔºåÂØπ‰∫é singleton ÁöÑ Bean Êù•ËØ¥ÔºåÂÆπÂô®‰∏≠ËøòÊ≤°ÂàõÂª∫ËøáÊ≠§ BeanÔºõ * ÂØπ‰∫é prototype ÁöÑ Bean Êù•ËØ¥ÔºåÊú¨Êù•Â∞±ÊòØË¶ÅÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑ Bean„ÄÇ */ try &#123; final RootBeanDefinition mbd = getMergedLocalBeanDefinition(beanName); checkMergedBeanDefinition(mbd, beanName, args); // ÂÖàÂàùÂßãÂåñ‰æùËµñÁöÑÊâÄÊúâ BeanÔºåËøô‰∏™ÂæàÂ•ΩÁêÜËß£„ÄÇ // Ê≥®ÊÑèÔºåËøôÈáåÁöÑ‰æùËµñÊåáÁöÑÊòØ depends-on ‰∏≠ÂÆö‰πâÁöÑ‰æùËµñ String[] dependsOn = mbd.getDependsOn(); if (dependsOn != null) &#123; for (String dep : dependsOn) &#123; // Ê£ÄÊü•ÊòØ‰∏çÊòØÊúâÂæ™ÁéØ‰æùËµñÔºåËøôÈáåÁöÑÂæ™ÁéØ‰æùËµñÂíåÊàë‰ª¨ÂâçÈù¢ËØ¥ÁöÑÂæ™ÁéØ‰æùËµñÂèà‰∏ç‰∏ÄÊ†∑ÔºåËøôÈáåËÇØÂÆöÊòØ‰∏çÂÖÅËÆ∏Âá∫Áé∞ÁöÑÔºå‰∏çÁÑ∂Ë¶Å‰π±Â•ó‰∫ÜÔºåËØªËÄÖÊÉ≥‰∏Ä‰∏ãÂ∞±Áü•ÈÅì‰∫Ü if (isDependent(beanName, dep)) &#123; throw new BeanCreationException(mbd.getResourceDescription(), beanName, "Circular depends-on relationship between '" + beanName + "' and '" + dep + "'"); &#125; // Ê≥®ÂÜå‰∏Ä‰∏ã‰æùËµñÂÖ≥Á≥ª registerDependentBean(dep, beanName); // ÂÖàÂàùÂßãÂåñË¢´‰æùËµñÈ°π getBean(dep); &#125; &#125; // Â¶ÇÊûúÊòØ singleton scope ÁöÑÔºåÂàõÂª∫ singleton ÁöÑÂÆû‰æã if (mbd.isSingleton()) &#123; sharedInstance = getSingleton(beanName, new ObjectFactory&lt;Object&gt;() &#123; @Override public Object getObject() throws BeansException &#123; try &#123; // ÊâßË°åÂàõÂª∫ BeanÔºåËØ¶ÊÉÖÂêéÈù¢ÂÜçËØ¥ return createBean(beanName, mbd, args); &#125; catch (BeansException ex) &#123; destroySingleton(beanName); throw ex; &#125; &#125; &#125;); bean = getObjectForBeanInstance(sharedInstance, name, beanName, mbd); &#125; // Â¶ÇÊûúÊòØ prototype scope ÁöÑÔºåÂàõÂª∫ prototype ÁöÑÂÆû‰æã else if (mbd.isPrototype()) &#123; // It's a prototype -&gt; create a new instance. Object prototypeInstance = null; try &#123; beforePrototypeCreation(beanName); // ÊâßË°åÂàõÂª∫ Bean prototypeInstance = createBean(beanName, mbd, args); &#125; finally &#123; afterPrototypeCreation(beanName); &#125; bean = getObjectForBeanInstance(prototypeInstance, name, beanName, mbd); &#125; // Â¶ÇÊûú‰∏çÊòØ singleton Âíå prototype ÁöÑËØùÔºåÈúÄË¶ÅÂßîÊâòÁªôÁõ∏Â∫îÁöÑÂÆûÁé∞Á±ªÊù•Â§ÑÁêÜ else &#123; String scopeName = mbd.getScope(); final Scope scope = this.scopes.get(scopeName); if (scope == null) &#123; throw new IllegalStateException("No Scope registered for scope name '" + scopeName + "'"); &#125; try &#123; Object scopedInstance = scope.get(beanName, new ObjectFactory&lt;Object&gt;() &#123; @Override public Object getObject() throws BeansException &#123; beforePrototypeCreation(beanName); try &#123; // ÊâßË°åÂàõÂª∫ Bean return createBean(beanName, mbd, args); &#125; finally &#123; afterPrototypeCreation(beanName); &#125; &#125; &#125;); bean = getObjectForBeanInstance(scopedInstance, name, beanName, mbd); &#125; catch (IllegalStateException ex) &#123; throw new BeanCreationException(beanName, "Scope '" + scopeName + "' is not active for the current thread; consider " + "defining a scoped proxy for this bean if you intend to refer to it from a singleton", ex); &#125; &#125; &#125; catch (BeansException ex) &#123; cleanupAfterBeanCreationFailure(beanName); throw ex; &#125; &#125; // ÊúÄÂêéÔºåÊ£ÄÊü•‰∏Ä‰∏ãÁ±ªÂûãÂØπ‰∏çÂØπÔºå‰∏çÂØπÁöÑËØùÂ∞±ÊäõÂºÇÂ∏∏ÔºåÂØπÁöÑËØùÂ∞±ËøîÂõû‰∫Ü if (requiredType != null &amp;&amp; bean != null &amp;&amp; !requiredType.isInstance(bean)) &#123; try &#123; return getTypeConverter().convertIfNecessary(bean, requiredType); &#125; catch (TypeMismatchException ex) &#123; if (logger.isDebugEnabled()) &#123; logger.debug("Failed to convert bean '" + name + "' to required type '" + ClassUtils.getQualifiedName(requiredType) + "'", ex); &#125; throw new BeanNotOfRequiredTypeException(name, requiredType, bean.getClass()); &#125; &#125; return (T) bean;&#125; Â§ßÂÆ∂Â∫îËØ•‰πüÁåúÂà∞‰∫ÜÔºåÊé•‰∏ãÊù•ÂΩìÁÑ∂ÊòØÂàÜÊûê createBean ÊñπÊ≥ïÔºö 1protected abstract Object createBean(String beanName, RootBeanDefinition mbd, Object[] args) throws BeanCreationException; Á¨¨‰∏â‰∏™ÂèÇÊï∞ args Êï∞ÁªÑ‰ª£Ë°®ÂàõÂª∫ÂÆû‰æãÈúÄË¶ÅÁöÑÂèÇÊï∞Ôºå‰∏çÂ∞±ÊòØÁªôÊûÑÈÄ†ÊñπÊ≥ïÁî®ÁöÑÂèÇÊï∞ÔºåÊàñËÄÖÊòØÂ∑•ÂéÇ Bean ÁöÑÂèÇÊï∞ÂòõÔºå‰∏çËøáË¶ÅÊ≥®ÊÑèÔºåÂú®Êàë‰ª¨ÁöÑÂàùÂßãÂåñÈò∂ÊÆµÔºåargs ÊòØ null„ÄÇ ËøôÂõûÊàë‰ª¨Ë¶ÅÂà∞‰∏Ä‰∏™Êñ∞ÁöÑÁ±ª‰∫Ü AbstractAutowireCapableBeanFactoryÔºåÁúãÁ±ªÂêçÔºåAutowireCapableÔºüÁ±ªÂêçÊòØ‰∏çÊòØ‰πüËØ¥Êòé‰∫ÜÁÇπÈóÆÈ¢ò‰∫Ü„ÄÇ ‰∏ªË¶ÅÊòØ‰∏∫‰∫Ü‰ª•‰∏ãÂú∫ÊôØÔºåÈááÁî® @Autowired Ê≥®Ëß£Ê≥®ÂÖ•Â±ûÊÄßÂÄºÔºö 12345678public class MessageServiceImpl implements MessageService &#123; @Autowired private UserService userService; public String getMessage() &#123; return userService.getMessage(); &#125;&#125; 1&lt;bean id="messageService" class="com.javadoop.example.MessageServiceImpl" /&gt; ‰ª•‰∏äËøôÁßçÂ±û‰∫éÊ∑∑Áî®‰∫Ü xml Âíå Ê≥®Ëß£ ‰∏§ÁßçÊñπÂºèÁöÑÈÖçÁΩÆÊñπÂºèÔºåSpring ‰ºöÂ§ÑÁêÜËøôÁßçÊÉÖÂÜµ„ÄÇ Â•Ω‰∫ÜÔºåËØªËÄÖË¶ÅÁü•ÈÅìËøô‰πàÂõû‰∫ãÂ∞±ÂèØ‰ª•‰∫ÜÔºåÁªßÁª≠ÂêëÂâç„ÄÇ // AbstractAutowireCapableBeanFactory 447 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849/** * Central method of this class: creates a bean instance, * populates the bean instance, applies post-processors, etc. * @see #doCreateBean */@Overrideprotected Object createBean(String beanName, RootBeanDefinition mbd, Object[] args) throws BeanCreationException &#123; if (logger.isDebugEnabled()) &#123; logger.debug("Creating instance of bean '" + beanName + "'"); &#125; RootBeanDefinition mbdToUse = mbd; // Á°Æ‰øù BeanDefinition ‰∏≠ÁöÑ Class Ë¢´Âä†ËΩΩ Class&lt;?&gt; resolvedClass = resolveBeanClass(mbd, beanName); if (resolvedClass != null &amp;&amp; !mbd.hasBeanClass() &amp;&amp; mbd.getBeanClassName() != null) &#123; mbdToUse = new RootBeanDefinition(mbd); mbdToUse.setBeanClass(resolvedClass); &#125; // ÂáÜÂ§áÊñπÊ≥ïË¶ÜÂÜôÔºåËøôÈáåÂèàÊ∂âÂèäÂà∞‰∏Ä‰∏™Ê¶ÇÂøµÔºöMethodOverridesÔºåÂÆÉÊù•Ëá™‰∫é bean ÂÆö‰πâ‰∏≠ÁöÑ &lt;lookup-method /&gt; // Âíå &lt;replaced-method /&gt;ÔºåÂ¶ÇÊûúËØªËÄÖÊÑüÂÖ¥Ë∂£ÔºåÂõûÂà∞ bean Ëß£ÊûêÁöÑÂú∞ÊñπÁúãÁúãÂØπËøô‰∏§‰∏™Ê†áÁ≠æÁöÑËß£Êûê„ÄÇ // ÊàëÂú®ÈôÑÂΩï‰∏≠‰πüÂØπËøô‰∏§‰∏™Ê†áÁ≠æÁöÑÁõ∏ÂÖ≥Áü•ËØÜÁÇπËøõË°å‰∫Ü‰ªãÁªçÔºåËØªËÄÖÂèØ‰ª•ÁßªÊ≠•ÂéªÁúãÁúã try &#123; mbdToUse.prepareMethodOverrides(); &#125; catch (BeanDefinitionValidationException ex) &#123; throw new BeanDefinitionStoreException(mbdToUse.getResourceDescription(), beanName, "Validation of method overrides failed", ex); &#125; try &#123; // ËÆ© InstantiationAwareBeanPostProcessor Âú®Ëøô‰∏ÄÊ≠•ÊúâÊú∫‰ºöËøîÂõû‰ª£ÁêÜÔºå // Âú® „ÄäSpring AOP Ê∫êÁ†ÅÂàÜÊûê„ÄãÈÇ£ÁØáÊñáÁ´†‰∏≠ÊúâËß£ÈáäÔºåËøôÈáåÂÖàË∑≥Ëøá Object bean = resolveBeforeInstantiation(beanName, mbdToUse); if (bean != null) &#123; return bean; &#125; &#125; catch (Throwable ex) &#123; throw new BeanCreationException(mbdToUse.getResourceDescription(), beanName, "BeanPostProcessor before instantiation of bean failed", ex); &#125; // ÈáçÂ§¥ÊàèÔºåÂàõÂª∫ bean Object beanInstance = doCreateBean(beanName, mbdToUse, args); if (logger.isDebugEnabled()) &#123; logger.debug("Finished creating instance of bean '" + beanName + "'"); &#125; return beanInstance;&#125; ÂàõÂª∫ BeanÊàë‰ª¨ÁªßÁª≠ÂæÄÈáåÁúã doCreateBean Ëøô‰∏™ÊñπÊ≥ïÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125/** * Actually create the specified bean. Pre-creation processing has already happened * at this point, e.g. checking &#123;@code postProcessBeforeInstantiation&#125; callbacks. * &lt;p&gt;Differentiates between default bean instantiation, use of a * factory method, and autowiring a constructor. * @param beanName the name of the bean * @param mbd the merged bean definition for the bean * @param args explicit arguments to use for constructor or factory method invocation * @return a new instance of the bean * @throws BeanCreationException if the bean could not be created * @see #instantiateBean * @see #instantiateUsingFactoryMethod * @see #autowireConstructor */protected Object doCreateBean(final String beanName, final RootBeanDefinition mbd, final Object[] args) throws BeanCreationException &#123; // Instantiate the bean. BeanWrapper instanceWrapper = null; if (mbd.isSingleton()) &#123; instanceWrapper = this.factoryBeanInstanceCache.remove(beanName); &#125; if (instanceWrapper == null) &#123; // ËØ¥Êòé‰∏çÊòØ FactoryBeanÔºåËøôÈáåÂÆû‰æãÂåñ BeanÔºåËøôÈáåÈùûÂ∏∏ÂÖ≥ÈîÆÔºåÁªÜËäÇ‰πãÂêéÂÜçËØ¥ instanceWrapper = createBeanInstance(beanName, mbd, args); &#125; // Ëøô‰∏™Â∞±ÊòØ Bean ÈáåÈù¢ÁöÑ Êàë‰ª¨ÂÆö‰πâÁöÑÁ±ª ÁöÑÂÆû‰æãÔºåÂæàÂ§öÂú∞ÊñπÊàëÁõ¥Êé•ÊèèËø∞Êàê "bean ÂÆû‰æã" final Object bean = (instanceWrapper != null ? instanceWrapper.getWrappedInstance() : null); // Á±ªÂûã Class&lt;?&gt; beanType = (instanceWrapper != null ? instanceWrapper.getWrappedClass() : null); mbd.resolvedTargetType = beanType; // Âª∫ËÆÆË∑≥ËøáÂêßÔºåÊ∂âÂèäÊé•Âè£ÔºöMergedBeanDefinitionPostProcessor synchronized (mbd.postProcessingLock) &#123; if (!mbd.postProcessed) &#123; try &#123; // MergedBeanDefinitionPostProcessorÔºåËøô‰∏™ÊàëÁúü‰∏çÂ±ïÂºÄËØ¥‰∫ÜÔºåÁõ¥Êé•Ë∑≥ËøáÂêßÔºåÂæàÂ∞ëÁî®ÁöÑ applyMergedBeanDefinitionPostProcessors(mbd, beanType, beanName); &#125; catch (Throwable ex) &#123; throw new BeanCreationException(mbd.getResourceDescription(), beanName, "Post-processing of merged bean definition failed", ex); &#125; mbd.postProcessed = true; &#125; &#125; // Eagerly cache singletons to be able to resolve circular references // even when triggered by lifecycle interfaces like BeanFactoryAware. // ‰∏ãÈù¢ËøôÂùó‰ª£Á†ÅÊòØ‰∏∫‰∫ÜËß£ÂÜ≥Âæ™ÁéØ‰æùËµñÁöÑÈóÆÈ¢òÔºå‰ª•ÂêéÊúâÊó∂Èó¥ÔºåÊàëÂÜçÂØπÂæ™ÁéØ‰æùËµñËøô‰∏™ÈóÆÈ¢òËøõË°åËß£ÊûêÂêß boolean earlySingletonExposure = (mbd.isSingleton() &amp;&amp; this.allowCircularReferences &amp;&amp; isSingletonCurrentlyInCreation(beanName)); if (earlySingletonExposure) &#123; if (logger.isDebugEnabled()) &#123; logger.debug("Eagerly caching bean '" + beanName + "' to allow for resolving potential circular references"); &#125; addSingletonFactory(beanName, new ObjectFactory&lt;Object&gt;() &#123; @Override public Object getObject() throws BeansException &#123; return getEarlyBeanReference(beanName, mbd, bean); &#125; &#125;); &#125; // Initialize the bean instance. Object exposedObject = bean; try &#123; // Ëøô‰∏ÄÊ≠•‰πüÊòØÈùûÂ∏∏ÂÖ≥ÈîÆÁöÑÔºåËøô‰∏ÄÊ≠•Ë¥üË¥£Â±ûÊÄßË£ÖÈÖçÔºåÂõ†‰∏∫ÂâçÈù¢ÁöÑÂÆû‰æãÂè™ÊòØÂÆû‰æãÂåñ‰∫ÜÔºåÂπ∂Ê≤°ÊúâËÆæÂÄºÔºåËøôÈáåÂ∞±ÊòØËÆæÂÄº populateBean(beanName, mbd, instanceWrapper); if (exposedObject != null) &#123; // ËøòËÆ∞Âæó init-method ÂêóÔºüËøòÊúâ InitializingBean Êé•Âè£ÔºüËøòÊúâ BeanPostProcessor Êé•Âè£Ôºü // ËøôÈáåÂ∞±ÊòØÂ§ÑÁêÜ bean ÂàùÂßãÂåñÂÆåÊàêÂêéÁöÑÂêÑÁßçÂõûË∞É exposedObject = initializeBean(beanName, exposedObject, mbd); &#125; &#125; catch (Throwable ex) &#123; if (ex instanceof BeanCreationException &amp;&amp; beanName.equals(((BeanCreationException) ex).getBeanName())) &#123; throw (BeanCreationException) ex; &#125; else &#123; throw new BeanCreationException( mbd.getResourceDescription(), beanName, "Initialization of bean failed", ex); &#125; &#125; if (earlySingletonExposure) &#123; // Object earlySingletonReference = getSingleton(beanName, false); if (earlySingletonReference != null) &#123; if (exposedObject == bean) &#123; exposedObject = earlySingletonReference; &#125; else if (!this.allowRawInjectionDespiteWrapping &amp;&amp; hasDependentBean(beanName)) &#123; String[] dependentBeans = getDependentBeans(beanName); Set&lt;String&gt; actualDependentBeans = new LinkedHashSet&lt;String&gt;(dependentBeans.length); for (String dependentBean : dependentBeans) &#123; if (!removeSingletonIfCreatedForTypeCheckOnly(dependentBean)) &#123; actualDependentBeans.add(dependentBean); &#125; &#125; if (!actualDependentBeans.isEmpty()) &#123; throw new BeanCurrentlyInCreationException(beanName, "Bean with name '" + beanName + "' has been injected into other beans [" + StringUtils.collectionToCommaDelimitedString(actualDependentBeans) + "] in its raw version as part of a circular reference, but has eventually been " + "wrapped. This means that said other beans do not use the final version of the " + "bean. This is often the result of over-eager type matching - consider using " + "'getBeanNamesOfType' with the 'allowEagerInit' flag turned off, for example."); &#125; &#125; &#125; &#125; // Register bean as disposable. try &#123; registerDisposableBeanIfNecessary(beanName, bean, mbd); &#125; catch (BeanDefinitionValidationException ex) &#123; throw new BeanCreationException( mbd.getResourceDescription(), beanName, "Invalid destruction signature", ex); &#125; return exposedObject;&#125; Âà∞ËøôÈáåÔºåÊàë‰ª¨Â∑≤ÁªèÂàÜÊûêÂÆå‰∫Ü doCreateBean ÊñπÊ≥ïÔºåÊÄªÁöÑÊù•ËØ¥ÔºåÊàë‰ª¨Â∑≤ÁªèËØ¥ÂÆå‰∫ÜÊï¥‰∏™ÂàùÂßãÂåñÊµÅÁ®ã„ÄÇ Êé•‰∏ãÊù•Êàë‰ª¨Êåë doCreateBean ‰∏≠ÁöÑ‰∏â‰∏™ÁªÜËäÇÂá∫Êù•ËØ¥ËØ¥„ÄÇ‰∏Ä‰∏™ÊòØÂàõÂª∫ Bean ÂÆû‰æãÁöÑ createBeanInstance ÊñπÊ≥ïÔºå‰∏Ä‰∏™ÊòØ‰æùËµñÊ≥®ÂÖ•ÁöÑ populateBean ÊñπÊ≥ïÔºåËøòÊúâÂ∞±ÊòØÂõûË∞ÉÊñπÊ≥ï initializeBean„ÄÇ Ê≥®ÊÑè‰∫ÜÔºåÊé•‰∏ãÊù•ÁöÑËøô‰∏â‰∏™ÊñπÊ≥ïË¶ÅËÆ§ÁúüËØ¥ÈÇ£‰πüÊòØÊûÅÂÖ∂Â§çÊùÇÁöÑÔºåÂæàÂ§öÂú∞ÊñπÊàëÂ∞±ÁÇπÂà∞‰∏∫Ê≠¢‰∫ÜÔºåÊÑüÂÖ¥Ë∂£ÁöÑËØªËÄÖÂèØ‰ª•Ëá™Â∑±ÂæÄÈáåÁúãÔºåÊúÄÂ•ΩÂ∞±ÊòØÁ¢∞Âà∞‰∏çÊáÇÁöÑÔºåËá™Â∑±ÂÜô‰ª£Á†ÅÂéªË∞ÉËØïÂÆÉ„ÄÇ ÂàõÂª∫ Bean ÂÆû‰æãÊàë‰ª¨ÂÖàÁúãÁúã createBeanInstance ÊñπÊ≥ï„ÄÇÈúÄË¶ÅËØ¥ÊòéÁöÑÊòØÔºåËøô‰∏™ÊñπÊ≥ïÂ¶ÇÊûúÊØè‰∏™ÂàÜÊîØÈÉΩÂàÜÊûê‰∏ãÂéªÔºåÂøÖÁÑ∂‰πüÊòØÊûÅÂÖ∂Â§çÊùÇÂÜóÈïøÁöÑÔºåÊàë‰ª¨ÊåëÈáçÁÇπËØ¥„ÄÇÊ≠§ÊñπÊ≥ïÁöÑÁõÆÁöÑÂ∞±ÊòØÂÆû‰æãÂåñÊàë‰ª¨ÊåáÂÆöÁöÑÁ±ª„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950protected BeanWrapper createBeanInstance(String beanName, RootBeanDefinition mbd, Object[] args) &#123; // Á°Æ‰øùÂ∑≤ÁªèÂä†ËΩΩ‰∫ÜÊ≠§ class Class&lt;?&gt; beanClass = resolveBeanClass(mbd, beanName); // Ê†°È™å‰∏Ä‰∏ãËøô‰∏™Á±ªÁöÑËÆøÈóÆÊùÉÈôê if (beanClass != null &amp;&amp; !Modifier.isPublic(beanClass.getModifiers()) &amp;&amp; !mbd.isNonPublicAccessAllowed()) &#123; throw new BeanCreationException(mbd.getResourceDescription(), beanName, "Bean class isn't public, and non-public access not allowed: " + beanClass.getName()); &#125; if (mbd.getFactoryMethodName() != null) &#123; // ÈááÁî®Â∑•ÂéÇÊñπÊ≥ïÂÆû‰æãÂåñÔºå‰∏çÁÜüÊÇâËøô‰∏™Ê¶ÇÂøµÁöÑËØªËÄÖËØ∑ÁúãÈôÑÂΩïÔºåÊ≥®ÊÑèÔºå‰∏çÊòØ FactoryBean return instantiateUsingFactoryMethod(beanName, mbd, args); &#125; // Â¶ÇÊûú‰∏çÊòØÁ¨¨‰∏ÄÊ¨°ÂàõÂª∫ÔºåÊØîÂ¶ÇÁ¨¨‰∫åÊ¨°ÂàõÂª∫ prototype bean„ÄÇ // ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÂèØ‰ª•‰ªéÁ¨¨‰∏ÄÊ¨°ÂàõÂª∫Áü•ÈÅìÔºåÈááÁî®Êó†ÂèÇÊûÑÈÄ†ÂáΩÊï∞ÔºåËøòÊòØÊûÑÈÄ†ÂáΩÊï∞‰æùËµñÊ≥®ÂÖ• Êù•ÂÆåÊàêÂÆû‰æãÂåñ boolean resolved = false; boolean autowireNecessary = false; if (args == null) &#123; synchronized (mbd.constructorArgumentLock) &#123; if (mbd.resolvedConstructorOrFactoryMethod != null) &#123; resolved = true; autowireNecessary = mbd.constructorArgumentsResolved; &#125; &#125; &#125; if (resolved) &#123; if (autowireNecessary) &#123; // ÊûÑÈÄ†ÂáΩÊï∞‰æùËµñÊ≥®ÂÖ• return autowireConstructor(beanName, mbd, null, null); &#125; else &#123; // Êó†ÂèÇÊûÑÈÄ†ÂáΩÊï∞ return instantiateBean(beanName, mbd); &#125; &#125; // Âà§Êñ≠ÊòØÂê¶ÈááÁî®ÊúâÂèÇÊûÑÈÄ†ÂáΩÊï∞ Constructor&lt;?&gt;[] ctors = determineConstructorsFromBeanPostProcessors(beanClass, beanName); if (ctors != null || mbd.getResolvedAutowireMode() == RootBeanDefinition.AUTOWIRE_CONSTRUCTOR || mbd.hasConstructorArgumentValues() || !ObjectUtils.isEmpty(args)) &#123; // ÊûÑÈÄ†ÂáΩÊï∞‰æùËµñÊ≥®ÂÖ• return autowireConstructor(beanName, mbd, ctors, args); &#125; // Ë∞ÉÁî®Êó†ÂèÇÊûÑÈÄ†ÂáΩÊï∞ return instantiateBean(beanName, mbd);&#125; Êåë‰∏™ÁÆÄÂçïÁöÑÊó†ÂèÇÊûÑÈÄ†ÂáΩÊï∞ÊûÑÈÄ†ÂÆû‰æãÊù•ÁúãÁúãÔºö 123456789101112131415161718192021222324252627protected BeanWrapper instantiateBean(final String beanName, final RootBeanDefinition mbd) &#123; try &#123; Object beanInstance; final BeanFactory parent = this; if (System.getSecurityManager() != null) &#123; beanInstance = AccessController.doPrivileged(new PrivilegedAction&lt;Object&gt;() &#123; @Override public Object run() &#123; return getInstantiationStrategy().instantiate(mbd, beanName, parent); &#125; &#125;, getAccessControlContext()); &#125; else &#123; // ÂÆû‰æãÂåñ beanInstance = getInstantiationStrategy().instantiate(mbd, beanName, parent); &#125; // ÂåÖË£Ö‰∏Ä‰∏ãÔºåËøîÂõû BeanWrapper bw = new BeanWrapperImpl(beanInstance); initBeanWrapper(bw); return bw; &#125; catch (Throwable ex) &#123; throw new BeanCreationException( mbd.getResourceDescription(), beanName, "Instantiation of bean failed", ex); &#125;&#125; Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÔºåÂÖ≥ÈîÆÁöÑÂú∞ÊñπÂú®‰∫éÔºö 1beanInstance = getInstantiationStrategy().instantiate(mbd, beanName, parent); ËøôÈáå‰ºöËøõË°åÂÆûÈôÖÁöÑÂÆû‰æãÂåñËøáÁ®ãÔºåÊàë‰ª¨ËøõÂéªÁúãÁúã: // SimpleInstantiationStrategy 59 123456789101112131415161718192021222324252627282930313233343536373839404142@Overridepublic Object instantiate(RootBeanDefinition bd, String beanName, BeanFactory owner) &#123; // Â¶ÇÊûú‰∏çÂ≠òÂú®ÊñπÊ≥ïË¶ÜÂÜôÔºåÈÇ£Â∞±‰ΩøÁî® java ÂèçÂ∞ÑËøõË°åÂÆû‰æãÂåñÔºåÂê¶Âàô‰ΩøÁî® CGLIB, // ÊñπÊ≥ïË¶ÜÂÜô ËØ∑ÂèÇËßÅÈôÑÂΩï"ÊñπÊ≥ïÊ≥®ÂÖ•"‰∏≠ÂØπ lookup-method Âíå replaced-method ÁöÑ‰ªãÁªç if (bd.getMethodOverrides().isEmpty()) &#123; Constructor&lt;?&gt; constructorToUse; synchronized (bd.constructorArgumentLock) &#123; constructorToUse = (Constructor&lt;?&gt;) bd.resolvedConstructorOrFactoryMethod; if (constructorToUse == null) &#123; final Class&lt;?&gt; clazz = bd.getBeanClass(); if (clazz.isInterface()) &#123; throw new BeanInstantiationException(clazz, "Specified class is an interface"); &#125; try &#123; if (System.getSecurityManager() != null) &#123; constructorToUse = AccessController.doPrivileged(new PrivilegedExceptionAction&lt;Constructor&lt;?&gt;&gt;() &#123; @Override public Constructor&lt;?&gt; run() throws Exception &#123; return clazz.getDeclaredConstructor((Class[]) null); &#125; &#125;); &#125; else &#123; constructorToUse = clazz.getDeclaredConstructor((Class[]) null); &#125; bd.resolvedConstructorOrFactoryMethod = constructorToUse; &#125; catch (Throwable ex) &#123; throw new BeanInstantiationException(clazz, "No default constructor found", ex); &#125; &#125; &#125; // Âà©Áî®ÊûÑÈÄ†ÊñπÊ≥ïËøõË°åÂÆû‰æãÂåñ return BeanUtils.instantiateClass(constructorToUse); &#125; else &#123; // Â≠òÂú®ÊñπÊ≥ïË¶ÜÂÜôÔºåÂà©Áî® CGLIB Êù•ÂÆåÊàêÂÆû‰æãÂåñÔºåÈúÄË¶Å‰æùËµñ‰∫é CGLIB ÁîüÊàêÂ≠êÁ±ªÔºåËøôÈáåÂ∞±‰∏çÂ±ïÂºÄ‰∫Ü„ÄÇ // tips: Âõ†‰∏∫Â¶ÇÊûú‰∏ç‰ΩøÁî® CGLIB ÁöÑËØùÔºåÂ≠òÂú® override ÁöÑÊÉÖÂÜµ JDK Âπ∂Ê≤°ÊúâÊèê‰æõÁõ∏Â∫îÁöÑÂÆû‰æãÂåñÊîØÊåÅ return instantiateWithMethodInjection(bd, beanName, owner); &#125;&#125; Âà∞ËøôÈáåÔºåÊàë‰ª¨Â∞±ÁÆóÂÆû‰æãÂåñÂÆåÊàê‰∫Ü„ÄÇÊàë‰ª¨ÂºÄÂßãËØ¥ÊÄé‰πàËøõË°åÂ±ûÊÄßÊ≥®ÂÖ•„ÄÇ bean Â±ûÊÄßÊ≥®ÂÖ•ÁúãÂÆå‰∫Ü createBeanInstance(‚Ä¶) ÊñπÊ≥ïÔºåÊàë‰ª¨Êù•ÁúãÁúã populateBean(‚Ä¶) ÊñπÊ≥ïÔºåËØ•ÊñπÊ≥ïË¥üË¥£ËøõË°åÂ±ûÊÄßËÆæÂÄºÔºåÂ§ÑÁêÜ‰æùËµñ„ÄÇ // AbstractAutowireCapableBeanFactory 1203 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778protected void populateBean(String beanName, RootBeanDefinition mbd, BeanWrapper bw) &#123; // bean ÂÆû‰æãÁöÑÊâÄÊúâÂ±ûÊÄßÈÉΩÂú®ËøôÈáå‰∫Ü PropertyValues pvs = mbd.getPropertyValues(); if (bw == null) &#123; if (!pvs.isEmpty()) &#123; throw new BeanCreationException( mbd.getResourceDescription(), beanName, "Cannot apply property values to null instance"); &#125; else &#123; // Skip property population phase for null instance. return; &#125; &#125; // Âà∞ËøôÊ≠•ÁöÑÊó∂ÂÄôÔºåbean ÂÆû‰æãÂåñÂÆåÊàêÔºàÈÄöËøáÂ∑•ÂéÇÊñπÊ≥ïÊàñÊûÑÈÄ†ÊñπÊ≥ïÔºâÔºå‰ΩÜÊòØËøòÊ≤°ÂºÄÂßãÂ±ûÊÄßËÆæÂÄºÔºå // InstantiationAwareBeanPostProcessor ÁöÑÂÆûÁé∞Á±ªÂèØ‰ª•Âú®ËøôÈáåÂØπ bean ËøõË°åÁä∂ÊÄÅ‰øÆÊîπÔºå // Êàë‰πüÊ≤°ÊâæÂà∞ÊúâÂÆûÈôÖÁöÑ‰ΩøÁî®ÔºåÊâÄ‰ª•Êàë‰ª¨ÊöÇ‰∏îÂøΩÁï•ËøôÂùóÂêß boolean continueWithPropertyPopulation = true; if (!mbd.isSynthetic() &amp;&amp; hasInstantiationAwareBeanPostProcessors()) &#123; for (BeanPostProcessor bp : getBeanPostProcessors()) &#123; if (bp instanceof InstantiationAwareBeanPostProcessor) &#123; InstantiationAwareBeanPostProcessor ibp = (InstantiationAwareBeanPostProcessor) bp; // Â¶ÇÊûúËøîÂõû falseÔºå‰ª£Ë°®‰∏çÈúÄË¶ÅËøõË°åÂêéÁª≠ÁöÑÂ±ûÊÄßËÆæÂÄºÔºå‰πü‰∏çÈúÄË¶ÅÂÜçÁªèËøáÂÖ∂‰ªñÁöÑ BeanPostProcessor ÁöÑÂ§ÑÁêÜ if (!ibp.postProcessAfterInstantiation(bw.getWrappedInstance(), beanName)) &#123; continueWithPropertyPopulation = false; break; &#125; &#125; &#125; &#125; if (!continueWithPropertyPopulation) &#123; return; &#125; if (mbd.getResolvedAutowireMode() == RootBeanDefinition.AUTOWIRE_BY_NAME || mbd.getResolvedAutowireMode() == RootBeanDefinition.AUTOWIRE_BY_TYPE) &#123; MutablePropertyValues newPvs = new MutablePropertyValues(pvs); // ÈÄöËøáÂêçÂ≠óÊâæÂà∞ÊâÄÊúâÂ±ûÊÄßÂÄºÔºåÂ¶ÇÊûúÊòØ bean ‰æùËµñÔºåÂÖàÂàùÂßãÂåñ‰æùËµñÁöÑ bean„ÄÇËÆ∞ÂΩï‰æùËµñÂÖ≥Á≥ª if (mbd.getResolvedAutowireMode() == RootBeanDefinition.AUTOWIRE_BY_NAME) &#123; autowireByName(beanName, mbd, bw, newPvs); &#125; // ÈÄöËøáÁ±ªÂûãË£ÖÈÖç„ÄÇÂ§çÊùÇ‰∏Ä‰∫õ if (mbd.getResolvedAutowireMode() == RootBeanDefinition.AUTOWIRE_BY_TYPE) &#123; autowireByType(beanName, mbd, bw, newPvs); &#125; pvs = newPvs; &#125; boolean hasInstAwareBpps = hasInstantiationAwareBeanPostProcessors(); boolean needsDepCheck = (mbd.getDependencyCheck() != RootBeanDefinition.DEPENDENCY_CHECK_NONE); if (hasInstAwareBpps || needsDepCheck) &#123; PropertyDescriptor[] filteredPds = filterPropertyDescriptorsForDependencyCheck(bw, mbd.allowCaching); if (hasInstAwareBpps) &#123; for (BeanPostProcessor bp : getBeanPostProcessors()) &#123; if (bp instanceof InstantiationAwareBeanPostProcessor) &#123; InstantiationAwareBeanPostProcessor ibp = (InstantiationAwareBeanPostProcessor) bp; // ËøôÈáåÊúâ‰∏™ÈùûÂ∏∏ÊúâÁî®ÁöÑ BeanPostProcessor ËøõÂà∞ËøôÈáå: AutowiredAnnotationBeanPostProcessor // ÂØπÈááÁî® @Autowired„ÄÅ@Value Ê≥®Ëß£ÁöÑ‰æùËµñËøõË°åËÆæÂÄºÔºåËøôÈáåÁöÑÂÜÖÂÆπ‰πüÊòØÈùûÂ∏∏‰∏∞ÂØåÁöÑÔºå‰∏çËøáÊú¨Êñá‰∏ç‰ºöÂ±ïÂºÄËØ¥‰∫ÜÔºåÊÑüÂÖ¥Ë∂£ÁöÑËØªËÄÖËØ∑Ëá™Ë°åÁ†îÁ©∂ pvs = ibp.postProcessPropertyValues(pvs, filteredPds, bw.getWrappedInstance(), beanName); if (pvs == null) &#123; return; &#125; &#125; &#125; &#125; if (needsDepCheck) &#123; checkDependencies(beanName, mbd, filteredPds, pvs); &#125; &#125; // ËÆæÁΩÆ bean ÂÆû‰æãÁöÑÂ±ûÊÄßÂÄº applyPropertyValues(beanName, mbd, bw, pvs);&#125; initializeBeanÂ±ûÊÄßÊ≥®ÂÖ•ÂÆåÊàêÂêéÔºåËøô‰∏ÄÊ≠•ÂÖ∂ÂÆûÂ∞±ÊòØÂ§ÑÁêÜÂêÑÁßçÂõûË∞É‰∫ÜÔºåËøôÂùó‰ª£Á†ÅÊØîËæÉÁÆÄÂçï„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738protected Object initializeBean(final String beanName, final Object bean, RootBeanDefinition mbd) &#123; if (System.getSecurityManager() != null) &#123; AccessController.doPrivileged(new PrivilegedAction&lt;Object&gt;() &#123; @Override public Object run() &#123; invokeAwareMethods(beanName, bean); return null; &#125; &#125;, getAccessControlContext()); &#125; else &#123; // Â¶ÇÊûú bean ÂÆûÁé∞‰∫Ü BeanNameAware„ÄÅBeanClassLoaderAware Êàñ BeanFactoryAware Êé•Âè£ÔºåÂõûË∞É invokeAwareMethods(beanName, bean); &#125; Object wrappedBean = bean; if (mbd == null || !mbd.isSynthetic()) &#123; // BeanPostProcessor ÁöÑ postProcessBeforeInitialization ÂõûË∞É wrappedBean = applyBeanPostProcessorsBeforeInitialization(wrappedBean, beanName); &#125; try &#123; // Â§ÑÁêÜ bean ‰∏≠ÂÆö‰πâÁöÑ init-methodÔºå // ÊàñËÄÖÂ¶ÇÊûú bean ÂÆûÁé∞‰∫Ü InitializingBean Êé•Âè£ÔºåË∞ÉÁî® afterPropertiesSet() ÊñπÊ≥ï invokeInitMethods(beanName, wrappedBean, mbd); &#125; catch (Throwable ex) &#123; throw new BeanCreationException( (mbd != null ? mbd.getResourceDescription() : null), beanName, "Invocation of init method failed", ex); &#125; if (mbd == null || !mbd.isSynthetic()) &#123; // BeanPostProcessor ÁöÑ postProcessAfterInitialization ÂõûË∞É wrappedBean = applyBeanPostProcessorsAfterInitialization(wrappedBean, beanName); &#125; return wrappedBean;&#125; Â§ßÂÆ∂ÂèëÁé∞Ê≤°ÊúâÔºåBeanPostProcessor ÁöÑ‰∏§‰∏™ÂõûË∞ÉÈÉΩÂèëÁîüÂú®ËøôËæπÔºåÂè™‰∏çËøá‰∏≠Èó¥Â§ÑÁêÜ‰∫Ü init-methodÔºåÊòØ‰∏çÊòØÂíåËØªËÄÖÂéüÊù•ÁöÑËÆ§Áü•ÊúâÁÇπ‰∏ç‰∏ÄÊ†∑‰∫ÜÔºü ÈôÑÂΩïid Âíå nameÊØè‰∏™ Bean Âú® Spring ÂÆπÂô®‰∏≠ÈÉΩÊúâ‰∏Ä‰∏™ÂîØ‰∏ÄÁöÑÂêçÂ≠óÔºàbeanNameÔºâÂíå 0 ‰∏™ÊàñÂ§ö‰∏™Âà´ÂêçÔºàaliasesÔºâ„ÄÇ Êàë‰ª¨‰ªé Spring ÂÆπÂô®‰∏≠Ëé∑Âèñ Bean ÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•Ê†πÊçÆ beanNameÔºå‰πüÂèØ‰ª•ÈÄöËøáÂà´Âêç„ÄÇ 1beanFactory.getBean("beanName or alias"); Âú®ÈÖçÁΩÆ &lt;bean /&gt; ÁöÑËøáÁ®ã‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÈÖçÁΩÆ id Âíå nameÔºåÁúãÂá†‰∏™‰æãÂ≠êÂ∞±Áü•ÈÅìÊòØÊÄé‰πàÂõû‰∫ã‰∫Ü„ÄÇ 1&lt;bean id="messageService" name="m1, m2, m3" class="com.javadoop.example.MessageServiceImpl"&gt; ‰ª•‰∏äÈÖçÁΩÆÁöÑÁªìÊûúÂ∞±ÊòØÔºöbeanName ‰∏∫ messageServiceÔºåÂà´ÂêçÊúâ 3 ‰∏™ÔºåÂàÜÂà´‰∏∫ m1„ÄÅm2„ÄÅm3„ÄÇ 1&lt;bean name="m1, m2, m3" class="com.javadoop.example.MessageServiceImpl" /&gt; ‰ª•‰∏äÈÖçÁΩÆÁöÑÁªìÊûúÂ∞±ÊòØÔºöbeanName ‰∏∫ m1ÔºåÂà´ÂêçÊúâ 2 ‰∏™ÔºåÂàÜÂà´‰∏∫ m2„ÄÅm3„ÄÇ 1&lt;bean class="com.javadoop.example.MessageServiceImpl"&gt; beanName ‰∏∫Ôºöcom.javadoop.example.MessageServiceImpl#0Ôºå Âà´Âêç 1 ‰∏™Ôºå‰∏∫Ôºö com.javadoop.example.MessageServiceImpl 1&lt;bean id="messageService" class="com.javadoop.example.MessageServiceImpl"&gt; ‰ª•‰∏äÈÖçÁΩÆÁöÑÁªìÊûúÂ∞±ÊòØÔºöbeanName ‰∏∫ messageServiceÔºåÊ≤°ÊúâÂà´Âêç„ÄÇ ÈÖçÁΩÆÊòØÂê¶ÂÖÅËÆ∏ Bean Ë¶ÜÁõñ„ÄÅÊòØÂê¶ÂÖÅËÆ∏Âæ™ÁéØ‰æùËµñÊàë‰ª¨ËØ¥ËøáÔºåÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåallowBeanDefinitionOverriding Â±ûÊÄß‰∏∫ null„ÄÇÂ¶ÇÊûúÂú®Âêå‰∏ÄÈÖçÁΩÆÊñá‰ª∂‰∏≠ Bean id Êàñ name ÈáçÂ§ç‰∫ÜÔºå‰ºöÊäõÈîôÔºå‰ΩÜÊòØÂ¶ÇÊûú‰∏çÊòØÂêå‰∏ÄÈÖçÁΩÆÊñá‰ª∂‰∏≠Ôºå‰ºöÂèëÁîüË¶ÜÁõñ„ÄÇ ÂèØÊòØÊúâ‰∫õÊó∂ÂÄôÊàë‰ª¨Â∏åÊúõÂú®Á≥ªÁªüÂêØÂä®ÁöÑËøáÁ®ã‰∏≠Â∞±‰∏•Ê†ºÊùúÁªùÂèëÁîü Bean Ë¶ÜÁõñÔºåÂõ†‰∏∫‰∏á‰∏ÄÂá∫Áé∞ËøôÁßçÊÉÖÂÜµÔºå‰ºöÂ¢ûÂä†Êàë‰ª¨ÊéíÊü•ÈóÆÈ¢òÁöÑÊàêÊú¨„ÄÇ Âæ™ÁéØ‰æùËµñËØ¥ÁöÑÊòØ A ‰æùËµñ BÔºåËÄå B Âèà‰æùËµñ A„ÄÇÊàñËÄÖÊòØ A ‰æùËµñ BÔºåB ‰æùËµñ CÔºåËÄå C Âç¥‰æùËµñ A„ÄÇÈªòËÆ§ allowCircularReferences ‰πüÊòØ null„ÄÇ ÂÆÉ‰ª¨‰∏§‰∏™Â±ûÊÄßÊòØ‰∏ÄËµ∑Âá∫Áé∞ÁöÑÔºåÂøÖÁÑ∂ÂèØ‰ª•Âú®Âêå‰∏Ä‰∏™Âú∞Êñπ‰∏ÄËµ∑ËøõË°åÈÖçÁΩÆ„ÄÇ Ê∑ªÂä†Ëøô‰∏§‰∏™Â±ûÊÄßÁöÑ‰ΩúËÄÖ Juergen Hoeller Âú®Ëøô‰∏™ jira ÁöÑËÆ®ËÆ∫‰∏≠ËØ¥Êòé‰∫ÜÊÄé‰πàÈÖçÁΩÆËøô‰∏§‰∏™Â±ûÊÄß„ÄÇ 123456789public class NoBeanOverridingContextLoader extends ContextLoader &#123; @Override protected void customizeContext(ServletContext servletContext, ConfigurableWebApplicationContext applicationContext) &#123; super.customizeContext(servletContext, applicationContext); AbstractRefreshableApplicationContext arac = (AbstractRefreshableApplicationContext) applicationContext; arac.setAllowBeanDefinitionOverriding(false); &#125;&#125; 12345678public class MyContextLoaderListener extends org.springframework.web.context.ContextLoaderListener &#123; @Override protected ContextLoader createContextLoader() &#123; return new NoBeanOverridingContextLoader(); &#125; &#125; 123&lt;listener&gt; &lt;listener-class&gt;com.javadoop.MyContextLoaderListener&lt;/listener-class&gt; &lt;/listener&gt; Â¶ÇÊûú‰ª•‰∏äÊñπÂºè‰∏çËÉΩÊª°Ë∂≥‰Ω†ÁöÑÈúÄÊ±ÇÔºåËØ∑ÂèÇËÄÉËøô‰∏™ÈìæÊé•ÔºöËß£ÂÜ≥spring‰∏≠‰∏çÂêåÈÖçÁΩÆÊñá‰ª∂‰∏≠Â≠òÂú®nameÊàñËÄÖidÁõ∏ÂêåÁöÑbeanÂèØËÉΩÂºïËµ∑ÁöÑÈóÆÈ¢ò profileÊàë‰ª¨ÂèØ‰ª•Êää‰∏çÂêåÁéØÂ¢ÉÁöÑÈÖçÁΩÆÂàÜÂà´ÈÖçÁΩÆÂà∞ÂçïÁã¨ÁöÑÊñá‰ª∂‰∏≠Ôºå‰∏æ‰∏™‰æãÂ≠êÔºö 1234567891011&lt;beans profile="development" xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:jdbc="http://www.springframework.org/schema/jdbc" xsi:schemaLocation="..."&gt; &lt;jdbc:embedded-database id="dataSource"&gt; &lt;jdbc:script location="classpath:com/bank/config/sql/schema.sql"/&gt; &lt;jdbc:script location="classpath:com/bank/config/sql/test-data.sql"/&gt; &lt;/jdbc:embedded-database&gt;&lt;/beans&gt; 12345678&lt;beans profile="production" xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:jee="http://www.springframework.org/schema/jee" xsi:schemaLocation="..."&gt; &lt;jee:jndi-lookup id="dataSource" jndi-name="java:comp/env/jdbc/datasource"/&gt;&lt;/beans&gt; Â∫îËØ•‰∏çÂøÖÂÅöËøáÂ§öËß£Èáä‰∫ÜÂêßÔºåÁúãÊØè‰∏™Êñá‰ª∂Á¨¨‰∏ÄË°åÁöÑ profile=‚Äù‚Äù„ÄÇ ÂΩìÁÑ∂ÔºåÊàë‰ª¨‰πüÂèØ‰ª•Âú®‰∏Ä‰∏™ÈÖçÁΩÆÊñá‰ª∂‰∏≠‰ΩøÁî®Ôºö 1234567891011121314151617&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:jdbc="http://www.springframework.org/schema/jdbc" xmlns:jee="http://www.springframework.org/schema/jee" xsi:schemaLocation="..."&gt; &lt;beans profile="development"&gt; &lt;jdbc:embedded-database id="dataSource"&gt; &lt;jdbc:script location="classpath:com/bank/config/sql/schema.sql"/&gt; &lt;jdbc:script location="classpath:com/bank/config/sql/test-data.sql"/&gt; &lt;/jdbc:embedded-database&gt; &lt;/beans&gt; &lt;beans profile="production"&gt; &lt;jee:jndi-lookup id="dataSource" jndi-name="java:comp/env/jdbc/datasource"/&gt; &lt;/beans&gt;&lt;/beans&gt; ÁêÜËß£Ëµ∑Êù•‰πüÂæàÁÆÄÂçïÂêß„ÄÇ Êé•‰∏ãÊù•ÁöÑÈóÆÈ¢òÊòØÔºåÊÄé‰πà‰ΩøÁî®ÁâπÂÆöÁöÑ profile Âë¢ÔºüSpring Âú®ÂêØÂä®ÁöÑËøáÁ®ã‰∏≠Ôºå‰ºöÂéªÂØªÊâæ ‚Äúspring.profiles.active‚Äù ÁöÑÂ±ûÊÄßÂÄºÔºåÊ†πÊçÆËøô‰∏™Â±ûÊÄßÂÄºÊù•ÁöÑ„ÄÇÈÇ£ÊÄé‰πàÈÖçÁΩÆËøô‰∏™ÂÄºÂë¢Ôºü Spring ‰ºöÂú®ËøôÂá†‰∏™Âú∞ÊñπÂØªÊâæ spring.profiles.active ÁöÑÂ±ûÊÄßÂÄºÔºöÊìç‰ΩúÁ≥ªÁªüÁéØÂ¢ÉÂèòÈáè„ÄÅJVM Á≥ªÁªüÂèòÈáè„ÄÅweb.xml ‰∏≠ÂÆö‰πâÁöÑÂèÇÊï∞„ÄÅJNDI„ÄÇ ÊúÄÁÆÄÂçïÁöÑÊñπÂºèËé´Ëøá‰∫éÂú®Á®ãÂ∫èÂêØÂä®ÁöÑÊó∂ÂÄôÊåáÂÆöÔºö 1-Dspring.profiles.active="profile1,profile2" profile ÂèØ‰ª•ÊøÄÊ¥ªÂ§ö‰∏™ ÂΩìÁÑ∂ÔºåÊàë‰ª¨‰πüÂèØ‰ª•ÈÄöËøá‰ª£Á†ÅÁöÑÂΩ¢Âºè‰ªé Environment ‰∏≠ËÆæÁΩÆ profileÔºö 1234AnnotationConfigApplicationContext ctx = new AnnotationConfigApplicationContext();ctx.getEnvironment().setActiveProfiles("development");ctx.register(SomeConfig.class, StandaloneDataConfig.class, JndiDataConfig.class);ctx.refresh(); // ÈáçÂêØ Â¶ÇÊûúÊòØ Spring Boot ÁöÑËØùÊõ¥ÁÆÄÂçïÔºåÊàë‰ª¨‰∏ÄËà¨‰ºöÂàõÂª∫ application.properties„ÄÅapplication-dev.properties„ÄÅapplication-prod.properties Á≠âÊñá‰ª∂ÔºåÂÖ∂‰∏≠ application.properties ÈÖçÁΩÆÂêÑ‰∏™ÁéØÂ¢ÉÈÄöÁî®ÁöÑÈÖçÁΩÆÔºåapplication-{profile}.properties ‰∏≠ÈÖçÁΩÆÁâπÂÆöÁéØÂ¢ÉÁöÑÈÖçÁΩÆÔºåÁÑ∂ÂêéÂú®ÂêØÂä®ÁöÑÊó∂ÂÄôÊåáÂÆö profileÔºö 1java -Dspring.profiles.active=prod -jar JavaDoop.jar Â¶ÇÊûúÊòØÂçïÂÖÉÊµãËØï‰∏≠‰ΩøÁî®ÁöÑËØùÔºåÂú®ÊµãËØïÁ±ª‰∏≠‰ΩøÁî® @ActiveProfiles ÊåáÂÆöÔºåËøôÈáåÂ∞±‰∏çÂ±ïÂºÄ‰∫Ü„ÄÇ Â∑•ÂéÇÊ®°ÂºèÁîüÊàê BeanËØ∑ËØªËÄÖÊ≥®ÊÑè factory-bean Âíå FactoryBean ÁöÑÂå∫Âà´„ÄÇËøôËäÇËØ¥ÁöÑÊòØÂâçËÄÖÔºåÊòØËØ¥ÈùôÊÄÅÂ∑•ÂéÇÊàñÂÆû‰æãÂ∑•ÂéÇÔºåËÄåÂêéËÄÖÊòØ Spring ‰∏≠ÁöÑÁâπÊÆäÊé•Âè£Ôºå‰ª£Ë°®‰∏ÄÁ±ªÁâπÊÆäÁöÑ BeanÔºåÈôÑÂΩïÁöÑ‰∏ãÈù¢‰∏ÄËäÇ‰ºö‰ªãÁªç FactoryBean„ÄÇ ËÆæËÆ°Ê®°ÂºèÈáåÔºåÂ∑•ÂéÇÊñπÊ≥ïÊ®°ÂºèÂàÜÈùôÊÄÅÂ∑•ÂéÇÂíåÂÆû‰æãÂ∑•ÂéÇÔºåÊàë‰ª¨ÂàÜÂà´ÁúãÁúã Spring ‰∏≠ÊÄé‰πàÈÖçÁΩÆËøô‰∏§‰∏™ÔºåÊù•‰∏™‰ª£Á†ÅÁ§∫‰æãÂ∞±‰ªÄ‰πàÈÉΩÊ∏ÖÊ•ö‰∫Ü„ÄÇ ÈùôÊÄÅÂ∑•ÂéÇÔºö 123&lt;bean id="clientService" class="examples.ClientService" factory-method="createInstance"/&gt; 123456789public class ClientService &#123; private static ClientService clientService = new ClientService(); private ClientService() &#123;&#125; // ÈùôÊÄÅÊñπÊ≥ï public static ClientService createInstance() &#123; return clientService; &#125;&#125; ÂÆû‰æãÂ∑•ÂéÇÔºö 1234567891011&lt;bean id="serviceLocator" class="examples.DefaultServiceLocator"&gt; &lt;!-- inject any dependencies required by this locator bean --&gt;&lt;/bean&gt;&lt;bean id="clientService" factory-bean="serviceLocator" factory-method="createClientServiceInstance"/&gt;&lt;bean id="accountService" factory-bean="serviceLocator" factory-method="createAccountServiceInstance"/&gt; 1234567891011121314public class DefaultServiceLocator &#123; private static ClientService clientService = new ClientServiceImpl(); private static AccountService accountService = new AccountServiceImpl(); public ClientService createClientServiceInstance() &#123; return clientService; &#125; public AccountService createAccountServiceInstance() &#123; return accountService; &#125;&#125; FactoryBeanFactoryBean ÈÄÇÁî®‰∫é Bean ÁöÑÂàõÂª∫ËøáÁ®ãÊØîËæÉÂ§çÊùÇÁöÑÂú∫ÊôØÔºåÊØîÂ¶ÇÊï∞ÊçÆÂ∫ìËøûÊé•Ê±†ÁöÑÂàõÂª∫„ÄÇ 12345public interface FactoryBean&lt;T&gt; &#123; T getObject() throws Exception; Class&lt;T&gt; getObjectType(); boolean isSingleton();&#125; 1234public class Person &#123; private Car car ; private void setCar(Car car)&#123; this.car = car; &#125; &#125; Êàë‰ª¨ÂÅáËÆæÁé∞Âú®ÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™ Person ÁöÑ BeanÔºåÈ¶ñÂÖàÊàë‰ª¨ÈúÄË¶Å‰∏Ä‰∏™ Car ÁöÑÂÆû‰æãÔºåÊàë‰ª¨ËøôÈáåÂÅáËÆæ Car ÁöÑÂÆû‰æãÂàõÂª∫ÂæàÈ∫ªÁÉ¶ÔºåÈÇ£‰πàÊàë‰ª¨ÂèØ‰ª•ÊääÂàõÂª∫ Car ÁöÑÂ§çÊùÇËøáÁ®ãÂåÖË£ÖËµ∑Êù•Ôºö 123456789101112131415161718192021public class MyCarFactoryBean implements FactoryBean&lt;Car&gt;&#123; private String make; private int year ; public void setMake(String m)&#123; this.make =m ; &#125; public void setYear(int y)&#123; this.year = y; &#125; public Car getObject()&#123; // ËøôÈáåÊàë‰ª¨ÂÅáËÆæ Car ÁöÑÂÆû‰æãÂåñËøáÁ®ãÈùûÂ∏∏Â§çÊùÇÔºåÂèçÊ≠£Â∞±‰∏çÊòØÂá†Ë°å‰ª£Á†ÅÂèØ‰ª•ÂÜôÂÆåÁöÑÈÇ£Áßç CarBuilder cb = CarBuilder.car(); if(year!=0) cb.setYear(this.year); if(StringUtils.hasText(this.make)) cb.setMake( this.make ); return cb.factory(); &#125; public Class&lt;Car&gt; getObjectType() &#123; return Car.class ; &#125; public boolean isSingleton() &#123; return false; &#125;&#125; Êàë‰ª¨ÁúãÁúãË£ÖÈÖçÁöÑÊó∂ÂÄôÊòØÊÄé‰πàÈÖçÁΩÆÁöÑÔºö 1234567&lt;bean class = "com.javadoop.MyCarFactoryBean" id = "car"&gt; &lt;property name = "make" value ="Honda"/&gt; &lt;property name = "year" value ="1984"/&gt;&lt;/bean&gt;&lt;bean class = "com.javadoop.Person" id = "josh"&gt; &lt;property name = "car" ref = "car"/&gt;&lt;/bean&gt; ÁúãÂà∞‰∏ç‰∏ÄÊ†∑‰∫ÜÂêóÔºüid ‰∏∫ ‚Äúcar‚Äù ÁöÑ bean ÂÖ∂ÂÆûÊåáÂÆöÁöÑÊòØ‰∏Ä‰∏™ FactoryBeanÔºå‰∏çËøáÈÖçÁΩÆÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨Áõ¥Êé•ËÆ©ÈÖçÁΩÆ Person ÁöÑ Bean Áõ¥Êé•‰æùËµñ‰∫éËøô‰∏™ FactoryBean Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ‰∏≠Èó¥ÁöÑËøáÁ®ã Spring Â∑≤ÁªèÂ∞ÅË£ÖÂ•Ω‰∫Ü„ÄÇ ËØ¥Âà∞ËøôÈáåÔºåÊàë‰ª¨ÂÜçÊù•ÁÇπÂπ≤Ë¥ß„ÄÇÊàë‰ª¨Áü•ÈÅìÔºåÁé∞Âú®ËøòÁî® xml ÈÖçÁΩÆ Bean ‰æùËµñÁöÑË∂äÊù•Ë∂äÂ∞ë‰∫ÜÔºåÊõ¥Â§öÊó∂ÂÄôÔºåÊàë‰ª¨ÂèØËÉΩ‰ºöÈááÁî® java config ÁöÑÊñπÂºèÊù•ÈÖçÁΩÆÔºåËøôÈáåÊúâ‰ªÄ‰πà‰∏ç‰∏ÄÊ†∑Âë¢Ôºü 12345678910111213141516171819@Configuration public class CarConfiguration &#123; @Bean public MyCarFactoryBean carFactoryBean()&#123; MyCarFactoryBean cfb = new MyCarFactoryBean(); cfb.setMake("Honda"); cfb.setYear(1984); return cfb; &#125; @Bean public Person aPerson()&#123; Person person = new Person(); // Ê≥®ÊÑèËøôÈáåÁöÑ‰∏çÂêå person.setCar(carFactoryBean().getObject()); return person; &#125; &#125; Ëøô‰∏™Êó∂ÂÄôÔºåÂÖ∂ÂÆûÊàë‰ª¨ÁöÑÊÄùË∑Ø‰πüÂæàÁÆÄÂçïÔºåÊää MyCarFactoryBean ÁúãÊàêÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑ Bean Â∞±ÂèØ‰ª•‰∫ÜÔºå‰∏çÂøÖÁêÜ‰ºö‰ªÄ‰πà FactoryBeanÔºåÂÆÉÊòØ‰∏çÊòØ FactoryBean ÂíåÊàë‰ª¨Ê≤°ÂÖ≥Á≥ª„ÄÇ ÂàùÂßãÂåñ Bean ÁöÑÂõûË∞ÉÊúâ‰ª•‰∏ãÂõõÁßçÊñπÊ°àÔºö 1&lt;bean id="exampleInitBean" class="examples.ExampleBean" init-method="init"/&gt; 123456public class AnotherExampleBean implements InitializingBean &#123; public void afterPropertiesSet() &#123; // do some initialization work &#125;&#125; 1234@Bean(initMethod = "init")public Foo foo() &#123; return new Foo();&#125; 1234@PostConstructpublic void init() &#123; &#125; ÈîÄÊØÅ Bean ÁöÑÂõûË∞É1&lt;bean id="exampleInitBean" class="examples.ExampleBean" destroy-method="cleanup"/&gt; 123456public class AnotherExampleBean implements DisposableBean &#123; public void destroy() &#123; // do some destruction work (like releasing pooled connections) &#125;&#125; 123456789@Bean(destroyMethod = "cleanup")public Bar bar() &#123; return new Bar();-### Bean ÁªßÊâøÂú®ÂàùÂßãÂåñ Bean ÁöÑÂú∞ÊñπÔºåÊàë‰ª¨ËØ¥Ëøá‰∫ÜËøô‰∏™Ôºö‚Äã```javaRootBeanDefinition bd = getMergedLocalBeanDefinition(beanName); ËøôÈáåÊ∂âÂèäÂà∞ÁöÑÂ∞±ÊòØ &lt;bean parent=&quot;&quot; /&gt; ‰∏≠ÁöÑ parent Â±ûÊÄßÔºåÊàë‰ª¨Êù•ÁúãÁúã Spring ‰∏≠ÊòØÁî®Ëøô‰∏™Êù•Âπ≤‰ªÄ‰πàÁöÑ„ÄÇ È¶ñÂÖàÔºåÊàë‰ª¨Ë¶ÅÊòéÁôΩÔºåËøôÈáåÁöÑÁªßÊâøÂíå java ËØ≠Ê≥ï‰∏≠ÁöÑÁªßÊâøÊ≤°Êúâ‰ªª‰ΩïÂÖ≥Á≥ªÔºå‰∏çËøáÊÄùË∑ØÊòØÁõ∏ÈÄöÁöÑ„ÄÇchild bean ‰ºöÁªßÊâø parent bean ÁöÑÊâÄÊúâÈÖçÁΩÆÔºå‰πüÂèØ‰ª•Ë¶ÜÁõñ‰∏Ä‰∫õÈÖçÁΩÆÔºåÂΩìÁÑ∂‰πüÂèØ‰ª•Êñ∞Â¢ûÈ¢ùÂ§ñÁöÑÈÖçÁΩÆ„ÄÇ Spring ‰∏≠Êèê‰æõ‰∫ÜÁªßÊâøËá™ AbstractBeanDefinition ÁöÑ ChildBeanDefinition Êù•Ë°®Á§∫ child bean„ÄÇ ÁúãÂ¶Ç‰∏ã‰∏Ä‰∏™‰æãÂ≠ê: 12345678910&lt;bean id="inheritedTestBean" abstract="true" class="org.springframework.beans.TestBean"&gt; &lt;property name="name" value="parent"/&gt; &lt;property name="age" value="1"/&gt;&lt;/bean&gt;&lt;bean id="inheritsWithDifferentClass" class="org.springframework.beans.DerivedTestBean" parent="inheritedTestBean" init-method="initialize"&gt; &lt;property name="name" value="override"/&gt;&lt;/bean&gt; parent bean ËÆæÁΩÆ‰∫Ü abstract=&quot;true&quot; ÊâÄ‰ª•ÂÆÉ‰∏ç‰ºöË¢´ÂÆû‰æãÂåñÔºåchild bean ÁªßÊâø‰∫Ü parent bean ÁöÑ‰∏§‰∏™Â±ûÊÄßÔºå‰ΩÜÊòØÂØπ name Â±ûÊÄßËøõË°å‰∫ÜË¶ÜÂÜô„ÄÇ child bean ‰ºöÁªßÊâø scope„ÄÅÊûÑÈÄ†Âô®ÂèÇÊï∞ÂÄº„ÄÅÂ±ûÊÄßÂÄº„ÄÅinit-method„ÄÅdestroy-method Á≠âÁ≠â„ÄÇ ÂΩìÁÑ∂ÔºåÊàë‰∏çÊòØËØ¥ parent bean ‰∏≠ÁöÑ abstract = true Âú®ËøôÈáåÊòØÂøÖÈ°ªÁöÑÔºåÂè™ÊòØËØ¥Â¶ÇÊûúÂä†‰∏ä‰∫Ü‰ª•Âêé Spring Âú®ÂÆû‰æãÂåñ singleton beans ÁöÑÊó∂ÂÄô‰ºöÂøΩÁï•Ëøô‰∏™ bean„ÄÇ ÊØîÂ¶Ç‰∏ãÈù¢Ëøô‰∏™ÊûÅÁ´Ø parent beanÔºåÂÆÉÊ≤°ÊúâÊåáÂÆö classÔºåÊâÄ‰ª•ÊØ´Êó†ÁñëÈóÆÔºåËøô‰∏™ bean ÁöÑ‰ΩúÁî®Â∞±ÊòØÁî®Êù•ÂÖÖÂΩìÊ®°ÊùøÁî®ÁöÑ parent beanÔºåÊ≠§Â§ÑÂ∞±ÂøÖÈ°ªÂä†‰∏ä abstract = true„ÄÇ 1234&lt;bean id="inheritedTestBeanWithoutClass" abstract="true"&gt; &lt;property name="name" value="parent"/&gt; &lt;property name="age" value="1"/&gt;&lt;/bean&gt; ÊñπÊ≥ïÊ≥®ÂÖ•‰∏ÄËà¨Êù•ËØ¥ÔºåÊàë‰ª¨ÁöÑÂ∫îÁî®‰∏≠Â§ßÂ§öÊï∞ÁöÑ Bean ÈÉΩÊòØ singleton ÁöÑ„ÄÇsingleton ‰æùËµñ singletonÔºåÊàñËÄÖ prototype ‰æùËµñ prototype ÈÉΩÂæàÂ•ΩËß£ÂÜ≥ÔºåÁõ¥Êé•ËÆæÁΩÆÂ±ûÊÄß‰æùËµñÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇ ‰ΩÜÊòØÔºåÂ¶ÇÊûúÊòØ singleton ‰æùËµñ prototype Âë¢ÔºüËøô‰∏™Êó∂ÂÄô‰∏çËÉΩÁî®Â±ûÊÄß‰æùËµñÔºåÂõ†‰∏∫Â¶ÇÊûúÁî®Â±ûÊÄß‰æùËµñÁöÑËØùÔºåÊàë‰ª¨ÊØèÊ¨°ÂÖ∂ÂÆûÊãøÂà∞ÁöÑËøòÊòØÁ¨¨‰∏ÄÊ¨°ÂàùÂßãÂåñÊó∂ÂÄôÁöÑ bean„ÄÇ ‰∏ÄÁßçËß£ÂÜ≥ÊñπÊ°àÂ∞±ÊòØ‰∏çË¶ÅÁî®Â±ûÊÄß‰æùËµñÔºåÊØèÊ¨°Ëé∑Âèñ‰æùËµñÁöÑ bean ÁöÑÊó∂ÂÄô‰ªé BeanFactory ‰∏≠Âèñ„ÄÇËøô‰∏™‰πüÊòØÂ§ßÂÆ∂ÊúÄÂ∏∏Áî®ÁöÑÊñπÂºè‰∫ÜÂêß„ÄÇÊÄé‰πàÂèñÔºåÊàëÂ∞±‰∏ç‰ªãÁªç‰∫ÜÔºåÂ§ßÈÉ®ÂàÜ Spring È°πÁõÆÂ§ßÂÆ∂ÈÉΩ‰ºöÂÆö‰πâÈÇ£‰πà‰∏™Â∑•ÂÖ∑Á±ªÁöÑ„ÄÇ Âè¶‰∏ÄÁßçËß£ÂÜ≥ÊñπÊ°àÂ∞±ÊòØËøôÈáåË¶Å‰ªãÁªçÁöÑÈÄöËøá‰ΩøÁî® Lookup method„ÄÇ lookup-methodÊàë‰ª¨Êù•Áúã‰∏Ä‰∏ã Spring Reference ‰∏≠Êèê‰æõÁöÑ‰∏Ä‰∏™‰æãÂ≠êÔºö 1234567891011121314151617package fiona.apple;// no more Spring imports!public abstract class CommandManager &#123; public Object process(Object commandState) &#123; // grab a new instance of the appropriate Command interface Command command = createCommand(); // set the state on the (hopefully brand new) Command instance command.setState(commandState); return command.execute(); &#125; // okay... but where is the implementation of this method? protected abstract Command createCommand();&#125; xml ÈÖçÁΩÆ &lt;lookup-method /&gt;Ôºö 123456789&lt;!-- a stateful bean deployed as a prototype (non-singleton) --&gt;&lt;bean id="myCommand" class="fiona.apple.AsyncCommand" scope="prototype"&gt; &lt;!-- inject dependencies here as required --&gt;&lt;/bean&gt;&lt;!-- commandProcessor uses statefulCommandHelper --&gt;&lt;bean id="commandManager" class="fiona.apple.CommandManager"&gt; &lt;lookup-method name="createCommand" bean="myCommand"/&gt;&lt;/bean&gt; Spring ÈááÁî® CGLIB ÁîüÊàêÂ≠óËäÇÁ†ÅÁöÑÊñπÂºèÊù•ÁîüÊàê‰∏Ä‰∏™Â≠êÁ±ª„ÄÇÊàë‰ª¨ÂÆö‰πâÁöÑÁ±ª‰∏çËÉΩÂÆö‰πâ‰∏∫ final classÔºåÊäΩË±°ÊñπÊ≥ï‰∏ä‰πü‰∏çËÉΩÂä† final„ÄÇ lookup-method ‰∏äÁöÑÈÖçÁΩÆ‰πüÂèØ‰ª•ÈááÁî®Ê≥®Ëß£Êù•ÂÆåÊàêÔºåËøôÊ†∑Â∞±ÂèØ‰ª•‰∏çÁî®ÈÖçÁΩÆ &lt;lookup-method /&gt; ‰∫ÜÔºåÂÖ∂‰ªñ‰∏çÂèòÔºö 1234567891011public abstract class CommandManager &#123; public Object process(Object commandState) &#123; MyCommand command = createCommand(); command.setState(commandState); return command.execute(); &#125; @Lookup("myCommand") protected abstract Command createCommand();&#125; Ê≥®ÊÑèÔºåÊó¢ÁÑ∂Áî®‰∫ÜÊ≥®Ëß£ÔºåË¶ÅÈÖçÁΩÆÊ≥®Ëß£Êâ´ÊèèÔºö&lt;context:component-scan base-package=&quot;com.javadoop&quot; /&gt; ÁîöËá≥ÔºåÊàë‰ª¨ÂèØ‰ª•ÂÉè‰∏ãÈù¢ËøôÊ†∑Ôºö 1234567891011public abstract class CommandManager &#123; public Object process(Object commandState) &#123; MyCommand command = createCommand(); command.setState(commandState); return command.execute(); &#125; @Lookup protected abstract MyCommand createCommand();&#125; ‰∏äÈù¢ÁöÑËøîÂõûÂÄºÁî®‰∫Ü MyCommandÔºåÂΩìÁÑ∂ÔºåÂ¶ÇÊûú Command Âè™Êúâ‰∏Ä‰∏™ÂÆûÁé∞Á±ªÔºåÈÇ£ËøîÂõûÂÄº‰πüÂèØ‰ª•ÂÜô Command„ÄÇ replaced-methodËÆ∞‰ΩèÂÆÉÁöÑÂäüËÉΩÔºåÂ∞±ÊòØÊõøÊç¢Êéâ bean ‰∏≠ÁöÑ‰∏Ä‰∫õÊñπÊ≥ï„ÄÇ 12345678public class MyValueCalculator &#123; public String computeValue(String input) &#123; // some real code... &#125; // some other methods...&#125; ÊñπÊ≥ïË¶ÜÂÜôÔºåÊ≥®ÊÑèË¶ÅÂÆûÁé∞ MethodReplacer Êé•Âè£Ôºö 123456789public class ReplacementComputeValue implements org.springframework.beans.factory.support.MethodReplacer &#123; public Object reimplement(Object o, Method m, Object[] args) throws Throwable &#123; // get the input value, work with it, and return a computed result String input = (String) args[0]; ... return ...; &#125;&#125; ÈÖçÁΩÆ‰πüÂæàÁÆÄÂçïÔºö 12345678&lt;bean id="myValueCalculator" class="x.y.z.MyValueCalculator"&gt; &lt;!-- ÂÆö‰πâ computeValue Ëøô‰∏™ÊñπÊ≥ïË¶ÅË¢´ÊõøÊç¢Êéâ --&gt; &lt;replaced-method name="computeValue" replacer="replacementComputeValue"&gt; &lt;arg-type&gt;String&lt;/arg-type&gt; &lt;/replaced-method&gt;&lt;/bean&gt;&lt;bean id="replacementComputeValue" class="a.b.c.ReplacementComputeValue"/&gt; arg-type ÊòéÊòæ‰∏çÊòØÂøÖÈ°ªÁöÑÔºåÈô§ÈùûÂ≠òÂú®ÊñπÊ≥ïÈáçËΩΩÔºåËøôÊ†∑ÂøÖÈ°ªÈÄöËøáÂèÇÊï∞Á±ªÂûãÂàóË°®Êù•Âà§Êñ≠ËøôÈáåË¶ÅË¶ÜÁõñÂì™‰∏™ÊñπÊ≥ï„ÄÇ BeanPostProcessorÂ∫îËØ•ËØ¥ BeanPostProcessor Ê¶ÇÂøµÂú® Spring ‰∏≠‰πüÊòØÊØîËæÉÈáçË¶ÅÁöÑ„ÄÇÊàë‰ª¨Áúã‰∏ãÊé•Âè£ÂÆö‰πâÔºö 1234567public interface BeanPostProcessor &#123; Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException; Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException;&#125; ÁúãËøô‰∏™Êé•Âè£‰∏≠ÁöÑ‰∏§‰∏™ÊñπÊ≥ïÂêçÂ≠óÊàë‰ª¨Â§ß‰Ωì‰∏äÂèØ‰ª•ÁåúÊµã bean Âú®ÂàùÂßãÂåñ‰πãÂâç‰ºöÊâßË°å postProcessBeforeInitialization Ëøô‰∏™ÊñπÊ≥ïÔºåÂàùÂßãÂåñÂÆåÊàê‰πãÂêé‰ºöÊâßË°å postProcessAfterInitialization Ëøô‰∏™ÊñπÊ≥ï„ÄÇ‰ΩÜÊòØÔºåËøô‰πàÁêÜËß£ÊòØÈùûÂ∏∏ÁâáÈù¢ÁöÑ„ÄÇ È¶ñÂÖàÔºåÊàë‰ª¨Ë¶ÅÊòéÁôΩÔºåÈô§‰∫ÜÊàë‰ª¨Ëá™Â∑±ÂÆö‰πâÁöÑ BeanPostProcessor ÂÆûÁé∞Â§ñÔºåSpring ÂÆπÂô®Âú®ÂêØÂä®Êó∂Ëá™Âä®ÁªôÊàë‰ª¨‰πüÂä†‰∫ÜÂá†‰∏™„ÄÇÂ¶ÇÂú®Ëé∑Âèñ BeanFactory ÁöÑ obtainFactory() ÊñπÊ≥ïÁªìÊùüÂêéÁöÑ prepareBeanFactory(factory)ÔºåÂ§ßÂÆ∂‰ªîÁªÜÁúã‰ºöÂèëÁé∞ÔºåSpring ÂæÄÂÆπÂô®‰∏≠Ê∑ªÂä†‰∫ÜËøô‰∏§‰∏™ BeanPostProcessorÔºöApplicationContextAwareProcessor„ÄÅApplicationListenerDetector„ÄÇ Êàë‰ª¨ÂõûÂà∞Ëøô‰∏™Êé•Âè£Êú¨Ë∫´ÔºåËØªËÄÖËØ∑ÁúãÁ¨¨‰∏Ä‰∏™ÊñπÊ≥ïÔºåËøô‰∏™ÊñπÊ≥ïÊé•ÂèóÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØ bean ÂÆû‰æãÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØ bean ÁöÑÂêçÂ≠óÔºåÈáçÁÇπÂú®ËøîÂõûÂÄºÂ∞Ü‰ºö‰Ωú‰∏∫Êñ∞ÁöÑ bean ÂÆû‰æãÔºåÊâÄ‰ª•ÔºåÊ≤°‰∫ãÁöÑËØùËøôÈáå‰∏çËÉΩÈöè‰æøËøîÂõû‰∏™ null„ÄÇ ÈÇ£ÊÑèÂë≥ÁùÄ‰ªÄ‰πàÂë¢ÔºüÊàë‰ª¨ÂæàÂÆπÊòìÊÉ≥Âà∞ÁöÑÂ∞±ÊòØÔºåÊàë‰ª¨ËøôÈáåÂèØ‰ª•ÂØπ‰∏Ä‰∫õÊàë‰ª¨ÊÉ≥Ë¶Å‰øÆÈ•∞ÁöÑ bean ÂÆû‰æãÂÅö‰∏Ä‰∫õ‰∫ãÊÉÖ„ÄÇ‰ΩÜÊòØÂØπ‰∫é Spring Ê°ÜÊû∂Êù•ËØ¥ÔºåÂÆÉ‰ºöÂÜ≥ÂÆöÊòØ‰∏çÊòØË¶ÅÂú®Ëøô‰∏™ÊñπÊ≥ï‰∏≠ËøîÂõû bean ÂÆû‰æãÁöÑ‰ª£ÁêÜÔºåËøôÊ†∑Â∞±ÊúâÊõ¥Â§ßÁöÑÊÉ≥Ë±°Á©∫Èó¥‰∫Ü„ÄÇ ÊúÄÂêéÔºåÊàë‰ª¨ËØ¥ËØ¥Â¶ÇÊûúÊàë‰ª¨Ëá™Â∑±ÂÆö‰πâ‰∏Ä‰∏™ bean ÂÆûÁé∞ BeanPostProcessor ÁöÑËØùÔºåÂÆÉÁöÑÊâßË°åÊó∂Êú∫ÊòØ‰ªÄ‰πàÊó∂ÂÄôÔºü Â¶ÇÊûú‰ªîÁªÜÁúã‰∫Ü‰ª£Á†ÅÂàÜÊûêÁöÑËØùÔºåÂÖ∂ÂÆûÂæàÂÆπÊòìÁü•ÈÅì‰∫ÜÔºåÂú® bean ÂÆû‰æãÂåñÂÆåÊàê„ÄÅÂ±ûÊÄßÊ≥®ÂÖ•ÂÆåÊàê‰πãÂêéÔºå‰ºöÊâßË°åÂõûË∞ÉÊñπÊ≥ïÔºåÂÖ∑‰ΩìËØ∑ÂèÇËßÅÁ±ª AbstractAutowireCapableBeanFactory#initBean ÊñπÊ≥ï„ÄÇ È¶ñÂÖà‰ºöÂõûË∞ÉÂá†‰∏™ÂÆûÁé∞‰∫Ü Aware Êé•Âè£ÁöÑ beanÔºåÁÑ∂ÂêéÂ∞±ÂºÄÂßãÂõûË∞É BeanPostProcessor ÁöÑ postProcessBeforeInitialization ÊñπÊ≥ïÔºå‰πãÂêéÊòØÂõûË∞É init-methodÔºåÁÑ∂ÂêéÂÜçÂõûË∞É BeanPostProcessor ÁöÑ postProcessAfterInitialization ÊñπÊ≥ï„ÄÇ ÊÄªÁªìÊåâÁêÜËØ¥ÔºåÊÄªÁªìÂ∫îËØ•ÂÜôÂú®ÈôÑÂΩïÂâçÈù¢ÔºåÊàëÂ∞±‰∏çËÆ≤Á©∂‰∫Ü„ÄÇ Âú®Ëä±‰∫ÜÈÇ£‰πàÂ§öÊó∂Èó¥ÂêéÔºåËøôÁØáÊñáÁ´†Áªà‰∫éÁÆóÊòØÂü∫Êú¨ÂÜôÂÆå‰∫ÜÔºåÂ§ßÂÆ∂Âú®ÊÉäÂèπ Spring ÁªôÊàë‰ª¨ÂÅö‰∫ÜÈÇ£‰πàÂ§öÁöÑ‰∫ãÁöÑÊó∂ÂÄôÔºåÂ∫îËØ•ÈÄèËøáÁé∞Ë±°ÁúãÊú¨Ë¥®ÔºåÂéªÁêÜËß£ Spring ÂÜôÂæóÂ•ΩÁöÑÂú∞ÊñπÔºåÂéªÁêÜËß£ÂÆÉÁöÑËÆæËÆ°ÊÄùÊÉ≥„ÄÇ Êú¨ÊñáÁöÑÁº∫Èô∑Âú®‰∫éÂØπ Spring È¢ÑÂàùÂßãÂåñ singleton beans ÁöÑËøáÁ®ãÂàÜÊûê‰∏çÂ§üÔºå‰∏ªË¶ÅÊòØ‰ª£Á†ÅÈáèÁúüÁöÑÊØîËæÉÂ§ßÔºåÂàÜÊîØÊóÅË∑Ø‰ºóÂ§ö„ÄÇÂêåÊó∂ÔºåËôΩÁÑ∂ÈôÑÂΩïÊù°ÁõÆ‰∏çÂ∞ëÔºå‰ΩÜÊòØÂ∫ûÂ§ßÁöÑ Spring ÁúüÁöÑÂºïÂá∫‰∫ÜÂæàÂ§öÁöÑÊ¶ÇÂøµÔºåÂ∏åÊúõÊó•ÂêéÊúâÁ≤æÂäõÂèØ‰ª•ÊÖ¢ÊÖ¢Ë°•ÂÖÖ‰∏Ä‰∫õ„ÄÇ ÔºàÂÖ®ÊñáÂÆåÔºâ]]></content>
      <categories>
        <category>Spring</category>
      </categories>
      <tags>
        <tag>Spring IOC</tag>
      </tags>
  </entry>
</search>
